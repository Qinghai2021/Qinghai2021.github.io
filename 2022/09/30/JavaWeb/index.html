<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>JavaWebç¬”è®°</title><meta name="author" content="Qinghai2021"><meta name="copyright" content="Qinghai2021"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="è¯¾ç¨‹ä½“ç³»è®¾è®¡ è¯¾ä»¶å‰ç«¯çŸ¥è¯†HTMLHTMLä¸­çš„åŸºç¡€æ ‡ç­¾ htmlè¯­è¨€æ˜¯è§£é‡Šå‹è¯­è¨€ï¼Œä¸æ˜¯ç¼–è¯‘å‹æµè§ˆå™¨æ˜¯å®¹é”™çš„  htmlé¡µé¢ä¸­ç”±ä¸€å¯¹æ ‡ç­¾ç»„æˆï¼š  ç§°ä¹‹ä¸º å¼€å§‹æ ‡ç­¾ ç§°ä¹‹ä¸º ç»“æŸæ ‡ç­¾ title è¡¨ç¤ºç½‘é¡µçš„æ ‡é¢˜   1&lt;title&gt;è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ä¸ªç½‘é¡µ&lt;&#x2F;title&gt;  å¯ä»¥åœ¨metaæ ‡ç­¾ä¸­è®¾ç½®ç¼–ç æ–¹å¼    è¡¨ç¤ºæ¢è¡Œ ã€‚bræ ‡ç­¾æ˜¯ä¸€ä¸ªå•æ ‡ç­¾ã€‚å•æ ‡ç­¾ï¼šå¼€å§‹æ ‡ç­¾å’Œç»“æŸæ ‡ç­¾æ˜¯åŒä¸€ä¸ªï¼Œ">
<meta property="og:type" content="article">
<meta property="og:title" content="JavaWebç¬”è®°">
<meta property="og:url" content="http://example.com/2022/09/30/JavaWeb/index.html">
<meta property="og:site_name" content="Qinghai2021Â·åšå®¢">
<meta property="og:description" content="è¯¾ç¨‹ä½“ç³»è®¾è®¡ è¯¾ä»¶å‰ç«¯çŸ¥è¯†HTMLHTMLä¸­çš„åŸºç¡€æ ‡ç­¾ htmlè¯­è¨€æ˜¯è§£é‡Šå‹è¯­è¨€ï¼Œä¸æ˜¯ç¼–è¯‘å‹æµè§ˆå™¨æ˜¯å®¹é”™çš„  htmlé¡µé¢ä¸­ç”±ä¸€å¯¹æ ‡ç­¾ç»„æˆï¼š  ç§°ä¹‹ä¸º å¼€å§‹æ ‡ç­¾ ç§°ä¹‹ä¸º ç»“æŸæ ‡ç­¾ title è¡¨ç¤ºç½‘é¡µçš„æ ‡é¢˜   1&lt;title&gt;è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ä¸ªç½‘é¡µ&lt;&#x2F;title&gt;  å¯ä»¥åœ¨metaæ ‡ç­¾ä¸­è®¾ç½®ç¼–ç æ–¹å¼    è¡¨ç¤ºæ¢è¡Œ ã€‚bræ ‡ç­¾æ˜¯ä¸€ä¸ªå•æ ‡ç­¾ã€‚å•æ ‡ç­¾ï¼šå¼€å§‹æ ‡ç­¾å’Œç»“æŸæ ‡ç­¾æ˜¯åŒä¸€ä¸ªï¼Œ">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/images/background.jpg">
<meta property="article:published_time" content="2022-09-29T16:00:00.000Z">
<meta property="article:modified_time" content="2022-10-05T10:59:13.056Z">
<meta property="article:author" content="Qinghai2021">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/images/background.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2022/09/30/JavaWeb/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":500},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: {"limitCount":50,"languages":{"author":"ä½œè€…: Qinghai2021","link":"é“¾æ¥: ","source":"æ¥æº: Qinghai2021Â·åšå®¢","info":"è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://fastly.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://fastly.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'JavaWebç¬”è®°',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-10-05 18:59:13'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.2.0"><link rel="alternate" href="/atom.xml" title="Qinghai2021Â·åšå®¢" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Qinghai2021</div><div class="author-info__description">é˜³å…‰å®…ç”·ğŸ’›</div></div><div class="card-info-social-icons is-center"><a class="social-icon" href="//github.com/Qinghai2021?tab=repositories" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:xxxxxx@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-clock"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.bilibili.com/blackboard/fe/activity-HQjQSdd3L8.html"><i class="fa-fw fas fa-gamepad"></i><span> æ¸¸æˆ</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-tools"></i><span> å·¥å…·</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://draw.xbyzs.cf"><span> Drawç”»å¸ƒ</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Qinghai2021Â·åšå®¢</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-clock"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.bilibili.com/blackboard/fe/activity-HQjQSdd3L8.html"><i class="fa-fw fas fa-gamepad"></i><span> æ¸¸æˆ</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-tools"></i><span> å·¥å…·</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://draw.xbyzs.cf"><span> Drawç”»å¸ƒ</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">JavaWebç¬”è®°</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">å‘è¡¨äº</span><time datetime="2022-09-29T16:00:00.000Z" title="å‘è¡¨äº 2022-09-30 00:00:00">2022-09-30</time></span></div><div class="meta-secondline"></div></div></div><article class="post-content" id="article-container"><h1 id="è¯¾ç¨‹ä½“ç³»è®¾è®¡"><a href="#è¯¾ç¨‹ä½“ç³»è®¾è®¡" class="headerlink" title="è¯¾ç¨‹ä½“ç³»è®¾è®¡"></a>è¯¾ç¨‹ä½“ç³»è®¾è®¡</h1><p><img src="/2022/09/30/JavaWeb/image-20220608183738984.png" alt="image-20220608183738984"></p>
<h1 id="è¯¾ä»¶"><a href="#è¯¾ä»¶" class="headerlink" title="è¯¾ä»¶"></a>è¯¾ä»¶</h1><h1 id="å‰ç«¯çŸ¥è¯†"><a href="#å‰ç«¯çŸ¥è¯†" class="headerlink" title="å‰ç«¯çŸ¥è¯†"></a>å‰ç«¯çŸ¥è¯†</h1><h2 id="HTML"><a href="#HTML" class="headerlink" title="HTML"></a>HTML</h2><h3 id="HTMLä¸­çš„åŸºç¡€æ ‡ç­¾"><a href="#HTMLä¸­çš„åŸºç¡€æ ‡ç­¾" class="headerlink" title="HTMLä¸­çš„åŸºç¡€æ ‡ç­¾"></a>HTMLä¸­çš„åŸºç¡€æ ‡ç­¾</h3><ol>
<li><p>htmlè¯­è¨€æ˜¯è§£é‡Šå‹è¯­è¨€ï¼Œä¸æ˜¯ç¼–è¯‘å‹<br>æµè§ˆå™¨æ˜¯å®¹é”™çš„</p>
</li>
<li><p>htmlé¡µé¢ä¸­ç”±ä¸€å¯¹æ ‡ç­¾ç»„æˆï¼š<html></html></p>
<html> ç§°ä¹‹ä¸º å¼€å§‹æ ‡ç­¾
</html>ç§°ä¹‹ä¸º ç»“æŸæ ‡ç­¾</li>
<li><p>title è¡¨ç¤ºç½‘é¡µçš„æ ‡é¢˜</p>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;title&gt;è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ä¸ªç½‘é¡µ&lt;/title&gt;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥åœ¨metaæ ‡ç­¾ä¸­è®¾ç½®ç¼–ç æ–¹å¼</p>
<meta charset="UTF-8">

<ol start="5">
<li><br>è¡¨ç¤ºæ¢è¡Œ ã€‚bræ ‡ç­¾æ˜¯ä¸€ä¸ªå•æ ‡ç­¾ã€‚å•æ ‡ç­¾ï¼šå¼€å§‹æ ‡ç­¾å’Œç»“æŸæ ‡ç­¾æ˜¯åŒä¸€ä¸ªï¼Œæ–œæ æ”¾åœ¨å•è¯åé¢</li>
<li>p è¡¨ç¤ºæ®µè½æ ‡ç­¾</li>
<li>img æ ‡ç­¾å›¾ç‰‡æ ‡ç­¾<br>  srcå±æ€§è¡¨ç¤ºå›¾ç‰‡æ–‡ä»¶çš„è·¯å¾„<br>  widthå’Œheightè¡¨ç¤ºå›¾ç‰‡çš„å¤§å°<br>  altè¡¨ç¤ºå›¾ç‰‡çš„æç¤º</li>
<li>è·¯å¾„çš„é—®é¢˜ï¼š<ol>
<li>ç›¸å¯¹è·¯å¾„</li>
<li>ç»å¯¹è·¯å¾„</li>
</ol>
</li>
<li>h1~h6 : æ ‡é¢˜æ ‡ç­¾</li>
<li>åˆ—è¡¨æ ‡ç­¾:</li>
</ol>
<ul>
<li><p>ol æœ‰åºåˆ—è¡¨<br>  start è¡¨ç¤ºä»*å¼€å§‹ï¼Œtype æ˜¾ç¤ºçš„ç±»å‹ï¼šA a I i 1(deafult)</p>
  <ol type="a" start="3">
              <li>æ‰«åœ°åƒ§</li>
              <li>è§è¿œå±±</li>
              <li>æ…•å®¹åš</li>
              <li>è™šç«¹</li>
              <li>é˜¿ç´«</li>
          </ol>
  </li>
<li><p>ul æ— åºåˆ—è¡¨<br>  type disc(default) , circle , square</p>
  <ul type="circle">
              <li>ä¹”å³°</li>
              <li>é˜¿æœ±</li>
              <li>é©¬å¤«äºº</li>
              <li>ç™½ä¸–é•œ</li>
          </ul></li>
</ul>
<ol start="11">
<li><p>u ä¸‹åˆ’çº¿ b ç²—ä½“  i æ–œä½“</p>
<p>ä½ æ˜¯<b><i><u>å–œæ¬¢</u></i></b>æ˜¯<b>ç”œ</b>æœˆé¥¼è¿˜æ˜¯<i>å’¸</i><u>æœˆé¥¼</u>ï¼Ÿ</p>
</li>
<li><p>ä¸Šæ ‡ sup   ä¸‹æ ‡ sub</p>
<p>æ°´åˆ†å­çš„åŒ–å­¦å¼ï¼š H<sub>2</sub>O<br>    æ°§æ°”çš„åŒ–å­¦å¼ï¼š O<sup>2</sup></p>
</li>
<li><p>HTMLä¸­çš„å®ä½“ï¼š å°äºå· &amp;lt ; å¤§äºç­‰äºå· &amp;ge ;  ç‰ˆæƒ &amp;copy ;</p>
</li>
<li><p>span ä¸æ¢è¡Œçš„å—æ ‡è®°</p>
</li>
</ol>
<ol start="15">
<li>a è¡¨ç¤ºè¶…é“¾æ¥</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">href é“¾æ¥çš„åœ°å€</span><br><span class="line">target:</span><br><span class="line">	_self åœ¨æœ¬çª—å£æ‰“å¼€</span><br><span class="line">	_blank åœ¨ä¸€ä¸ªæ–°çª—å£æ‰“å¼€</span><br><span class="line">	_parent åœ¨çˆ¶çª—å£æ‰“å¼€</span><br><span class="line">	_top  åœ¨é¡¶å±‚çª—å£æ‰“å¼€</span><br></pre></td></tr></table></figure>

<ol start="16">
<li><p>div  å—çº§æ ‡ç­¾ï¼Œä¼šç‹¬å ä¸€è¡Œ</p>
</li>
<li><p>è¡¨æ ¼	table<br>è¡Œ		tr<br>åˆ—		td<br>è¡¨å¤´åˆ—	th</p>
<p>tableä¸­æœ‰å¦‚ä¸‹å±æ€§ï¼ˆè™½ç„¶å·²ç»æ·˜æ±°ï¼Œä½†æ˜¯æœ€å¥½äº†è§£ä¸€ä¸‹ï¼‰</p>
<ul>
<li>borderï¼šè¡¨æ ¼è¾¹æ¡†çš„ç²—ç»†</li>
<li>width:è¡¨æ ¼çš„å®½åº¦</li>
<li>cellspacingï¼šå•å…ƒæ ¼é—´è·</li>
<li>cellpaddingï¼šå•å…ƒæ ¼å¡«å……</li>
</ul>
<p>trä¸­æœ‰ä¸€ä¸ªå±æ€§ï¼š align -&gt; center , left , right </p>
<p>rowspan : è¡Œåˆå¹¶<br>colspan : åˆ—åˆå¹¶</p>
</li>
</ol>
<table border="1" width="600" cellspacing="0" cellpadding="4">
            <tr align="center">
                <th>å§“å</th>
                <th>é—¨æ´¾</th>
                <th>æˆåç»æŠ€</th>
                <th>å†…åŠŸå€¼</th>
            </tr>
            <tr align="center">
                <td>ä¹”å³°</td>
                <td>ä¸å¸®</td>
                <td>å°‘æ—é•¿æ‹³</td>
                <td>5000</td>
            </tr>
            <tr align="center">
                <td>è™šç«¹</td>
                <td>çµé¹«å®«</td>
                <td>åŒ—å†¥ç¥åŠŸ</td>
                <td>15000</td>
            </tr>
            <tr align="center">
                <td>æ‰«åœ°åƒ§</td>
                <td>å°‘æ—å¯º</td>
                <td>ä¸ƒåäºŒç»æŠ€</td>
                <td>æœªçŸ¥</td>
            </tr>
        </table>

<table border="1" cellspacing="0" cellpadding="4" width="600">
            <tr>
                <th>åç§°</th>
                <th>å•ä»·</th>
                <th>æ•°é‡</th>
                <th>å°è®¡</th>
                <th>æ“ä½œ</th>
            </tr>
            <tr align="center">
                <td>è‹¹æœ</td>
                <td rowspan="2">5</td>
                <td>20</td>
                <td>100</td>
                <td><img src="/2022/09/30/JavaWeb/Learn_data\javaweb\ä»£ç ç´ æèµ„æ–™\Day1-HTML\ä»£ç \02.HTML\imgs/del.jpg" width="24" height="24"></td>
            </tr>
            <tr align="center">
                <td>è è</td>
                <td>15</td>
                <td>45</td>
                <td><img src="/2022/09/30/JavaWeb/Learn_data\javaweb\ä»£ç ç´ æèµ„æ–™\Day1-HTML\ä»£ç \02.HTML\imgs/del.jpg" width="24" height="24"></td>
            </tr>
            <tr align="center">
                <td>è¥¿ç“œ</td>
                <td>6</td>
                <td>6</td>
                <td>36</td>
                <td><img src="/2022/09/30/JavaWeb/Learn_data\javaweb\ä»£ç ç´ æèµ„æ–™\Day1-HTML\ä»£ç \02.HTML\imgs/del.jpg" width="24" height="24"></td>
            </tr>
            <tr align="center">
                <td>æ€»è®¡</td>
                <td colspan="4">181</td>
            </tr>
        </table>



<ol start="18">
<li><p>è¡¨å•	form</p>
<p>actionï¼šæäº¤è¡¨å•çš„ç›®çš„åœ°å€</p>
<p>methodï¼šå‘é€httpä½¿ç”¨çš„æ–¹æ³•</p>
</li>
</ol>
<ol start="19">
<li><p>input type&#x3D;â€textâ€ è¡¨ç¤ºæ–‡æœ¬æ¡† ï¼Œ å…¶ä¸­ nameå±æ€§å¿…é¡»è¦æŒ‡å®šï¼Œå¦åˆ™è¿™ä¸ªæ–‡æœ¬æ¡†çš„æ•°æ®å°†æ¥æ˜¯ä¸ä¼šå‘é€ç»™æœåŠ¡å™¨çš„<br>input type&#x3D;â€passwordâ€ è¡¨ç¤ºå¯†ç æ¡†<br>input type&#x3D;â€radioâ€ è¡¨ç¤ºå•é€‰æŒ‰é’®ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œnameå±æ€§å€¼ä¿æŒä¸€è‡´ï¼Œè¿™æ ·æ‰ä¼šæœ‰äº’æ–¥çš„æ•ˆæœ;å¯<strong>ä»¥é€šè¿‡checkedå±æ€§è®¾ç½®é»˜è®¤é€‰ä¸­çš„é¡¹</strong></p>
<blockquote>
<p>æ³¨æ„ï¼šå±æ€§åå’Œå±æ€§å€¼ç›¸åŒå¯ä»¥åªå†™å±æ€§å</p>
</blockquote>
<p>input type&#x3D;â€checkboxâ€ è¡¨ç¤ºå¤é€‰æ¡†ã€‚nameå±æ€§å€¼å»ºè®®ä¿æŒä¸€è‡´ï¼Œè¿™æ ·å°†æ¥æˆ‘ä»¬æœåŠ¡å™¨ç«¯è·å–å€¼çš„æ—¶å€™è·å–çš„æ˜¯ä¸€ä¸ªæ•°ç»„<br>select è¡¨ç¤ºä¸‹æ‹‰åˆ—è¡¨ã€‚æ¯ä¸€ä¸ªé€‰é¡¹æ˜¯optionï¼Œå…¶ä¸­valueå±æ€§æ˜¯å‘é€ç»™æœåŠ¡å™¨çš„å€¼ , <strong>selectedè¡¨ç¤ºé»˜è®¤é€‰ä¸­çš„é¡¹</strong><br>textarea è¡¨ç¤ºå¤šè¡Œæ–‡æœ¬æ¡†ï¼ˆæˆ–è€…ç§°ä¹‹ä¸ºæ–‡æœ¬åŸŸï¼‰,å®ƒçš„valueå€¼å°±æ˜¯å¼€å§‹ç»“æŸæ ‡ç­¾ä¹‹é—´çš„å†…å®¹<br>input type&#x3D;â€submitâ€ è¡¨ç¤ºæäº¤æŒ‰é’®<br>input type&#x3D;â€resetâ€ è¡¨ç¤ºé‡ç½®æŒ‰é’®<br>input type&#x3D;â€buttonâ€ è¡¨ç¤ºæ™®é€šæŒ‰é’®</p>
</li>
</ol>
<form action="demo04.html" method="post"> 
            æ˜µç§°ï¼š<input type="text" value="è¯·è¾“å…¥ä½ çš„æ˜µç§°"><br>
            å¯†ç ï¼š<input type="password" name="pwd"><br>
            æ€§åˆ«ï¼š<input type="radio" name="gender" value="male">ç”·
      			  <input type="radio" name="gender" value="female" checked>å¥³<br>
            çˆ±å¥½ï¼š<input type="checkbox" name="hobby" value="basketball">ç¯®çƒ
                  <input type="checkbox" name="hobby" value="football" checked>è¶³çƒ
                  <input type="checkbox" name="hobby" value="earth" checked>åœ°çƒ<br>
            æ˜Ÿåº§ï¼š<select name="star">
                    <option value="1">ç™½ç¾Šåº§</option>
                    <option value="2" selected>é‡‘ç‰›åº§</option>
                    <option value="3">åŒå­åº§</option>
                    <option value="4">å¤©èåº§</option>
                    <option value="5">å¤©ç§¤åº§</option>
                  </select><br>
            å¤‡æ³¨ï¼š<textarea name="remark" rows="4" cols="50"></textarea><br>
            <input type="submit" value=" æ³¨ å†Œ ">
            <input type="reset" value="é‡ç½®">
            <input type="button" value="è¿™æ˜¯ä¸€ä¸ªæ™®é€šæŒ‰é’®">
        </form>



<ol start="20">
<li><p>frameset è¡¨ç¤ºé¡µé¢æ¡†æ¶ ï¼Œ è¿™ä¸ªæ ‡ç­¾å·²ç»æ·˜æ±°ï¼Œäº†è§£ï¼Œä¸éœ€è¦æŒæ¡<br>frameè¡¨ç¤ºæ¡†æ¶ä¸­çš„å…·ä½“é¡µé¢å¼•ç”¨</p>
<p>iframe åœ¨ä¸€ä¸ªé¡µé¢åµŒå…¥ä¸€ä¸ªå­é¡µé¢</p>
</li>
</ol>
<h2 id="CSS"><a href="#CSS" class="headerlink" title="CSS"></a>CSS</h2><h3 id="CSSçš„è¯­æ³•"><a href="#CSSçš„è¯­æ³•" class="headerlink" title="CSSçš„è¯­æ³•"></a>CSSçš„è¯­æ³•</h3><ol>
<li><p>ä¸ºä»€ä¹ˆéœ€è¦CSS</p>
<p>æ ‡ç­¾æ ·å¼çš„å¤ªå¤šï¼Œä¸€ä¸ªä¸ªå†™åœ¨æ ‡ç­¾ä¸Šè¿‡äºéº»çƒ¦ï¼Œå†—ä½™ã€‚</p>
</li>
<li><p>CSSçš„æœ€åŸºæœ¬çš„åˆ†ç±»: æ ‡ç­¾æ ·å¼è¡¨ã€ç±»æ ·å¼è¡¨ã€IDæ ·å¼è¡¨</p>
<p>æ ‡ç­¾æ ·å¼è¡¨â€“ä»¥æ ‡ç­¾åä½œä¸ºåå­—</p>
<p>p{<br>            color:red;<br>        }<br>ç±»æ ·å¼è¡¨â€”â€œ.â€å¼€å¤´ï¼ŒåŒ¹é…æ ‡ç­¾ä¸­å±æ€§classåä¸ºf20çš„</p>
<p>.f20{<br>            font-size:20px;<br>        }<br>IDæ ·å¼è¡¨â€”-â€œ#â€å·å¼€å¤´ï¼ŒåŒ¹é…æ ‡ç­¾å±æ€§idåä¸ºp4çš„</p>
<p>#p4{<br>background-color:pink;<br>font-size:24px;<br>font-weight:bolder;<br>font-style:italic;<br>â€‹			}</p>
<blockquote>
<p>idå±æ€§åœ¨æ•´ä¸ªHTMLæ–‡æ¡£ä¸­ï¼Œå°½é‡ä¿æŒå”¯ä¸€ï¼ˆè™½ç„¶é‡å¤ä¹Ÿä¸ä¼šæŠ¥é”™ï¼‰</p>
</blockquote>
<p>ç»„åˆæ ·å¼â€”æŸæ ‡ç­¾ä¸‹çš„å­æ ‡ç­¾</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span> <span class="selector-tag">p</span>&#123;</span><br><span class="line">	<span class="attribute">color</span>:blue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">div</span> <span class="selector-class">.f32</span>&#123;</span><br><span class="line">	<span class="attribute">font-size</span>:<span class="number">32px</span>;</span><br><span class="line">	<span class="attribute">font-family</span>:<span class="string">&quot;é»‘ä½“&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>CSSä»ä½ç½®ä¸Šçš„åˆ†ç±»ï¼šåµŒå…¥å¼æ ·å¼è¡¨ã€å†…éƒ¨æ ·å¼è¡¨ã€å¤–éƒ¨æ ·å¼è¡¨</p>
</li>
</ol>
<p>åµŒå…¥å¼æ ·å¼è¡¨â€”-åµŒå¥—åœ¨åœ¨æ ‡ç­¾å†…çš„æ ·å¼</p>
<p><span style="font-size:60px;font-weight:bolder;color:yellow;">HELLO</span></p>

<p>å†…éƒ¨æ ·å¼è¡¨â€”å³å†™åœ¨å½“å‰htmlæ–‡ä»¶ä¸­çš„</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;style type=&quot;text/css&quot;&gt;</span><br><span class="line">		<span class="comment">/* è¢«styleæ ‡ç­¾åŒ…å›´çš„èŒƒå›´æ˜¯CSSç¯å¢ƒï¼Œå¯ä»¥å†™CSSä»£ç  */</span></span><br><span class="line">		<span class="comment">/* æ ‡ç­¾æ ·å¼è¡¨ */</span></span><br><span class="line">		<span class="selector-tag">p</span>&#123;</span><br><span class="line">			<span class="attribute">color</span>:red;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">/* ç±»æ ·å¼ */</span></span><br><span class="line">		<span class="selector-class">.f20</span>&#123;</span><br><span class="line">			<span class="attribute">font-size</span>:<span class="number">20px</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p>å¤–éƒ¨æ ·å¼è¡¨â€”-å¼•å…¥å¤–éƒ¨çš„æ ·å¼è¡¨æ–‡ä»¶ï¼Œæ–‡ä»¶ä»¥.cssç»“å°¾</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- å¼•ç”¨å¤–éƒ¨çš„CSSæ ·å¼è¡¨æ–‡ä»¶ --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;css/demo01.css&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>





<h3 id="ç›’å­æ¨¡å‹"><a href="#ç›’å­æ¨¡å‹" class="headerlink" title="ç›’å­æ¨¡å‹"></a>ç›’å­æ¨¡å‹</h3><p>IEæµè§ˆå™¨ï¼šå®é™…å°ºå¯¸ &#x3D; width<br>chromeæµè§ˆå™¨ï¼šå®é™…å°ºå¯¸&#x3D; width+å·¦å³borderwidth+padding</p>
<p>CSSç›’å­æ¨¡å‹ï¼š<br>1.border è¾¹æ¡†</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 1. border è¾¹æ¡†æ ·å¼ */</span></span><br><span class="line">				<span class="attribute">border-width</span>:<span class="number">1px</span>;			<span class="comment">/*è¾¹æ¡†ç²—ç»†*/</span></span><br><span class="line">				<span class="attribute">border-style</span>:solid;		<span class="comment">/*è¾¹æ¡†æ ·å¼ï¼šsolid(å®çº¿) , dotted(ç‚¹çŠ¶çº¿) ... */</span></span><br><span class="line">				<span class="attribute">border-color</span>:blue;			<span class="comment">/*è¾¹æ¡†é¢œè‰²*/</span></span><br><span class="line">			<span class="comment">/* border:4px double blue;*/</span>  å¯åˆå¹¶</span><br><span class="line"></span><br><span class="line">			<span class="comment">/* border-top : 4px dotted blue;*/</span></span><br></pre></td></tr></table></figure>



<p>2.margin é—´è·ï¼Œæ˜¯å¤–è¾¹è·ï¼Œå³ç›’å­ä¸ç›’å­ä¹‹é—´çš„è·ç¦»	</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">margin-top</span>:<span class="number">100px</span>;<span class="comment">/*ç›’å­ä¸ç›’å­ä¹‹é—´çš„è·ç¦»*/</span></span><br><span class="line"><span class="attribute">margin-left</span>:<span class="number">100px</span>;	</span><br><span class="line"><span class="comment">/*margin:100px 100px 50px 150px;*/</span> </span><br></pre></td></tr></table></figure>

<blockquote>
<p> ä¸€ä¸ªå€¼ï¼Œå››ä¸ªæ–¹å‘ç»Ÿä¸€ï¼›ä¸¤ä¸ªå€¼ï¼šä¸Šä¸‹ã€å·¦å³ï¼›ä¸‰ä¸ªå€¼ï¼šä¸Šã€å·¦å³ã€ä¸‹ï¼›å››ä¸ªå€¼ï¼šä¸Šå³ä¸‹å·¦ </p>
</blockquote>
<p>3.padding å¡«å……ï¼Œæ˜¯å†…è¾¹è·ï¼Œæ˜¯ç›’å­çš„è¾¹ä¸ç›’å­å†…éƒ¨å…ƒç´ çš„è·ç¦»</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* padding : å¡«å…… */</span></span><br><span class="line">				<span class="attribute">padding-top</span>:<span class="number">50px</span>;  <span class="comment">/*æœ¬æ ‡ç­¾ä»é¡¶éƒ¨è¾¹æ¡†å‘å†…å¡«å……*/</span></span><br><span class="line">				<span class="attribute">padding-left</span>:<span class="number">50px</span>;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>marginæ˜¯ç”¨æ¥éš”å¼€å…ƒç´ ä¸å…ƒç´ çš„é—´è·ï¼›paddingæ˜¯ç”¨æ¥éš”å¼€å…ƒç´ ä¸å†…å®¹çš„é—´éš”ã€‚marginä½¿å…ƒç´ ä¸å…ƒç´ äº’ä¸ç›¸å¹²ï¼›paddingè®©å†…å®¹ï¼ˆæ–‡å­—ï¼‰ä¸ï¼ˆåŒ…è£¹ï¼‰å…ƒç´ ä¹‹é—´æœ‰ä¸€æ®µâ€œå‘¼å¸è·ç¦»â€ã€‚</p>
</blockquote>
<p>è¡¥å……ï¼šæµè§ˆå™¨ä¸ç›’å­ä¹‹é—´åˆå§‹æ—¶ä¼šæœ‰å¾®å°é—´éš”ï¼Œå¯ä»¥é€šè¿‡bodyè¿›è¡Œä¿®æ”¹</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span>&#123;</span><br><span class="line">			<span class="attribute">margin</span>:<span class="number">0</span>;</span><br><span class="line">			<span class="attribute">padding</span>:<span class="number">0</span>;</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>



<h3 id="CSSå¸ƒå±€"><a href="#CSSå¸ƒå±€" class="headerlink" title="CSSå¸ƒå±€"></a>CSSå¸ƒå±€</h3><p>position: absolute â€“ ç»å¯¹å®šä½ , éœ€è¦é…åˆä½¿ç”¨ left , top<br>relative â€“ ç›¸å¯¹å®šä½ , ä¸€èˆ¬ä¼šå’Œ float , margin , padding â€¦. ä¸€èµ·ä½¿ç”¨</p>
<p>æµ®åŠ¨å¯ä»¥ç†è§£ä¸ºè®©æŸä¸ªdivå…ƒç´ è„±ç¦»æ ‡å‡†æµï¼Œæ¼‚æµ®åœ¨æ ‡å‡†æµä¹‹ä¸Šï¼Œå’Œæ ‡å‡†æµä¸æ˜¯â¼€ä¸ªå±‚æ¬¡ã€‚</p>
<p>float æœ‰leftå·¦æµ®åŠ¨å’Œrightå³æµ®åŠ¨ï¼Œé»˜è®¤æ˜¯noneä¸æµ®åŠ¨</p>
<p><a target="_blank" rel="noopener" href="https://wenku.baidu.com/view/f7786fa780d049649b6648d7c1c708a1284a0ada.html">ï¼ˆå›¾æ–‡è¯¦ç»†ï¼‰æœ€é€šä¿—æ˜“æ‡‚çš„CSSæµ®åŠ¨floatå±æ€§è¯¦è§£ - ç™¾åº¦æ–‡åº“ (baidu.com)</a></p>
<h2 id="javascript"><a href="#javascript" class="headerlink" title="javascript"></a>javascript</h2><h3 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h3><p>Javascript : å®¢æˆ·ç«¯çš„ä¸€ä¸ªè„šæœ¬è¯­è¨€<br>jsæ˜¯ä¸€é—¨å¼±ç±»å‹çš„è¯­è¨€ , å˜é‡çš„æ•°æ®ç±»å‹ç”±åé¢èµ‹çš„å€¼çš„ç±»å‹å†³å®š</p>
<p>æœ‰ç‹¬ç«‹æ ‡ç­¾ï¼Œjavascriptä»£ç å†™å…¥å…¶ä¸­</p>
<script language="javascript"> </script>

<h3 id="JavaScriptæ•°æ®ç±»å‹"><a href="#JavaScriptæ•°æ®ç±»å‹" class="headerlink" title="JavaScriptæ•°æ®ç±»å‹"></a>JavaScriptæ•°æ®ç±»å‹</h3><ul>
<li><p>åŸºæœ¬æ•°æ®ç±»å‹</p>
<ul>
<li><p>æ•°å€¼å‹ï¼šJavaScriptä¸åŒºåˆ†æ•´æ•°ã€å°æ•°</p>
</li>
<li><p>å­—ç¬¦ä¸²ï¼šJavaScriptä¸åŒºåˆ†å­—ç¬¦ã€å­—ç¬¦ä¸²ï¼›å•å¼•å·ã€åŒå¼•å·æ„æ€ä¸€æ ·ã€‚</p>
</li>
<li><p>å¸ƒå°”å‹ï¼štrueã€false</p>
<p>åœ¨JavaScriptä¸­ï¼Œå…¶ä»–ç±»å‹å’Œå¸ƒå°”ç±»å‹çš„è‡ªåŠ¨è½¬æ¢ã€‚</p>
<p>trueï¼šéé›¶çš„æ•°å€¼ï¼Œéç©ºå­—ç¬¦ä¸²ï¼Œéç©ºå¯¹è±¡</p>
<p>falseï¼šé›¶ï¼Œç©ºå­—ç¬¦ä¸²ï¼Œnullï¼Œundefined</p>
<p>ä¾‹å¦‚ï¼šâ€falseâ€æ”¾åœ¨ifåˆ¤æ–­ä¸­</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// &quot;false&quot;æ˜¯ä¸€ä¸ªéç©ºå­—ç¬¦ä¸²ï¼Œç›´æ¥æ”¾åœ¨ifåˆ¤æ–­ä¸­ä¼šè¢«å½“ä½œã€çœŸã€å¤„ç†</span></span><br><span class="line"><span class="keyword">if</span>(<span class="string">&quot;false&quot;</span>)&#123;</span><br><span class="line">	<span class="title function_">alert</span>(<span class="string">&quot;true&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">	<span class="title function_">alert</span>(<span class="string">&quot;false&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>å¼•ç”¨ç±»å‹</p>
<ul>
<li><p>æ‰€æœ‰newå‡ºæ¥çš„å¯¹è±¡</p>
</li>
<li><p>ç”¨[]å£°æ˜çš„æ•°ç»„</p>
</li>
<li><p>ç”¨{}å£°æ˜çš„å¯¹è±¡</p>
<pre><code>var str = &quot;hello world&quot;;  ç±»å‹åç§°varåŒ¹é…ä»»æ„ç±»å‹
    alert(typeof str);
    str= 9999 ;
    alert(typeof str);   //typeof strè¿”å›ç±»å‹åç§° //alter()è­¦å‘Šæ¡†
var person = new Object();  //
    person.pid = &quot;p001&quot;;
    person.pname=&quot;é¸ æ‘©æ™º&quot;;
    alert(person.pid+&quot;_&quot;+person.pname);
</code></pre>
</li>
</ul>
</li>
</ul>
<h3 id="å‡½æ•°å£°æ˜"><a href="#å‡½æ•°å£°æ˜" class="headerlink" title="å‡½æ•°å£°æ˜"></a>å‡½æ•°å£°æ˜</h3><p>ç›¸è¾ƒäºjavaçµæ´»ï¼Œçº¦æŸå°‘</p>
<p>ä¸€ä¸ªå‡½æ•°å¯ä»¥æœ‰æˆ–æ²¡æœ‰è¿”å›å€¼ï¼Œå–å†³äºå†™ä¸å†™ï¼Œå½¢å‚å’Œå®å‚æ²¡æœ‰å…·ä½“ç±»å‹å’Œä¸ªæ•°é™åˆ¶ã€‚ä»å·¦å¾€å³ä¸€æ¬¡èµ‹å€¼</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">	</span><br><span class="line">//java æ–¹æ³•</span><br><span class="line">public String hello(String name)&#123;</span><br><span class="line">	return &quot;hello to &quot; + name ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//js æ–¹æ³•</span><br><span class="line">function hello(num1 , num2 , name)&#123;</span><br><span class="line">	if(num1&gt;num2)&#123;</span><br><span class="line">		return &quot;hello to&quot; + name ;</span><br><span class="line">	&#125;else&#123;</span><br><span class="line">		alert(&quot;HELLO&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="é¼ æ ‡æ‚¬æµ®å’Œç¦»å¼€"><a href="#é¼ æ ‡æ‚¬æµ®å’Œç¦»å¼€" class="headerlink" title="é¼ æ ‡æ‚¬æµ®å’Œç¦»å¼€"></a>é¼ æ ‡æ‚¬æµ®å’Œç¦»å¼€</h3><h4 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h4><p>åœ¨æ­¤æ–¹æ³•ä¸­è°ƒç”¨JavaScriptæ–¹æ³•éœ€è¦åœ¨htmlæ ‡ç­¾ä¸­æ˜¾å¼çš„è°ƒç”¨</p>
<p>htmlä»£ç </p>
<div id="div_container">
            <div id="div_fruit_list">
                <table id="tbl_fruit">
                    <tr>
                        <th class="w20">åç§°</th>
                        <th class="w20">å•ä»·</th>
                        <th class="w20">æ•°é‡</th>
                        <th class="w20">å°è®¡</th>
                        <th>æ“ä½œ</th>
                    </tr>
                    <tr onmouseover="showBGColor()" onmouseout="clearBGColor()">
                        <td>è‹¹æœ</td>
                        <td onmouseover="showHand()">5</td>
                        <td>20</td>
                        <td>100</td>
                        <td><img src="/2022/09/30/JavaWeb/del.jpg" class="delImg"></td>
                    </tr>
                    <tr onmouseover="showBGColor()" onmouseout="clearBGColor()">
                        <td>è¥¿ç“œ</td>
                        <td onmouseover="showHand()">3</td>
                        <td>20</td>
                        <td>60</td>
                        <td><img src="/2022/09/30/JavaWeb/del.jpg" class="delImg"></td>
                    </tr>
                    <tr onmouseover="showBGColor()" onmouseout="clearBGColor()">
                        <td>è è</td>
                        <td onmouseover="showHand()">4</td>
                        <td>25</td>
                        <td>100</td>
                        <td><img src="/2022/09/30/JavaWeb/del.jpg" class="delImg"></td>
                    </tr>
                    <tr onmouseover="showBGColor()" onmouseout="clearBGColor()">
                        <td>æ¦´è²</td>
                        <td onmouseover="showHand()">3</td>
                        <td>30</td>
                        <td>90</td>
                        <td><img src="/2022/09/30/JavaWeb/del.jpg" class="delImg"></td>
                    </tr>
                    <tr>
                        <td>æ€»è®¡</td>
                        <td colspan="4">999</td>
                    </tr>
                </table>
            </div>
        </div>

<p>å¯¹åº”javascriptä»£ç ï¼Œåœ¨æ­¤æ–¹æ³•ä¸­è°ƒç”¨JavaScriptæ–¹æ³•éœ€è¦åœ¨htmlæ ‡ç­¾ä¸­æ˜¾å¼çš„è°ƒç”¨</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å½“é¼ æ ‡æ‚¬æµ®æ—¶ï¼Œæ˜¾ç¤ºèƒŒæ™¯é¢œè‰²</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">showBGColor</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="comment">//event : å½“å‰å‘ç”Ÿçš„äº‹ä»¶</span></span><br><span class="line">	<span class="comment">//event.srcElement : äº‹ä»¶æº</span></span><br><span class="line">	<span class="comment">//alert(event.srcElement);</span></span><br><span class="line">	<span class="comment">//alert(event.srcElement.tagName);	--&gt; TD</span></span><br><span class="line">	<span class="keyword">if</span>(event &amp;&amp; event.<span class="property">srcElement</span> &amp;&amp; event.<span class="property">srcElement</span>.<span class="property">tagName</span>==<span class="string">&quot;TD&quot;</span>)&#123;</span><br><span class="line">		<span class="keyword">var</span> td = event.<span class="property">srcElement</span> ;</span><br><span class="line">		<span class="comment">//td.parentElement è¡¨ç¤ºè·å–tdçš„çˆ¶å…ƒç´  -&gt; TR</span></span><br><span class="line">		<span class="keyword">var</span> tr = td.<span class="property">parentElement</span> ;</span><br><span class="line">		<span class="comment">//å¦‚æœæƒ³è¦é€šè¿‡jsä»£ç è®¾ç½®æŸèŠ‚ç‚¹çš„æ ·å¼ï¼Œåˆ™éœ€è¦åŠ ä¸Š .style</span></span><br><span class="line">		tr.<span class="property">style</span>.<span class="property">backgroundColor</span> = <span class="string">&quot;navy&quot;</span> ;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//tr.cellsè¡¨ç¤ºè·å–è¿™ä¸ªträ¸­çš„æ‰€æœ‰çš„å•å…ƒæ ¼</span></span><br><span class="line">		<span class="keyword">var</span> tds = tr.<span class="property">cells</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i&lt;tds.<span class="property">length</span> ; i++)&#123;</span><br><span class="line">			tds[i].<span class="property">style</span>.<span class="property">color</span>=<span class="string">&quot;white&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å½“é¼ æ ‡ç¦»å¼€æ—¶ï¼Œæ¢å¤åŸå§‹æ ·å¼</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">clearBGColor</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="keyword">if</span>(event &amp;&amp; event.<span class="property">srcElement</span> &amp;&amp; event.<span class="property">srcElement</span>.<span class="property">tagName</span>==<span class="string">&quot;TD&quot;</span>)&#123;</span><br><span class="line">		<span class="keyword">var</span> td = event.<span class="property">srcElement</span> ;</span><br><span class="line">		<span class="keyword">var</span> tr = td.<span class="property">parentElement</span> ;</span><br><span class="line">		tr.<span class="property">style</span>.<span class="property">backgroundColor</span>=<span class="string">&quot;transparent&quot;</span>;</span><br><span class="line">		<span class="keyword">var</span> tds = tr.<span class="property">cells</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i&lt;tds.<span class="property">length</span> ; i++)&#123;</span><br><span class="line">			tds[i].<span class="property">style</span>.<span class="property">color</span>=<span class="string">&quot;threeddarkshadow&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å½“é¼ æ ‡æ‚¬æµ®åœ¨å•ä»·å•å…ƒæ ¼æ—¶ï¼Œæ˜¾ç¤ºæ‰‹åŠ¿</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">showHand</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="keyword">if</span>(event &amp;&amp; event.<span class="property">srcElement</span> &amp;&amp; event.<span class="property">srcElement</span>.<span class="property">tagName</span>==<span class="string">&quot;TD&quot;</span>)&#123;</span><br><span class="line">		<span class="keyword">var</span> td = event.<span class="property">srcElement</span> ;</span><br><span class="line">		<span class="comment">//cursor : å…‰æ ‡</span></span><br><span class="line">		td.<span class="property">style</span>.<span class="property">cursor</span>=<span class="string">&quot;hand&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="æ–¹æ³•äºŒ"><a href="#æ–¹æ³•äºŒ" class="headerlink" title="æ–¹æ³•äºŒ"></a>æ–¹æ³•äºŒ</h4><p>æ­¤æ–¹æ³•æ— éœ€åœ¨htmlä»£ç æ ‡ç­¾ä¸­æ˜¾å¼è°ƒç”¨ï¼Œä½¿ä»£ç å˜å¾—ç®€æ´</p>
<p>html<strong>ä»£ç </strong></p>
<div id="div_container">
            <div id="div_fruit_list">
                <table id="tbl_fruit">
                    <tr>
                        <th class="w20">åç§°</th>
                        <th class="w20">å•ä»·</th>
                        <th class="w20">æ•°é‡</th>
                        <th class="w20">å°è®¡</th>
                        <th>æ“ä½œ</th>
                    </tr>
                    <tr>
                        <td>è‹¹æœ</td>
                        <td>5</td>
                        <td>20</td>
                        <td>100</td>
                        <td><img src="/2022/09/30/JavaWeb/del.jpg" class="delImg"></td>
                    </tr>
                    <tr>	
                        <td>è¥¿ç“œ</td>
                        <td>3</td>
                        <td>20</td>
                        <td>60</td>
                        <td><img src="/2022/09/30/JavaWeb/del.jpg" class="delImg"></td>
                    </tr>
                    <tr>
                        <td>è è</td>
                        <td>4</td>
                        <td>25</td>
                        <td>100</td>
                        <td><img src="/2022/09/30/JavaWeb/del.jpg" class="delImg"></td>
                    </tr>
                    <tr>
                        <td>æ¦´è²</td>
                        <td>3</td>
                        <td>30</td>
                        <td>90</td>
                        <td><img src="/2022/09/30/JavaWeb/del.jpg" class="delImg"></td>
                    </tr>
                    <tr>
                        <td>æ€»è®¡</td>
                        <td colspan="4">999</td>
                    </tr>
                </table>
            </div>
        </div>

<p>JavaScript<strong>ä»£ç </strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="property">onload</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="comment">//å½“é¡µé¢åŠ è½½å®Œæˆï¼Œæˆ‘ä»¬éœ€è¦ç»‘å®šå„ç§äº‹ä»¶</span></span><br><span class="line">	<span class="comment">//æ ¹æ®idè·å–åˆ°è¡¨æ ¼</span></span><br><span class="line">	<span class="keyword">var</span> fruitTbl =  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;tbl_fruit&quot;</span>);</span><br><span class="line">	<span class="comment">//è·å–è¡¨æ ¼ä¸­çš„æ‰€æœ‰çš„è¡Œ</span></span><br><span class="line">	<span class="keyword">var</span> rows = fruitTbl.<span class="property">rows</span> ;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">1</span> ; i&lt;rows.<span class="property">length</span>-<span class="number">1</span> ; i++)&#123;</span><br><span class="line">		<span class="keyword">var</span> tr = rows[i];</span><br><span class="line">		<span class="comment">//1.ç»‘å®šé¼ æ ‡æ‚¬æµ®ä»¥åŠç¦»å¼€æ—¶è®¾ç½®èƒŒæ™¯é¢œè‰²äº‹ä»¶</span></span><br><span class="line">		tr.<span class="property">onmouseover</span>=showBGColor; <span class="comment">//è¿™é‡Œè°ƒç”¨ä¸ç”¨åŠ ()</span></span><br><span class="line">		tr.<span class="property">onmouseout</span>=clearBGColor;</span><br><span class="line">		<span class="comment">//è·å–trè¿™ä¸€è¡Œçš„æ‰€æœ‰å•å…ƒæ ¼</span></span><br><span class="line">		<span class="keyword">var</span> cells = tr.<span class="property">cells</span>;</span><br><span class="line">		<span class="keyword">var</span> priceTD = cells[<span class="number">1</span>]; </span><br><span class="line">		<span class="comment">//2.ç»‘å®šé¼ æ ‡æ‚¬æµ®åœ¨å•ä»·å•å…ƒæ ¼å˜æ‰‹åŠ¿çš„äº‹ä»¶</span></span><br><span class="line">		priceTD.<span class="property">onmouseover</span> = showHand ;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å½“é¼ æ ‡æ‚¬æµ®æ—¶ï¼Œæ˜¾ç¤ºèƒŒæ™¯é¢œè‰²</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">showBGColor</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="comment">//event : å½“å‰å‘ç”Ÿçš„äº‹ä»¶</span></span><br><span class="line">	<span class="comment">//event.srcElement : äº‹ä»¶æº</span></span><br><span class="line">	<span class="comment">//alert(event.srcElement);</span></span><br><span class="line">	<span class="comment">//alert(event.srcElement.tagName);	--&gt; TD</span></span><br><span class="line">	<span class="keyword">if</span>(event &amp;&amp; event.<span class="property">srcElement</span> &amp;&amp; event.<span class="property">srcElement</span>.<span class="property">tagName</span>==<span class="string">&quot;TD&quot;</span>)&#123;</span><br><span class="line">		<span class="keyword">var</span> td = event.<span class="property">srcElement</span> ;</span><br><span class="line">		<span class="comment">//td.parentElement è¡¨ç¤ºè·å–tdçš„çˆ¶å…ƒç´  -&gt; TR</span></span><br><span class="line">		<span class="keyword">var</span> tr = td.<span class="property">parentElement</span> ;</span><br><span class="line">		<span class="comment">//å¦‚æœæƒ³è¦é€šè¿‡jsä»£ç è®¾ç½®æŸèŠ‚ç‚¹çš„æ ·å¼ï¼Œåˆ™éœ€è¦åŠ ä¸Š .style</span></span><br><span class="line">		tr.<span class="property">style</span>.<span class="property">backgroundColor</span> = <span class="string">&quot;navy&quot;</span> ;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//tr.cellsè¡¨ç¤ºè·å–è¿™ä¸ªträ¸­çš„æ‰€æœ‰çš„å•å…ƒæ ¼</span></span><br><span class="line">		<span class="keyword">var</span> tds = tr.<span class="property">cells</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i&lt;tds.<span class="property">length</span> ; i++)&#123;</span><br><span class="line">			tds[i].<span class="property">style</span>.<span class="property">color</span>=<span class="string">&quot;white&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å½“é¼ æ ‡ç¦»å¼€æ—¶ï¼Œæ¢å¤åŸå§‹æ ·å¼</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">clearBGColor</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="keyword">if</span>(event &amp;&amp; event.<span class="property">srcElement</span> &amp;&amp; event.<span class="property">srcElement</span>.<span class="property">tagName</span>==<span class="string">&quot;TD&quot;</span>)&#123;</span><br><span class="line">		<span class="keyword">var</span> td = event.<span class="property">srcElement</span> ;</span><br><span class="line">		<span class="keyword">var</span> tr = td.<span class="property">parentElement</span> ;</span><br><span class="line">		tr.<span class="property">style</span>.<span class="property">backgroundColor</span>=<span class="string">&quot;transparent&quot;</span>;</span><br><span class="line">		<span class="keyword">var</span> tds = tr.<span class="property">cells</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i&lt;tds.<span class="property">length</span> ; i++)&#123;</span><br><span class="line">			tds[i].<span class="property">style</span>.<span class="property">color</span>=<span class="string">&quot;threeddarkshadow&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å½“é¼ æ ‡æ‚¬æµ®åœ¨å•ä»·å•å…ƒæ ¼æ—¶ï¼Œæ˜¾ç¤ºæ‰‹åŠ¿</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">showHand</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="keyword">if</span>(event &amp;&amp; event.<span class="property">srcElement</span> &amp;&amp; event.<span class="property">srcElement</span>.<span class="property">tagName</span>==<span class="string">&quot;TD&quot;</span>)&#123;</span><br><span class="line">		<span class="keyword">var</span> td = event.<span class="property">srcElement</span> ;</span><br><span class="line">		<span class="comment">//cursor : å…‰æ ‡</span></span><br><span class="line">		td.<span class="property">style</span>.<span class="property">cursor</span>=<span class="string">&quot;hand&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="æ›´æ–°å•ä»·-å°è®¡-æ€»è®¡"><a href="#æ›´æ–°å•ä»·-å°è®¡-æ€»è®¡" class="headerlink" title="æ›´æ–°å•ä»·-å°è®¡-æ€»è®¡"></a>æ›´æ–°å•ä»·-å°è®¡-æ€»è®¡</h4><p>htmlä»£ç åŒä¸Š</p>
<p>JavaScriptä»£ç </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="property">onload</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="title function_">updateZJ</span>();</span><br><span class="line">	<span class="comment">//å½“é¡µé¢åŠ è½½å®Œæˆï¼Œæˆ‘ä»¬éœ€è¦ç»‘å®šå„ç§äº‹ä»¶</span></span><br><span class="line">	<span class="comment">//æ ¹æ®idè·å–åˆ°è¡¨æ ¼</span></span><br><span class="line">	<span class="keyword">var</span> fruitTbl =  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;tbl_fruit&quot;</span>);</span><br><span class="line">	<span class="comment">//è·å–è¡¨æ ¼ä¸­çš„æ‰€æœ‰çš„è¡Œ</span></span><br><span class="line">	<span class="keyword">var</span> rows = fruitTbl.<span class="property">rows</span> ;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">1</span> ; i&lt;rows.<span class="property">length</span>-<span class="number">1</span> ; i++)&#123;</span><br><span class="line">		<span class="keyword">var</span> tr = rows[i];</span><br><span class="line">		<span class="comment">//1.ç»‘å®šé¼ æ ‡æ‚¬æµ®ä»¥åŠç¦»å¼€æ—¶è®¾ç½®èƒŒæ™¯é¢œè‰²äº‹ä»¶</span></span><br><span class="line">		tr.<span class="property">onmouseover</span>=showBGColor;</span><br><span class="line">		tr.<span class="property">onmouseout</span>=clearBGColor;</span><br><span class="line">		<span class="comment">//è·å–trè¿™ä¸€è¡Œçš„æ‰€æœ‰å•å…ƒæ ¼</span></span><br><span class="line">		<span class="keyword">var</span> cells = tr.<span class="property">cells</span>;</span><br><span class="line">		<span class="keyword">var</span> priceTD = cells[<span class="number">1</span>];</span><br><span class="line">		<span class="comment">//2.ç»‘å®šé¼ æ ‡æ‚¬æµ®åœ¨å•ä»·å•å…ƒæ ¼å˜æ‰‹åŠ¿çš„äº‹ä»¶</span></span><br><span class="line">		priceTD.<span class="property">onmouseover</span> = showHand ;</span><br><span class="line">		<span class="comment">//3.ç»‘å®šé¼ æ ‡ç‚¹å‡»å•ä»·å•å…ƒæ ¼çš„äº‹ä»¶</span></span><br><span class="line">		priceTD.<span class="property">onclick</span>=editPrice;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å½“é¼ æ ‡ç‚¹å‡»å•ä»·å•å…ƒæ ¼æ—¶è¿›è¡Œä»·æ ¼ç¼–è¾‘</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">editPrice</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="keyword">if</span>(event &amp;&amp; event.<span class="property">srcElement</span> &amp;&amp; event.<span class="property">srcElement</span>.<span class="property">tagName</span>==<span class="string">&quot;TD&quot;</span>)&#123;</span><br><span class="line">		<span class="keyword">var</span> priceTD = event.<span class="property">srcElement</span> ;</span><br><span class="line">		<span class="comment">//ç›®çš„æ˜¯åˆ¤æ–­å½“å‰priceTDæœ‰å­èŠ‚ç‚¹ï¼Œè€Œä¸”ç¬¬ä¸€ä¸ªå­èŠ‚ç‚¹æ˜¯æ–‡æœ¬èŠ‚ç‚¹ ï¼Œ TextNodeå¯¹åº”çš„æ˜¯3  ElementNodeå¯¹åº”çš„æ˜¯1</span></span><br><span class="line">		<span class="keyword">if</span>(priceTD.<span class="property">firstChild</span> &amp;&amp; priceTD.<span class="property">firstChild</span>.<span class="property">nodeType</span>==<span class="number">3</span>)&#123;</span><br><span class="line">			<span class="comment">//innerText è¡¨ç¤ºè®¾ç½®æˆ–è€…è·å–å½“å‰èŠ‚ç‚¹çš„å†…éƒ¨æ–‡æœ¬</span></span><br><span class="line">			<span class="keyword">var</span> oldPrice = priceTD.<span class="property">innerText</span> ;</span><br><span class="line">			<span class="comment">//innerHTML è¡¨ç¤ºè®¾ç½®å½“å‰èŠ‚ç‚¹çš„å†…éƒ¨HTML</span></span><br><span class="line">			priceTD.<span class="property">innerHTML</span>=<span class="string">&quot;&lt;input type=&#x27;text&#x27; size=&#x27;4&#x27;/&gt;&quot;</span>;</span><br><span class="line">			<span class="comment">// &lt;td&gt;&lt;input type=&#x27;text&#x27; size=&#x27;4&#x27;/&gt;&lt;/td&gt;</span></span><br><span class="line">			<span class="keyword">var</span> input = priceTD.<span class="property">firstChild</span>;</span><br><span class="line">			<span class="keyword">if</span>(input.<span class="property">tagName</span>==<span class="string">&quot;INPUT&quot;</span>)&#123;</span><br><span class="line">				input.<span class="property">value</span> = oldPrice ;</span><br><span class="line">				<span class="comment">//é€‰ä¸­è¾“å…¥æ¡†å†…éƒ¨çš„æ–‡æœ¬</span></span><br><span class="line">				input.<span class="title function_">select</span>();</span><br><span class="line">				<span class="comment">//4.ç»‘å®šè¾“å…¥æ¡†å¤±å»ç„¦ç‚¹äº‹ä»¶ , å¤±å»ç„¦ç‚¹ï¼Œæ›´æ–°å•ä»·</span></span><br><span class="line">				input.<span class="property">onblur</span>=updatePrice ;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">updatePrice</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="keyword">if</span>(event &amp;&amp; event.<span class="property">srcElement</span> &amp;&amp; event.<span class="property">srcElement</span>.<span class="property">tagName</span>==<span class="string">&quot;INPUT&quot;</span>)&#123;</span><br><span class="line">		<span class="keyword">var</span> input = event.<span class="property">srcElement</span> ;</span><br><span class="line">		<span class="keyword">var</span> newPrice = input.<span class="property">value</span> ;</span><br><span class="line">		<span class="comment">//inputèŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹æ˜¯td</span></span><br><span class="line">		<span class="keyword">var</span> priceTD = input.<span class="property">parentElement</span> ;</span><br><span class="line">		priceTD.<span class="property">innerText</span> = newPrice ;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//æ›´æ–°å½“å‰è¡Œçš„å°è®¡è¿™ä¸€ä¸ªæ ¼å­çš„å€¼</span></span><br><span class="line">		<span class="comment">//priceTD.parentElement tdçš„çˆ¶å…ƒç´ æ˜¯tr</span></span><br><span class="line">		<span class="title function_">updateXJ</span>(priceTD.<span class="property">parentElement</span>);</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ›´æ–°æŒ‡å®šè¡Œçš„å°è®¡</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">updateXJ</span>(<span class="params">tr</span>)&#123;</span><br><span class="line">	<span class="keyword">if</span>(tr &amp;&amp; tr.<span class="property">tagName</span>==<span class="string">&quot;TR&quot;</span>)&#123;</span><br><span class="line">		<span class="keyword">var</span> tds = tr.<span class="property">cells</span>;</span><br><span class="line">		<span class="keyword">var</span> price = tds[<span class="number">1</span>].<span class="property">innerText</span> ;</span><br><span class="line">		<span class="keyword">var</span> count = tds[<span class="number">2</span>].<span class="property">innerText</span> ;</span><br><span class="line">		<span class="comment">//innerTextè·å–åˆ°çš„å€¼çš„ç±»å‹æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œå› æ­¤éœ€è¦ç±»å‹è½¬æ¢ï¼Œæ‰èƒ½è¿›è¡Œæ•°å­¦è¿ç®—</span></span><br><span class="line">		<span class="keyword">var</span> xj = <span class="built_in">parseInt</span>(price) * <span class="built_in">parseInt</span>(count);</span><br><span class="line">		tds[<span class="number">3</span>].<span class="property">innerText</span> = xj ;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//æ›´æ–°æ€»è®¡</span></span><br><span class="line">		<span class="title function_">updateZJ</span>();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ›´æ–°æ€»è®¡</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">updateZJ</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="keyword">var</span> fruitTbl = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;tbl_fruit&quot;</span>);</span><br><span class="line">	<span class="keyword">var</span> rows = fruitTbl.<span class="property">rows</span> ;</span><br><span class="line">	<span class="keyword">var</span> sum = <span class="number">0</span> ;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">1</span>; i&lt;rows.<span class="property">length</span>-<span class="number">1</span> ; i++)&#123;</span><br><span class="line">		<span class="keyword">var</span> tr = rows[i];</span><br><span class="line">		<span class="keyword">var</span> xj = <span class="built_in">parseInt</span>(tr.<span class="property">cells</span>[<span class="number">3</span>].<span class="property">innerText</span>);		<span class="comment">//NaN    not a number ä¸æ˜¯ä¸€ä¸ªæ•°å­—</span></span><br><span class="line">		sum = sum + xj ;</span><br><span class="line">	&#125;</span><br><span class="line">	rows[rows.<span class="property">length</span>-<span class="number">1</span>].<span class="property">cells</span>[<span class="number">1</span>].<span class="property">innerText</span> = sum ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//å½“é¼ æ ‡æ‚¬æµ®æ—¶ï¼Œæ˜¾ç¤ºèƒŒæ™¯é¢œè‰²</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">showBGColor</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="comment">//event : å½“å‰å‘ç”Ÿçš„äº‹ä»¶</span></span><br><span class="line">	<span class="comment">//event.srcElement : äº‹ä»¶æº</span></span><br><span class="line">	<span class="comment">//alert(event.srcElement);</span></span><br><span class="line">	<span class="comment">//alert(event.srcElement.tagName);	--&gt; TD</span></span><br><span class="line">	<span class="keyword">if</span>(event &amp;&amp; event.<span class="property">srcElement</span> &amp;&amp; event.<span class="property">srcElement</span>.<span class="property">tagName</span>==<span class="string">&quot;TD&quot;</span>)&#123;</span><br><span class="line">		<span class="keyword">var</span> td = event.<span class="property">srcElement</span> ;</span><br><span class="line">		<span class="comment">//td.parentElement è¡¨ç¤ºè·å–tdçš„çˆ¶å…ƒç´  -&gt; TR</span></span><br><span class="line">		<span class="keyword">var</span> tr = td.<span class="property">parentElement</span> ;</span><br><span class="line">		<span class="comment">//å¦‚æœæƒ³è¦é€šè¿‡jsä»£ç è®¾ç½®æŸèŠ‚ç‚¹çš„æ ·å¼ï¼Œåˆ™éœ€è¦åŠ ä¸Š .style</span></span><br><span class="line">		tr.<span class="property">style</span>.<span class="property">backgroundColor</span> = <span class="string">&quot;navy&quot;</span> ;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//tr.cellsè¡¨ç¤ºè·å–è¿™ä¸ªträ¸­çš„æ‰€æœ‰çš„å•å…ƒæ ¼</span></span><br><span class="line">		<span class="keyword">var</span> tds = tr.<span class="property">cells</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i&lt;tds.<span class="property">length</span> ; i++)&#123;</span><br><span class="line">			tds[i].<span class="property">style</span>.<span class="property">color</span>=<span class="string">&quot;white&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å½“é¼ æ ‡ç¦»å¼€æ—¶ï¼Œæ¢å¤åŸå§‹æ ·å¼</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">clearBGColor</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="keyword">if</span>(event &amp;&amp; event.<span class="property">srcElement</span> &amp;&amp; event.<span class="property">srcElement</span>.<span class="property">tagName</span>==<span class="string">&quot;TD&quot;</span>)&#123;</span><br><span class="line">		<span class="keyword">var</span> td = event.<span class="property">srcElement</span> ;</span><br><span class="line">		<span class="keyword">var</span> tr = td.<span class="property">parentElement</span> ;</span><br><span class="line">		tr.<span class="property">style</span>.<span class="property">backgroundColor</span>=<span class="string">&quot;transparent&quot;</span>;</span><br><span class="line">		<span class="keyword">var</span> tds = tr.<span class="property">cells</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i&lt;tds.<span class="property">length</span> ; i++)&#123;</span><br><span class="line">			tds[i].<span class="property">style</span>.<span class="property">color</span>=<span class="string">&quot;threeddarkshadow&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å½“é¼ æ ‡æ‚¬æµ®åœ¨å•ä»·å•å…ƒæ ¼æ—¶ï¼Œæ˜¾ç¤ºæ‰‹åŠ¿</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">showHand</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="keyword">if</span>(event &amp;&amp; event.<span class="property">srcElement</span> &amp;&amp; event.<span class="property">srcElement</span>.<span class="property">tagName</span>==<span class="string">&quot;TD&quot;</span>)&#123;</span><br><span class="line">		<span class="keyword">var</span> td = event.<span class="property">srcElement</span> ;</span><br><span class="line">		<span class="comment">//cursor : å…‰æ ‡</span></span><br><span class="line">		td.<span class="property">style</span>.<span class="property">cursor</span>=<span class="string">&quot;hand&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="åˆ é™¤æŒ‡å®šè¡Œå’Œæ§åˆ¶é”®ç›˜çš„è¾“å…¥"><a href="#åˆ é™¤æŒ‡å®šè¡Œå’Œæ§åˆ¶é”®ç›˜çš„è¾“å…¥" class="headerlink" title="åˆ é™¤æŒ‡å®šè¡Œå’Œæ§åˆ¶é”®ç›˜çš„è¾“å…¥"></a>åˆ é™¤æŒ‡å®šè¡Œå’Œæ§åˆ¶é”®ç›˜çš„è¾“å…¥</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="property">onload</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="title function_">updateZJ</span>();</span><br><span class="line">	<span class="comment">//å½“é¡µé¢åŠ è½½å®Œæˆï¼Œæˆ‘ä»¬éœ€è¦ç»‘å®šå„ç§äº‹ä»¶</span></span><br><span class="line">	<span class="comment">//æ ¹æ®idè·å–åˆ°è¡¨æ ¼</span></span><br><span class="line">	<span class="keyword">var</span> fruitTbl =  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;tbl_fruit&quot;</span>);</span><br><span class="line">	<span class="comment">//è·å–è¡¨æ ¼ä¸­çš„æ‰€æœ‰çš„è¡Œ</span></span><br><span class="line">	<span class="keyword">var</span> rows = fruitTbl.<span class="property">rows</span> ;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">1</span> ; i&lt;rows.<span class="property">length</span>-<span class="number">1</span> ; i++)&#123;</span><br><span class="line">		<span class="keyword">var</span> tr = rows[i];</span><br><span class="line">		<span class="comment">//1.ç»‘å®šé¼ æ ‡æ‚¬æµ®ä»¥åŠç¦»å¼€æ—¶è®¾ç½®èƒŒæ™¯é¢œè‰²äº‹ä»¶</span></span><br><span class="line">		tr.<span class="property">onmouseover</span>=showBGColor;</span><br><span class="line">		tr.<span class="property">onmouseout</span>=clearBGColor;</span><br><span class="line">		<span class="comment">//è·å–trè¿™ä¸€è¡Œçš„æ‰€æœ‰å•å…ƒæ ¼</span></span><br><span class="line">		<span class="keyword">var</span> cells = tr.<span class="property">cells</span>;</span><br><span class="line">		<span class="keyword">var</span> priceTD = cells[<span class="number">1</span>];</span><br><span class="line">		<span class="comment">//2.ç»‘å®šé¼ æ ‡æ‚¬æµ®åœ¨å•ä»·å•å…ƒæ ¼å˜æ‰‹åŠ¿çš„äº‹ä»¶</span></span><br><span class="line">		priceTD.<span class="property">onmouseover</span> = showHand ;</span><br><span class="line">		<span class="comment">//3.ç»‘å®šé¼ æ ‡ç‚¹å‡»å•ä»·å•å…ƒæ ¼çš„äº‹ä»¶</span></span><br><span class="line">		priceTD.<span class="property">onclick</span>=editPrice;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		<span class="comment">//7.ç»‘å®šåˆ é™¤å°å›¾æ ‡çš„ç‚¹å‡»äº‹ä»¶</span></span><br><span class="line">		<span class="keyword">var</span> img = cells[<span class="number">4</span>].<span class="property">firstChild</span>;</span><br><span class="line">		<span class="keyword">if</span>(img &amp;&amp; img.<span class="property">tagName</span>==<span class="string">&quot;IMG&quot;</span>)&#123;</span><br><span class="line">			<span class="comment">//ç»‘å®šå•å‡»äº‹ä»¶</span></span><br><span class="line">			img.<span class="property">onclick</span> = delFruit ;</span><br><span class="line">		&#125;</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">delFruit</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="keyword">if</span>(event &amp;&amp; event.<span class="property">srcElement</span> &amp;&amp; event.<span class="property">srcElement</span>.<span class="property">tagName</span>==<span class="string">&quot;IMG&quot;</span>)&#123;</span><br><span class="line">		<span class="comment">//alertè¡¨ç¤ºå¼¹å‡ºä¸€ä¸ªå¯¹è¯æ¡†ï¼Œåªæœ‰ç¡®å®šæŒ‰é’®</span></span><br><span class="line">		<span class="comment">//confirmè¡¨ç¤ºå¼¹å‡ºä¸€ä¸ªå¯¹è¯æ¡†ï¼Œæœ‰ç¡®å®šå’Œå–æ¶ˆæŒ‰é’®ã€‚å½“ç‚¹å‡»ç¡®å®šï¼Œè¿”å›trueï¼Œå¦åˆ™è¿”å›false</span></span><br><span class="line">		<span class="keyword">if</span>(<span class="variable language_">window</span>.<span class="title function_">confirm</span>(<span class="string">&quot;æ˜¯å¦ç¡®è®¤åˆ é™¤å½“å‰åº“å­˜è®°å½•&quot;</span>))&#123;</span><br><span class="line">			<span class="keyword">var</span> img = event.<span class="property">srcElement</span> ;</span><br><span class="line">			<span class="keyword">var</span> tr = img.<span class="property">parentElement</span>.<span class="property">parentElement</span> ;</span><br><span class="line">			<span class="keyword">var</span> fruitTbl = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;tbl_fruit&quot;</span>);</span><br><span class="line">			fruitTbl.<span class="title function_">deleteRow</span>(tr.<span class="property">rowIndex</span>);</span><br><span class="line"></span><br><span class="line">			<span class="title function_">updateZJ</span>();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å½“é¼ æ ‡ç‚¹å‡»å•ä»·å•å…ƒæ ¼æ—¶è¿›è¡Œä»·æ ¼ç¼–è¾‘</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">editPrice</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="keyword">if</span>(event &amp;&amp; event.<span class="property">srcElement</span> &amp;&amp; event.<span class="property">srcElement</span>.<span class="property">tagName</span>==<span class="string">&quot;TD&quot;</span>)&#123;</span><br><span class="line">		<span class="keyword">var</span> priceTD = event.<span class="property">srcElement</span> ;</span><br><span class="line">		<span class="comment">//ç›®çš„æ˜¯åˆ¤æ–­å½“å‰priceTDæœ‰å­èŠ‚ç‚¹ï¼Œè€Œä¸”ç¬¬ä¸€ä¸ªå­èŠ‚ç‚¹æ˜¯æ–‡æœ¬èŠ‚ç‚¹ ï¼Œ TextNodeå¯¹åº”çš„æ˜¯3  ElementNodeå¯¹åº”çš„æ˜¯1</span></span><br><span class="line">		<span class="keyword">if</span>(priceTD.<span class="property">firstChild</span> &amp;&amp; priceTD.<span class="property">firstChild</span>.<span class="property">nodeType</span>==<span class="number">3</span>)&#123;</span><br><span class="line">			<span class="comment">//innerText è¡¨ç¤ºè®¾ç½®æˆ–è€…è·å–å½“å‰èŠ‚ç‚¹çš„å†…éƒ¨æ–‡æœ¬</span></span><br><span class="line">			<span class="keyword">var</span> oldPrice = priceTD.<span class="property">innerText</span> ;</span><br><span class="line">			<span class="comment">//innerHTML è¡¨ç¤ºè®¾ç½®å½“å‰èŠ‚ç‚¹çš„å†…éƒ¨HTML</span></span><br><span class="line">			priceTD.<span class="property">innerHTML</span>=<span class="string">&quot;&lt;input type=&#x27;text&#x27; size=&#x27;4&#x27;/&gt;&quot;</span>;</span><br><span class="line">			<span class="comment">// &lt;td&gt;&lt;input type=&#x27;text&#x27; size=&#x27;4&#x27;/&gt;&lt;/td&gt;</span></span><br><span class="line">			<span class="keyword">var</span> input = priceTD.<span class="property">firstChild</span>;</span><br><span class="line">			<span class="keyword">if</span>(input.<span class="property">tagName</span>==<span class="string">&quot;INPUT&quot;</span>)&#123;</span><br><span class="line">				input.<span class="property">value</span> = oldPrice ;</span><br><span class="line">				<span class="comment">//é€‰ä¸­è¾“å…¥æ¡†å†…éƒ¨çš„æ–‡æœ¬</span></span><br><span class="line">				input.<span class="title function_">select</span>();</span><br><span class="line">				<span class="comment">//4.ç»‘å®šè¾“å…¥æ¡†å¤±å»ç„¦ç‚¹äº‹ä»¶ , å¤±å»ç„¦ç‚¹ï¼Œæ›´æ–°å•ä»·</span></span><br><span class="line">				input.<span class="property">onblur</span>=updatePrice ;</span><br><span class="line"></span><br><span class="line">				<span class="comment">//8.åœ¨è¾“å…¥æ¡†ä¸Šç»‘å®šé”®ç›˜æ‘ä¸‹çš„äº‹ä»¶ï¼Œæ­¤å¤„æˆ‘éœ€è¦ä¿è¯ç”¨æˆ·è¾“å…¥çš„æ˜¯æ•°å­—</span></span><br><span class="line">				input.<span class="property">onkeydown</span>=ckInput;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ£€éªŒé”®ç›˜æ‘ä¸‹çš„å€¼çš„æ–¹æ³•</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ckInput</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="keyword">var</span> kc = event.<span class="property">keyCode</span> ;</span><br><span class="line">	<span class="comment">// 0 ~ 9 : 48~57</span></span><br><span class="line">	<span class="comment">//backspace : 8</span></span><br><span class="line">	<span class="comment">//enter : 13</span></span><br><span class="line">	<span class="comment">//console.log(kc);</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(!( ( kc&gt;=<span class="number">48</span> &amp;&amp; kc&lt;=<span class="number">57</span> ) || kc==<span class="number">8</span> || kc==<span class="number">13</span> ))&#123;</span><br><span class="line">		event.<span class="property">returnValue</span>=<span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span>(kc==<span class="number">13</span>)&#123;</span><br><span class="line">		event.<span class="property">srcElement</span>.<span class="title function_">blur</span>();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ›´æ–°å•ä»·çš„æ–¹æ³•</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">updatePrice</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="keyword">if</span>(event &amp;&amp; event.<span class="property">srcElement</span> &amp;&amp; event.<span class="property">srcElement</span>.<span class="property">tagName</span>==<span class="string">&quot;INPUT&quot;</span>)&#123;</span><br><span class="line">		<span class="keyword">var</span> input = event.<span class="property">srcElement</span> ;</span><br><span class="line">		<span class="keyword">var</span> newPrice = input.<span class="property">value</span> ;</span><br><span class="line">		<span class="comment">//inputèŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹æ˜¯td</span></span><br><span class="line">		<span class="keyword">var</span> priceTD = input.<span class="property">parentElement</span> ;</span><br><span class="line">		priceTD.<span class="property">innerText</span> = newPrice ;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//5. æ›´æ–°å½“å‰è¡Œçš„å°è®¡è¿™ä¸€ä¸ªæ ¼å­çš„å€¼</span></span><br><span class="line">		<span class="comment">//priceTD.parentElement tdçš„çˆ¶å…ƒç´ æ˜¯tr</span></span><br><span class="line">		<span class="title function_">updateXJ</span>(priceTD.<span class="property">parentElement</span>);</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ›´æ–°æŒ‡å®šè¡Œçš„å°è®¡</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">updateXJ</span>(<span class="params">tr</span>)&#123;</span><br><span class="line">	<span class="keyword">if</span>(tr &amp;&amp; tr.<span class="property">tagName</span>==<span class="string">&quot;TR&quot;</span>)&#123;</span><br><span class="line">		<span class="keyword">var</span> tds = tr.<span class="property">cells</span>;</span><br><span class="line">		<span class="keyword">var</span> price = tds[<span class="number">1</span>].<span class="property">innerText</span> ;</span><br><span class="line">		<span class="keyword">var</span> count = tds[<span class="number">2</span>].<span class="property">innerText</span> ;</span><br><span class="line">		<span class="comment">//innerTextè·å–åˆ°çš„å€¼çš„ç±»å‹æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œå› æ­¤éœ€è¦ç±»å‹è½¬æ¢ï¼Œæ‰èƒ½è¿›è¡Œæ•°å­¦è¿ç®—</span></span><br><span class="line">		<span class="keyword">var</span> xj = <span class="built_in">parseInt</span>(price) * <span class="built_in">parseInt</span>(count);</span><br><span class="line">		tds[<span class="number">3</span>].<span class="property">innerText</span> = xj ;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//6. æ›´æ–°æ€»è®¡</span></span><br><span class="line">		<span class="title function_">updateZJ</span>();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ›´æ–°æ€»è®¡</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">updateZJ</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="keyword">var</span> fruitTbl = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;tbl_fruit&quot;</span>);</span><br><span class="line">	<span class="keyword">var</span> rows = fruitTbl.<span class="property">rows</span> ;</span><br><span class="line">	<span class="keyword">var</span> sum = <span class="number">0</span> ;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">1</span>; i&lt;rows.<span class="property">length</span>-<span class="number">1</span> ; i++)&#123;</span><br><span class="line">		<span class="keyword">var</span> tr = rows[i];</span><br><span class="line">		<span class="keyword">var</span> xj = <span class="built_in">parseInt</span>(tr.<span class="property">cells</span>[<span class="number">3</span>].<span class="property">innerText</span>);		<span class="comment">//NaN    not a number ä¸æ˜¯ä¸€ä¸ªæ•°å­—</span></span><br><span class="line">		sum = sum + xj ;</span><br><span class="line">	&#125;</span><br><span class="line">	rows[rows.<span class="property">length</span>-<span class="number">1</span>].<span class="property">cells</span>[<span class="number">1</span>].<span class="property">innerText</span> = sum ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//å½“é¼ æ ‡æ‚¬æµ®æ—¶ï¼Œæ˜¾ç¤ºèƒŒæ™¯é¢œè‰²</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">showBGColor</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="comment">//event : å½“å‰å‘ç”Ÿçš„äº‹ä»¶</span></span><br><span class="line">	<span class="comment">//event.srcElement : äº‹ä»¶æº</span></span><br><span class="line">	<span class="comment">//alert(event.srcElement);</span></span><br><span class="line">	<span class="comment">//alert(event.srcElement.tagName);	--&gt; TD</span></span><br><span class="line">	<span class="keyword">if</span>(event &amp;&amp; event.<span class="property">srcElement</span> &amp;&amp; event.<span class="property">srcElement</span>.<span class="property">tagName</span>==<span class="string">&quot;TD&quot;</span>)&#123;</span><br><span class="line">		<span class="keyword">var</span> td = event.<span class="property">srcElement</span> ;</span><br><span class="line">		<span class="comment">//td.parentElement è¡¨ç¤ºè·å–tdçš„çˆ¶å…ƒç´  -&gt; TR</span></span><br><span class="line">		<span class="keyword">var</span> tr = td.<span class="property">parentElement</span> ;</span><br><span class="line">		<span class="comment">//å¦‚æœæƒ³è¦é€šè¿‡jsä»£ç è®¾ç½®æŸèŠ‚ç‚¹çš„æ ·å¼ï¼Œåˆ™éœ€è¦åŠ ä¸Š .style</span></span><br><span class="line">		tr.<span class="property">style</span>.<span class="property">backgroundColor</span> = <span class="string">&quot;navy&quot;</span> ;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//tr.cellsè¡¨ç¤ºè·å–è¿™ä¸ªträ¸­çš„æ‰€æœ‰çš„å•å…ƒæ ¼</span></span><br><span class="line">		<span class="keyword">var</span> tds = tr.<span class="property">cells</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i&lt;tds.<span class="property">length</span> ; i++)&#123;</span><br><span class="line">			tds[i].<span class="property">style</span>.<span class="property">color</span>=<span class="string">&quot;white&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å½“é¼ æ ‡ç¦»å¼€æ—¶ï¼Œæ¢å¤åŸå§‹æ ·å¼</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">clearBGColor</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="keyword">if</span>(event &amp;&amp; event.<span class="property">srcElement</span> &amp;&amp; event.<span class="property">srcElement</span>.<span class="property">tagName</span>==<span class="string">&quot;TD&quot;</span>)&#123;</span><br><span class="line">		<span class="keyword">var</span> td = event.<span class="property">srcElement</span> ;</span><br><span class="line">		<span class="keyword">var</span> tr = td.<span class="property">parentElement</span> ;</span><br><span class="line">		tr.<span class="property">style</span>.<span class="property">backgroundColor</span>=<span class="string">&quot;transparent&quot;</span>;</span><br><span class="line">		<span class="keyword">var</span> tds = tr.<span class="property">cells</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i&lt;tds.<span class="property">length</span> ; i++)&#123;</span><br><span class="line">			tds[i].<span class="property">style</span>.<span class="property">color</span>=<span class="string">&quot;threeddarkshadow&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å½“é¼ æ ‡æ‚¬æµ®åœ¨å•ä»·å•å…ƒæ ¼æ—¶ï¼Œæ˜¾ç¤ºæ‰‹åŠ¿</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">showHand</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="keyword">if</span>(event &amp;&amp; event.<span class="property">srcElement</span> &amp;&amp; event.<span class="property">srcElement</span>.<span class="property">tagName</span>==<span class="string">&quot;TD&quot;</span>)&#123;</span><br><span class="line">		<span class="keyword">var</span> td = event.<span class="property">srcElement</span> ;</span><br><span class="line">		<span class="comment">//cursor : å…‰æ ‡</span></span><br><span class="line">		td.<span class="property">style</span>.<span class="property">cursor</span>=<span class="string">&quot;hand&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="CSå’ŒBSçš„å¼‚åŒç‚¹"><a href="#CSå’ŒBSçš„å¼‚åŒç‚¹" class="headerlink" title="CSå’ŒBSçš„å¼‚åŒç‚¹"></a>CSå’ŒBSçš„å¼‚åŒç‚¹</h2><p>CSï¼šå®¢æˆ·ç«¯æœåŠ¡å™¨æ¶æ„æ¨¡å¼</p>
<ul>
<li>ä¼˜ç‚¹ï¼šå……åˆ†åˆ©ç”¨å®¢æˆ·ç«¯æœºå™¨çš„èµ„æºï¼Œå‡è½»æœåŠ¡å™¨çš„è´Ÿè·ï¼ˆä¸€éƒ¨åˆ†å®‰å…¨è¦æ±‚ä¸é«˜çš„è®¡ç®—ä»»åŠ¡å­˜å‚¨ä»»åŠ¡æ”¾åœ¨å®¢æˆ·ç«¯æ‰§è¡Œï¼Œä¸éœ€è¦æŠŠæ‰€æœ‰çš„è®¡ç®—å’Œå­˜å‚¨éƒ½åœ¨æœåŠ¡ç«¯æ‰§è¡Œï¼Œä»è€Œèƒ½å¤Ÿå‡è½»æœåŠ¡å™¨çš„å‹åŠ›ï¼Œä¹Ÿèƒ½å¤Ÿå‡è½»ç½‘ç»œè´Ÿè·ï¼‰</li>
<li>ç¼ºç‚¹ï¼šéœ€è¦å®‰è£…ï¼›å‡çº§ç»´æŠ¤æˆæœ¬è¾ƒé«˜</li>
</ul>
<p>BSï¼šæµè§ˆå™¨æœåŠ¡å™¨æ¶æ„æ¨¡å¼</p>
<ul>
<li>ä¼˜ç‚¹ï¼šå®¢æˆ·ç«¯ä¸è®¸éœ€è¦å®‰è£…ï¼›ç»´æŠ¤æˆæœ¬è¾ƒä½</li>
<li>ç¼ºç‚¹ï¼šæ‰€æœ‰çš„è®¡ç®—å’Œå­˜å‚¨ä»»åŠ¡éƒ½æ˜¯æ”¾åœ¨æœåŠ¡å™¨ç«¯çš„ï¼ŒæœåŠ¡å™¨çš„è´Ÿè·è¾ƒé‡ï¼›åœ¨æœåŠ¡å™¨è®¡ç®—å®Œæˆä¹‹åæŠŠç»“æœåœ¨ä¼ è¾“ç»™å®¢æˆ·ç«¯ï¼Œå› æ­¤å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯ä¼šè¿›è¡Œéå¸¸é¢‘ç¹çš„æ•°æ®é€šä¿¡ï¼Œä»è€Œç½‘ç»œè´Ÿè·è¾ƒé‡</li>
</ul>
<h2 id="Tomcat"><a href="#Tomcat" class="headerlink" title="Tomcat"></a>Tomcat</h2><h3 id="Tomcatçš„éƒ¨ç½²è¿è¡Œ"><a href="#Tomcatçš„éƒ¨ç½²è¿è¡Œ" class="headerlink" title="Tomcatçš„éƒ¨ç½²è¿è¡Œ"></a>Tomcatçš„éƒ¨ç½²è¿è¡Œ</h3><p><img src="/2022/09/30/JavaWeb/image-20220619142600475.png" alt="image-20220619142600475"></p>
<blockquote>
<p>baiduæ–‡ä»¶å¤¹ä½œä¸ºé¡¹ç›®çš„å­˜æ”¾ä½ç½®</p>
</blockquote>
<h3 id="Tomcatéƒ¨ç½²è¿è¡Œåœ¨idea"><a href="#Tomcatéƒ¨ç½²è¿è¡Œåœ¨idea" class="headerlink" title="Tomcatéƒ¨ç½²è¿è¡Œåœ¨idea"></a>Tomcatéƒ¨ç½²è¿è¡Œåœ¨idea</h3><p>å…ˆåˆ›å»ºä¸€ä¸ªjavaå·¥ç¨‹ï¼Œåœ¨å·¥ç¨‹ä¸‹åˆ›å»ºä¸€ä¸ªjavaæ¨¡å—ï¼Œå†æ¬¡javaæ¨¡å—ä¸‹æ·»åŠ webåº”ç”¨æ¡†æ¶ï¼Œå°±æ­¤webé¡¹ç›®å°±åˆ›å»ºæˆåŠŸ</p>
<p><img src="/2022/09/30/JavaWeb/image-20220619142935124.png" alt="image-20220619142935124"></p>
<p>åˆ›å»ºTomcatæ¨¡æ¿</p>
<p><img src="/2022/09/30/JavaWeb/image-20220619143035494.png" alt="image-20220619143035494"></p>
<p><img src="/2022/09/30/JavaWeb/image-20220619143223910.png" alt="image-20220619143223910"></p>
<p>æ·»åŠ Tomcat</p>
<p><img src="/2022/09/30/JavaWeb/image-20220619143316111.png" alt="image-20220619143316111"></p>
<blockquote>
<p>URLæ˜¯tomcaté»˜è®¤è®¿é—®åœ°å€</p>
</blockquote>
<p>æ³¨æ„ï¼š</p>
<p><img src="/2022/09/30/JavaWeb/image-20220702143544183.png" alt="image-20220702143544183"></p>
<blockquote>
<p>Application context åœ°å€è¦ä¸URLä¸­çš„contextåœ°å€ä¸€è‡´ï¼Œè¿™è¡¨ç¤ºå½“å‰ä¸Šä¸‹æ–‡çš„å…¥å£</p>
</blockquote>
<h1 id="Servlet"><a href="#Servlet" class="headerlink" title="Servlet"></a>Servlet</h1><h2 id="1ã€Servletæ¦‚è¿°"><a href="#1ã€Servletæ¦‚è¿°" class="headerlink" title="1ã€Servletæ¦‚è¿°"></a>1ã€Servletæ¦‚è¿°</h2><h3 id="1-Servletåå­—"><a href="#1-Servletåå­—" class="headerlink" title="1.Servletåå­—"></a>1.Servletåå­—</h3><p>Servlet&#x3D;Server+applet</p>
<p>Serverï¼šæœåŠ¡å™¨</p>
<p>appletï¼šå°ç¨‹åº</p>
<p>Servletå«ä¹‰æ˜¯æœåŠ¡å™¨ç«¯çš„å°ç¨‹åº</p>
<h3 id="2-Servletåœ¨æ•´ä¸ªWebåº”ç”¨ä¸­èµ·åˆ°çš„ä½œç”¨"><a href="#2-Servletåœ¨æ•´ä¸ªWebåº”ç”¨ä¸­èµ·åˆ°çš„ä½œç”¨" class="headerlink" title="2.Servletåœ¨æ•´ä¸ªWebåº”ç”¨ä¸­èµ·åˆ°çš„ä½œç”¨"></a>2.Servletåœ¨æ•´ä¸ªWebåº”ç”¨ä¸­èµ·åˆ°çš„ä½œç”¨</h3><p><img src="/2022/09/30/JavaWeb/image-20220630195102715.png" alt="image-20220630195102715"></p>
<p>åœ¨æ•´ä¸ªWebåº”ç”¨ä¸­ï¼ŒServletä¸»è¦è´Ÿè´£å¤„ç†è¯·æ±‚ã€åè°ƒè°ƒåº¦åŠŸèƒ½ã€‚æˆ‘ä»¬å¯ä»¥æŠŠServletç§°ä¸ºWebåº”ç”¨ä¸­çš„<strong>ã€æ§åˆ¶å™¨ã€</strong></p>
<h2 id="2ã€Servletå…¥é—¨å®ä¾‹"><a href="#2ã€Servletå…¥é—¨å®ä¾‹" class="headerlink" title="2ã€Servletå…¥é—¨å®ä¾‹"></a>2ã€Servletå…¥é—¨å®ä¾‹</h2><p>åˆ›å»ºä¸€ä¸ªjavawebæ¨¡å—</p>
<p><img src="/2022/09/30/JavaWeb/image-20220630200546258.png" alt="image-20220630200546258"></p>
<blockquote>
<p>è¿™é‡Œå¦‚æœä¸èƒ½ç›´æ¥åˆ›å»ºJavawebæ¨¡å—è¿™å¯ä»¥å…ˆåˆ›å»ºJavaæ¨¡å—ï¼Œåå³é”®æ¨¡å—æ–‡ä»¶â€”&gt;ç‚¹å‡»Add Framework Support å°†WebåŠ å…¥åˆ°æœ¬æ¨¡å—ä¸­</p>
</blockquote>
<p>åˆ›å»ºlibæ–‡ä»¶åœ¨å·¥ç¨‹ä¸‹ï¼Œå¯¼å…¥jaråŒ…ï¼Œå³å¯¼å…¥mysqlé©±åŠ¨</p>
<p><img src="/2022/09/30/JavaWeb/image-20220630200721149.png" alt="image-20220630200721149"></p>
<blockquote>
<p>è¿™é‡Œæ˜¯tomcat9.0çš„ï¼Œé€‚é…MySQL5.1.7ï¼Œä¸çŸ¥é“ä¸ºå•¥ï¼ŒMySQL8.0é©±åŠ¨ä¸é€‚é…</p>
</blockquote>
<p>å³é”®libæ–‡ä»¶å¤¹â€“&gt;as a library ï¼Œä½¿ä¹‹åŠ å…¥library</p>
<p>æœ€ä¸Šæ–¹File â€”&gt; Project Structure </p>
<ul>
<li>åœ¨é¡µé¢æ¡†å³è¾¹Modulesï¼Œé€‰æ‹©å¯¹åº”æ¨¡å—ï¼Œé€‰æ‹©Dependenciesä¾èµ–ï¼Œæ·»åŠ åˆšåˆšåŠ å…¥mysqlé©±åŠ¨åˆ°ä¾èµ–ä¸­</li>
<li>åœ¨é¡µé¢æ¡†å³è¾¹problemï¼Œè§£å†³å‡ºç°çš„é—®é¢˜ï¼ˆå°†libåŠ å…¥artifactsï¼‰</li>
</ul>
<p>ç¼–å†™ç½‘é¡µhtmlï¼Œè¡¨å•ç”¨æ¥æäº¤å‘é€æ•°æ®åˆ°æœåŠ¡å™¨</p>
<p><img src="/2022/09/30/JavaWeb/image-20220630202454142.png" alt="image-20220630202454142"></p>
<p>ç¼–å†™addServletï¼Œè·å–è¯·æ±‚ä¸­çš„æ•°æ®ï¼Œç¼–å†™JDBCå°†æ•°æ®ä¿å­˜åˆ°æ•°æ®åº“</p>
<p><img src="/2022/09/30/JavaWeb/image-20220630203516754.png" alt="image-20220630203516754"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AddServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">fname</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;fname&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">priceStr</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;price&quot;</span>);</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">price</span> <span class="operator">=</span> Integer.parseInt(priceStr);</span><br><span class="line">        <span class="type">String</span> <span class="variable">fcountStr</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;fcount&quot;</span>);</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">fcount</span> <span class="operator">=</span> Integer.parseInt(fcountStr);</span><br><span class="line">        <span class="type">String</span> <span class="variable">remark</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;remark&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">FruitDAO</span> <span class="variable">fruitDAO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FruitDAOImpl</span>();</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> fruitDAO.addFruit(<span class="keyword">new</span> <span class="title class_">Fruit</span>(<span class="number">0</span> , fname , price , fcount , remark));</span><br><span class="line"></span><br><span class="line">        System.out.println(flag ? <span class="string">&quot;æ·»åŠ æˆåŠŸï¼&quot;</span> : <span class="string">&quot;æ·»åŠ å¤±è´¥ï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é…ç½®xmlæ–‡ä»¶ï¼Œå› ä¸ºç”¨æˆ·å°†æ•°æ®å‘é€ç»™addï¼Œé‚£æˆ‘ä»¬å°±å¾—é…ç½®ï¼Œä½¿å¾—æœåŠ¡å™¨èƒ½å¤Ÿæ‰¾åˆ°addå¯¹åº”çš„addServletç±»</p>
<p><img src="/2022/09/30/JavaWeb/image-20220630202751833.png" alt="image-20220630202751833"></p>
<ol>
<li>ç”¨æˆ·å‘è¯·æ±‚ï¼Œaction&#x3D;add</li>
<li>é¡¹ç›®ä¸­ï¼Œweb.xmlä¸­æ‰¾åˆ°url-pattern &#x3D; &#x2F;add   -&gt; ç¬¬12è¡Œ</li>
<li>æ‰¾ç¬¬11è¡Œçš„servlet-name &#x3D; AddServlet</li>
<li>æ‰¾å’Œservlet-mappingä¸­servlet-nameä¸€è‡´çš„servlet ï¼Œ æ‰¾åˆ°ç¬¬7è¡Œ</li>
<li>æ‰¾ç¬¬8è¡Œçš„servlet-class -&gt; com.atguigu.servlets.AddServlet</li>
<li>ç”¨æˆ·å‘é€çš„æ˜¯postè¯·æ±‚ï¼ˆmethod&#x3D;postï¼‰ ï¼Œ å› æ­¤ tomcatä¼šæ‰§è¡ŒAddServletä¸­çš„doPostæ–¹æ³•</li>
</ol>
<p>ä¹‹åå°±å¯ä»¥è¿è¡Œtomcatï¼Œåœ¨å‡ºç°çš„è¡¨å•ä¸­å¡«å†™æ•°æ®ï¼Œæäº¤ï¼Œå‘é€åˆ°æœåŠ¡å™¨ï¼Œservletè¿›è¡Œæ•°æ®å¤„ç†ä¹‹ååŠ å…¥æ•°æ®åº“</p>
<h3 id="è®¾ç½®ç¼–ç é—®é¢˜"><a href="#è®¾ç½®ç¼–ç é—®é¢˜" class="headerlink" title="è®¾ç½®ç¼–ç é—®é¢˜"></a>è®¾ç½®ç¼–ç é—®é¢˜</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">è®¾ç½®ç¼–ç </span><br><span class="line">tomcat8ä¹‹å‰ï¼Œè®¾ç½®ç¼–ç ï¼š</span><br><span class="line">  1)getè¯·æ±‚æ–¹å¼ï¼š</span><br><span class="line">    //getæ–¹å¼ç›®å‰ä¸éœ€è¦è®¾ç½®ç¼–ç ï¼ˆåŸºäºtomcat8ï¼‰</span><br><span class="line">    //å¦‚æœæ˜¯getè¯·æ±‚å‘é€çš„ä¸­æ–‡æ•°æ®ï¼Œè½¬ç ç¨å¾®æœ‰ç‚¹éº»çƒ¦ï¼ˆtomcat8ä¹‹å‰ï¼‰</span><br><span class="line">    String fname = request.getParameter(&quot;fname&quot;);</span><br><span class="line">    //1.å°†å­—ç¬¦ä¸²æ‰“æ•£æˆå­—èŠ‚æ•°ç»„</span><br><span class="line">    byte[] bytes = fname.getBytes(&quot;ISO-8859-1&quot;);</span><br><span class="line">    //2.å°†å­—èŠ‚æ•°ç»„æŒ‰ç…§è®¾å®šçš„ç¼–ç é‡æ–°ç»„è£…æˆå­—ç¬¦ä¸²</span><br><span class="line">    fname = new String(bytes,&quot;UTF-8&quot;);</span><br><span class="line">  2)postè¯·æ±‚æ–¹å¼ï¼š</span><br><span class="line">    request.setCharacterEncoding(&quot;UTF-8&quot;);</span><br><span class="line">tomcat8å¼€å§‹ï¼Œè®¾ç½®ç¼–ç ï¼Œåªéœ€è¦é’ˆå¯¹postæ–¹å¼</span><br><span class="line">    request.setCharacterEncoding(&quot;UTF-8&quot;);</span><br><span class="line">æ³¨æ„ï¼š</span><br><span class="line">    éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè®¾ç½®ç¼–ç (post)è¿™ä¸€å¥ä»£ç å¿…é¡»åœ¨æ‰€æœ‰çš„è·å–å‚æ•°åŠ¨ä½œä¹‹å‰</span><br></pre></td></tr></table></figure>

<h2 id="3ã€Servletçš„ç»§æ‰¿å…³ç³»åŠæ ¸å¿ƒæ–¹æ³•"><a href="#3ã€Servletçš„ç»§æ‰¿å…³ç³»åŠæ ¸å¿ƒæ–¹æ³•" class="headerlink" title="3ã€Servletçš„ç»§æ‰¿å…³ç³»åŠæ ¸å¿ƒæ–¹æ³•"></a>3ã€Servletçš„ç»§æ‰¿å…³ç³»åŠæ ¸å¿ƒæ–¹æ³•</h2><h3 id="1-Servletçš„ç»§æ‰¿å…³ç³»"><a href="#1-Servletçš„ç»§æ‰¿å…³ç³»" class="headerlink" title="1.Servletçš„ç»§æ‰¿å…³ç³»"></a>1.Servletçš„ç»§æ‰¿å…³ç³»</h3><p>é‡ç‚¹æŸ¥çœ‹çš„æ˜¯æœåŠ¡æ–¹æ³•ï¼ˆservice()ï¼‰</p>
<ol>
<li><p>ç»§æ‰¿å…³ç³»<br> javax.servlet.Servletæ¥å£<br>   javax.servlet.GenericServletæŠ½è±¡ç±»<br>   javax.servlet.http.HttpServletæŠ½è±¡å­ç±»</p>
</li>
<li><p>ç›¸å…³æ–¹æ³•<br> javax.servlet.Servletæ¥å£:<br> void init(config) - åˆå§‹åŒ–æ–¹æ³•<br> void service(request,response) - æœåŠ¡æ–¹æ³•<br> void destory() - é”€æ¯æ–¹æ³•</p>
</li>
</ol>
<p>  javax.servlet.GenericServletæŠ½è±¡ç±»ï¼š<br>    void service(request,response) - ä»ç„¶æ˜¯æŠ½è±¡çš„</p>
<p>  javax.servlet.http.HttpServlet æŠ½è±¡å­ç±»ï¼š<br>    void service(request,response) - ä¸æ˜¯æŠ½è±¡çš„</p>
<h3 id="2-service-æ–¹æ³•"><a href="#2-service-æ–¹æ³•" class="headerlink" title="2.service( )æ–¹æ³•"></a>2.service( )æ–¹æ³•</h3><ol>
<li><p>String method &#x3D; req.getMethod(); è·å–è¯·æ±‚çš„æ–¹å¼</p>
<ol>
<li>å„ç§ifåˆ¤æ–­ï¼Œæ ¹æ®è¯·æ±‚æ–¹å¼ä¸åŒï¼Œå†³å®šå»è°ƒç”¨ä¸åŒçš„doæ–¹æ³•    <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line">        <span class="keyword">if</span> (method.equals(<span class="string">&quot;GET&quot;</span>)) &#123;</span><br><span class="line">         <span class="built_in">this</span>.doGet(req,resp);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (method.equals(<span class="string">&quot;HEAD&quot;</span>)) &#123;</span><br><span class="line">         <span class="built_in">this</span>.doHead(req, resp);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (method.equals(<span class="string">&quot;POST&quot;</span>)) &#123;</span><br><span class="line">         <span class="built_in">this</span>.doPost(req, resp);</span><br><span class="line">         &#125; <span class="keyword">else</span> <span class="keyword">if</span> (method.equals(<span class="string">&quot;PUT&quot;</span>)) &#123;</span><br><span class="line">         <span class="built_in">this</span>.doPut(req, resp); </span><br><span class="line">        &#125;  </span><br><span class="line"></span><br><span class="line">â€‹    åœ¨HttpServletè¿™ä¸ªæŠ½è±¡ç±»ä¸­ï¼Œ<span class="keyword">do</span>æ–¹æ³•éƒ½å·®ä¸å¤š:</span><br><span class="line">â€‹    ```java</span><br><span class="line">â€‹    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line"><span class="type">String</span> <span class="variable">protocol</span> <span class="operator">=</span> req.getProtocol();</span><br><span class="line">â€‹    <span class="type">String</span> <span class="variable">msg</span> <span class="operator">=</span> lStrings.getString(<span class="string">&quot;http.method_get_not_supported&quot;</span>);</span><br><span class="line">â€‹    <span class="keyword">if</span> (protocol.endsWith(<span class="string">&quot;1.1&quot;</span>)) &#123;</span><br><span class="line">â€‹     resp.sendError(<span class="number">405</span>, msg);</span><br><span class="line">â€‹    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">â€‹     resp.sendError(<span class="number">400</span>, msg);</span><br><span class="line">â€‹    &#125;</span><br><span class="line">â€‹     &#125;</span><br><span class="line">â€‹    ```</span><br><span class="line"></span><br><span class="line">&gt;  HttpServletä¸­è¿™äº›<span class="keyword">do</span>æ–¹æ³•é»˜è®¤éƒ½æ˜¯<span class="number">405</span>çš„å®ç°é£æ ¼-è¦æˆ‘ä»¬å­ç±»å»å®ç°å¯¹åº”çš„æ–¹æ³•ï¼Œå¦åˆ™é»˜è®¤ä¼šæŠ¥<span class="number">405</span>é”™è¯¯</span><br><span class="line"></span><br><span class="line">### <span class="number">3.</span>å°ç»“</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>) ç»§æ‰¿å…³ç³»ï¼š HttpServlet -&gt; GenericServlet -&gt; Servlet</span><br><span class="line"><span class="number">2</span>) Servletä¸­çš„æ ¸å¿ƒæ–¹æ³•ï¼š init() , service() , destroy()</span><br><span class="line"><span class="number">3</span>) æœåŠ¡æ–¹æ³•ï¼š å½“æœ‰è¯·æ±‚è¿‡æ¥æ—¶ï¼Œserviceæ–¹æ³•ä¼šè‡ªåŠ¨å“åº”ï¼ˆå…¶å®æ˜¯tomcatå®¹å™¨è°ƒç”¨çš„ï¼‰</span><br><span class="line">        åœ¨HttpServletä¸­æˆ‘ä»¬ä¼šå»åˆ†æè¯·æ±‚çš„æ–¹å¼ï¼šåˆ°åº•æ˜¯getã€postã€headè¿˜æ˜¯deleteç­‰ç­‰</span><br><span class="line">        ç„¶åå†å†³å®šè°ƒç”¨çš„æ˜¯å“ªä¸ª<span class="keyword">do</span>å¼€å¤´çš„æ–¹æ³•</span><br><span class="line">        é‚£ä¹ˆåœ¨HttpServletä¸­è¿™äº›<span class="keyword">do</span>æ–¹æ³•é»˜è®¤éƒ½æ˜¯<span class="number">405</span>çš„å®ç°é£æ ¼-è¦æˆ‘ä»¬å­ç±»å»å®ç°å¯¹åº”çš„æ–¹æ³•ï¼Œå¦åˆ™é»˜è®¤ä¼šæŠ¥<span class="number">405</span>é”™è¯¯</span><br><span class="line"><span class="number">4</span>) å› æ­¤ï¼Œæˆ‘ä»¬åœ¨æ–°å»ºServletæ—¶ï¼Œæˆ‘ä»¬æ‰ä¼šå»è€ƒè™‘è¯·æ±‚æ–¹æ³•ï¼Œä»è€Œå†³å®šé‡å†™å“ªä¸ª<span class="keyword">do</span>æ–¹æ³•</span><br><span class="line"></span><br><span class="line">## <span class="number">4</span>ã€Servletçš„ç”Ÿå‘½å‘¨æœŸ</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>ï¼‰ ç”Ÿå‘½å‘¨æœŸï¼šä»å‡ºç”Ÿåˆ°æ­»äº¡çš„è¿‡ç¨‹å°±æ˜¯ç”Ÿå‘½å‘¨æœŸã€‚å¯¹åº”Servletä¸­çš„ä¸‰ä¸ªæ–¹æ³•ï¼šinit(),service(),destroy()</span><br><span class="line"><span class="number">2</span>ï¼‰ é»˜è®¤æƒ…å†µä¸‹ï¼š</span><br><span class="line">    ç¬¬ä¸€æ¬¡æ¥æ”¶è¯·æ±‚æ—¶ï¼Œè¿™ä¸ªServletä¼šè¿›è¡Œå®ä¾‹åŒ–(è°ƒç”¨æ„é€ æ–¹æ³•)ã€åˆå§‹åŒ–(è°ƒç”¨init())ã€ç„¶åæœåŠ¡(è°ƒç”¨service())</span><br><span class="line">    ä»ç¬¬äºŒæ¬¡è¯·æ±‚å¼€å§‹ï¼Œæ¯ä¸€æ¬¡éƒ½æ˜¯æœåŠ¡</span><br><span class="line">    å½“å®¹å™¨å…³é—­æ—¶ï¼Œå…¶ä¸­çš„æ‰€æœ‰çš„servletå®ä¾‹ä¼šè¢«é”€æ¯ï¼Œè°ƒç”¨é”€æ¯æ–¹æ³•</span><br><span class="line"><span class="number">3</span>ï¼‰ é€šè¿‡æ¡ˆä¾‹æˆ‘ä»¬å‘ç°ï¼š</span><br><span class="line"></span><br><span class="line">- **Servletå®ä¾‹tomcatåªä¼šåˆ›å»ºä¸€ä¸ªï¼Œæ‰€æœ‰çš„è¯·æ±‚éƒ½æ˜¯è¿™ä¸ªå®ä¾‹å»å“åº”ã€‚**</span><br><span class="line">    - é»˜è®¤æƒ…å†µä¸‹ï¼Œç¬¬ä¸€æ¬¡è¯·æ±‚æ—¶ï¼Œtomcatæ‰ä¼šå»å®ä¾‹åŒ–ï¼Œåˆå§‹åŒ–ï¼Œç„¶åå†æœåŠ¡</span><br><span class="line">      * è¿™æ ·çš„å¥½å¤„æ˜¯ä»€ä¹ˆï¼Ÿ æé«˜ç³»ç»Ÿçš„å¯åŠ¨é€Ÿåº¦  </span><br><span class="line">      * è¿™æ ·çš„ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ ç¬¬ä¸€æ¬¡è¯·æ±‚æ—¶ï¼Œè€—æ—¶è¾ƒé•¿ã€‚</span><br><span class="line">    - å› æ­¤å¾—å‡ºç»“è®ºï¼šå¦‚æœéœ€è¦æé«˜å“åº”é€Ÿåº¦ï¼Œæˆ‘ä»¬åº”è¯¥è®¾ç½®Servletçš„åˆå§‹åŒ–æ—¶æœºã€‚</span><br><span class="line"></span><br><span class="line"><span class="number">4</span>ï¼‰ Servletçš„åˆå§‹åŒ–æ—¶æœºï¼š</span><br><span class="line"></span><br><span class="line">- é»˜è®¤æ˜¯ç¬¬ä¸€æ¬¡æ¥æ”¶è¯·æ±‚æ—¶ï¼Œå®ä¾‹åŒ–ï¼Œåˆå§‹åŒ–</span><br><span class="line">- æˆ‘ä»¬å¯ä»¥é€šè¿‡&lt;load-on-startup&gt;æ¥è®¾ç½®servletå¯åŠ¨çš„å…ˆåé¡ºåº,æ•°å­—è¶Šå°ï¼Œå¯åŠ¨è¶Šé å‰ï¼Œæœ€å°å€¼<span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="number">5</span>ï¼‰ Servletåœ¨å®¹å™¨ä¸­æ˜¯ï¼šå•ä¾‹çš„ã€çº¿ç¨‹ä¸å®‰å…¨çš„</span><br><span class="line"></span><br><span class="line">- å•ä¾‹ï¼šæ‰€æœ‰çš„è¯·æ±‚éƒ½æ˜¯åŒä¸€ä¸ªå®ä¾‹å»å“åº”</span><br><span class="line"></span><br><span class="line">- çº¿ç¨‹ä¸å®‰å…¨ï¼šä¸€ä¸ªçº¿ç¨‹éœ€è¦æ ¹æ®è¿™ä¸ªå®ä¾‹ä¸­çš„æŸä¸ªæˆå‘˜å˜é‡å€¼å»åšé€»è¾‘åˆ¤æ–­ã€‚ä½†æ˜¯åœ¨ä¸­é—´æŸä¸ªæ—¶æœºï¼Œå¦ä¸€ä¸ªçº¿ç¨‹æ”¹å˜äº†è¿™ä¸ªæˆå‘˜å˜é‡çš„å€¼ï¼Œä»è€Œå¯¼è‡´ç¬¬ä¸€ä¸ªçº¿ç¨‹çš„æ‰§è¡Œè·¯å¾„å‘ç”Ÿäº†å˜åŒ–</span><br><span class="line"></span><br><span class="line">- æˆ‘ä»¬å·²ç»çŸ¥é“äº†servletæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„</span><br><span class="line"></span><br><span class="line">  * ç»™æˆ‘ä»¬çš„å¯å‘æ˜¯ï¼š å°½é‡çš„ä¸è¦åœ¨servletä¸­å®šä¹‰æˆå‘˜å˜é‡ã€‚</span><br><span class="line"></span><br><span class="line">  * å¦‚æœä¸å¾—ä¸å®šä¹‰æˆå‘˜å˜é‡ï¼Œé‚£ä¹ˆä¸è¦å»ï¼š</span><br><span class="line"></span><br><span class="line">    â‘ ä¸è¦å»ä¿®æ”¹æˆå‘˜å˜é‡çš„å€¼</span><br><span class="line"></span><br><span class="line">    â‘¡ä¸è¦å»æ ¹æ®æˆå‘˜å˜é‡çš„å€¼åšä¸€äº›é€»è¾‘åˆ¤æ–­</span><br><span class="line"></span><br><span class="line">çº¿ç¨‹ä¸å®‰å…¨å›¾ç¤ºï¼š</span><br><span class="line"></span><br><span class="line">![image-<span class="number">20220701202330023</span>](JavaWeb/image-<span class="number">20220701202330023.</span>png)</span><br><span class="line"></span><br><span class="line">## <span class="number">5</span>ã€Httpåè®®</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>ï¼‰ Http ç§°ä¹‹ä¸º è¶…æ–‡æœ¬ä¼ è¾“åè®®</span><br><span class="line"><span class="number">2</span>ï¼‰ Httpæ˜¯æ— çŠ¶æ€çš„</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>ï¼‰ Httpè¯·æ±‚å“åº”åŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼šè¯·æ±‚å’Œå“åº”</span><br><span class="line"></span><br><span class="line">  - è¯·æ±‚ï¼š</span><br><span class="line">    è¯·æ±‚åŒ…å«ä¸‰ä¸ªéƒ¨åˆ†ï¼š</span><br><span class="line">    * <span class="number">1.</span>è¯·æ±‚è¡Œ ï¼› </span><br><span class="line">    * <span class="number">2.</span>è¯·æ±‚æ¶ˆæ¯å¤´ </span><br><span class="line">    * <span class="number">3.</span>è¯·æ±‚ä¸»ä½“</span><br><span class="line"></span><br><span class="line">  - <span class="number">1</span>)è¯·æ±‚è¡ŒåŒ…å«æ˜¯ä¸‰ä¸ªä¿¡æ¯ï¼š</span><br><span class="line">    * <span class="number">1.</span>è¯·æ±‚çš„æ–¹å¼ ï¼› </span><br><span class="line">    * <span class="number">2.</span>è¯·æ±‚çš„URL ï¼› </span><br><span class="line">    * <span class="number">3.</span>è¯·æ±‚çš„åè®®ï¼ˆä¸€èˆ¬éƒ½æ˜¯HTTP1<span class="number">.1</span>ï¼‰</span><br><span class="line">  - <span class="number">2</span>)è¯·æ±‚æ¶ˆæ¯å¤´ä¸­åŒ…å«äº†å¾ˆå¤šå®¢æˆ·ç«¯éœ€è¦å‘Šè¯‰æœåŠ¡å™¨çš„ä¿¡æ¯ï¼Œæ¯”å¦‚ï¼šæˆ‘çš„æµè§ˆå™¨å‹å·ã€ç‰ˆæœ¬ã€æˆ‘èƒ½æ¥æ”¶çš„å†…å®¹çš„ç±»å‹ã€æˆ‘ç»™ä½ å‘çš„å†…å®¹çš„ç±»å‹ã€å†…å®¹çš„é•¿åº¦ç­‰ç­‰</span><br><span class="line">  - <span class="number">3</span>)è¯·æ±‚ä½“ï¼Œä¸‰ç§æƒ…å†µ</span><br><span class="line">    * getæ–¹å¼ï¼Œæ²¡æœ‰è¯·æ±‚ä½“ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªqueryString</span><br><span class="line">    * postæ–¹å¼ï¼Œæœ‰è¯·æ±‚ä½“ï¼Œform data</span><br><span class="line">    * jsonæ ¼å¼ï¼Œæœ‰è¯·æ±‚ä½“ï¼Œrequest payload</span><br><span class="line">  - å“åº”ï¼š</span><br><span class="line">    å“åº”ä¹ŸåŒ…å«ä¸‰ç§ï¼š <span class="number">1.</span> å“åº”è¡Œ ï¼› <span class="number">2.</span>å“åº”å¤´ ï¼› <span class="number">3.</span>å“åº”ä½“</span><br><span class="line">    * <span class="number">1</span>)å“åº”è¡ŒåŒ…å«ä¸‰ä¸ªä¿¡æ¯ï¼š</span><br><span class="line">      * <span class="number">1.</span>åè®® </span><br><span class="line">      * <span class="number">2.</span>å“åº”çŠ¶æ€ç (<span class="number">200</span>) </span><br><span class="line">      * <span class="number">3.</span>å“åº”çŠ¶æ€(ok)</span><br><span class="line">    * <span class="number">2</span>)å“åº”å¤´ï¼šåŒ…å«äº†æœåŠ¡å™¨çš„ä¿¡æ¯ï¼›æœåŠ¡å™¨å‘é€ç»™æµè§ˆå™¨çš„ä¿¡æ¯ï¼ˆå†…å®¹çš„åª’ä½“ç±»å‹ã€ç¼–ç ã€å†…å®¹é•¿åº¦ç­‰ï¼‰</span><br><span class="line">    * <span class="number">3</span>)å“åº”ä½“ï¼šå“åº”çš„å®é™…å†…å®¹ï¼ˆæ¯”å¦‚è¯·æ±‚add.htmlé¡µé¢æ—¶ï¼Œå“åº”çš„å†…å®¹å°±æ˜¯&lt;html&gt;&lt;head&gt;&lt;body&gt;&lt;form....ï¼‰</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## <span class="number">6</span>ã€ä¼šè¯</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>ï¼‰ Httpæ˜¯æ— çŠ¶æ€çš„</span><br><span class="line">    - HTTP æ— çŠ¶æ€ ï¼šæœåŠ¡å™¨æ— æ³•åˆ¤æ–­è¿™ä¸¤æ¬¡è¯·æ±‚æ˜¯åŒä¸€ä¸ªå®¢æˆ·ç«¯å‘è¿‡æ¥çš„ï¼Œè¿˜æ˜¯ä¸åŒçš„å®¢æˆ·ç«¯å‘è¿‡æ¥çš„</span><br><span class="line">        - æ— çŠ¶æ€å¸¦æ¥çš„ç°å®é—®é¢˜ï¼šç¬¬ä¸€æ¬¡è¯·æ±‚æ˜¯æ·»åŠ å•†å“åˆ°è´­ç‰©è½¦ï¼Œç¬¬äºŒæ¬¡è¯·æ±‚æ˜¯ç»“è´¦ï¼›å¦‚æœè¿™ä¸¤æ¬¡è¯·æ±‚æœåŠ¡å™¨æ— æ³•åŒºåˆ†æ˜¯åŒä¸€ä¸ªç”¨æˆ·çš„ï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´æ··ä¹±</span><br><span class="line">        - é€šè¿‡ä¼šè¯è·Ÿè¸ªæŠ€æœ¯æ¥è§£å†³æ— çŠ¶æ€çš„é—®é¢˜ã€‚</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>ï¼‰ ä¼šè¯è·Ÿè¸ªæŠ€æœ¯</span><br><span class="line"></span><br><span class="line">    - å®¢æˆ·ç«¯ç¬¬ä¸€æ¬¡å‘è¯·æ±‚ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨è·å–sessionï¼Œè·å–ä¸åˆ°ï¼Œåˆ™åˆ›å»ºæ–°çš„ï¼Œç„¶åå“åº”ç»™å®¢æˆ·ç«¯</span><br><span class="line">        - ä¸‹æ¬¡å®¢æˆ·ç«¯ç»™æœåŠ¡å™¨å‘è¯·æ±‚æ—¶ï¼Œä¼šæŠŠsessionIDå¸¦ç»™æœåŠ¡å™¨ï¼Œé‚£ä¹ˆæœåŠ¡å™¨å°±èƒ½è·å–åˆ°äº†ï¼Œé‚£ä¹ˆæœåŠ¡å™¨å°±åˆ¤æ–­è¿™ä¸€æ¬¡è¯·æ±‚å’Œä¸Šæ¬¡æŸæ¬¡è¯·æ±‚æ˜¯åŒä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œä»è€Œèƒ½å¤ŸåŒºåˆ†å¼€å®¢æˆ·ç«¯</span><br><span class="line">        - å¸¸ç”¨çš„APIï¼š</span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line">request.getSession() -&gt; è·å–å½“å‰çš„ä¼šè¯ï¼Œæ²¡æœ‰åˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„ä¼šè¯</span><br><span class="line">request.getSession(<span class="literal">true</span>) -&gt; æ•ˆæœå’Œä¸å¸¦å‚æ•°ç›¸åŒ</span><br><span class="line">request.getSession(<span class="literal">false</span>) -&gt; è·å–å½“å‰ä¼šè¯ï¼Œæ²¡æœ‰åˆ™è¿”å›<span class="literal">null</span>ï¼Œä¸ä¼šåˆ›å»ºæ–°çš„</span><br><span class="line">session.getId() -&gt; è·å–sessionID</span><br><span class="line">session.isNew() -&gt; åˆ¤æ–­å½“å‰sessionæ˜¯å¦æ˜¯æ–°çš„</span><br><span class="line">session.getMaxInactiveInterval() -&gt; sessionçš„éæ¿€æ´»é—´éš”æ—¶é•¿ï¼Œé»˜è®¤<span class="number">1800</span>ç§’</span><br><span class="line">session.setMaxInactiveInterval()</span><br><span class="line">session.invalidate() -&gt; å¼ºåˆ¶æ€§è®©ä¼šè¯ç«‹å³å¤±æ•ˆ</span><br><span class="line">  ....</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>
<p>ä¼šè¯å›¾ç¤ºï¼š</p>
<p><img src="/2022/09/30/JavaWeb/image-20220701202434538.png" alt="image-20220701202434538"></p>
<p>3ï¼‰ sessionä¿å­˜ä½œç”¨åŸŸ</p>
<ul>
<li>sessionä¿å­˜ä½œç”¨åŸŸæ˜¯å’Œå…·ä½“çš„æŸä¸€ä¸ªsessionå¯¹åº”çš„ï¼Œè®¾ç½®ä»–çš„ä¸“å±å±æ€§</li>
<li>å¸¸ç”¨çš„APIï¼š<br>void session.setAttribute(k,v)<br>Object session.getAttribute(k)<br>void removeAttribute(k)</li>
</ul>
<h2 id="7ã€æœåŠ¡å™¨å†…éƒ¨è½¬å‘ä»¥åŠå®¢æˆ·ç«¯é‡å®šå‘"><a href="#7ã€æœåŠ¡å™¨å†…éƒ¨è½¬å‘ä»¥åŠå®¢æˆ·ç«¯é‡å®šå‘" class="headerlink" title="7ã€æœåŠ¡å™¨å†…éƒ¨è½¬å‘ä»¥åŠå®¢æˆ·ç«¯é‡å®šå‘"></a>7ã€æœåŠ¡å™¨å†…éƒ¨è½¬å‘ä»¥åŠå®¢æˆ·ç«¯é‡å®šå‘</h2><p>1ï¼‰ æœåŠ¡å™¨å†…éƒ¨è½¬å‘ : request.getRequestDispatcher(â€œâ€¦â€).forward(request,response);</p>
<ul>
<li>ä¸€æ¬¡è¯·æ±‚å“åº”çš„è¿‡ç¨‹ï¼Œå¯¹äºå®¢æˆ·ç«¯è€Œè¨€ï¼Œå†…éƒ¨ç»è¿‡äº†å¤šå°‘æ¬¡è½¬å‘ï¼Œå®¢æˆ·ç«¯æ˜¯ä¸çŸ¥é“çš„</li>
<li>åœ°å€æ è®¿é—®åœ°å€æ²¡æœ‰å˜åŒ–</li>
</ul>
<p>å›¾ç¤ºï¼š</p>
<p><img src="/2022/09/30/JavaWeb/image-20220701204547620.png" alt="image-20220701204547620"></p>
<p>2ï¼‰å®¢æˆ·ç«¯é‡å®šå‘ï¼š response.sendRedirect(â€œâ€¦.â€);</p>
<ul>
<li>ä¸¤æ¬¡è¯·æ±‚å“åº”çš„è¿‡ç¨‹ã€‚å®¢æˆ·ç«¯è‚¯å®šçŸ¥é“è¯·æ±‚URLæœ‰å˜åŒ–</li>
<li>åœ°å€æ è®¿é—®åœ°å€æœ‰å˜åŒ–</li>
</ul>
<p>å›¾ç¤ºï¼š</p>
<p><img src="/2022/09/30/JavaWeb/image-20220701204618860.png" alt="image-20220701204618860"></p>
<h2 id="8ã€Thymeleaf-è§†å›¾æ¨¡æ¿æŠ€æœ¯"><a href="#8ã€Thymeleaf-è§†å›¾æ¨¡æ¿æŠ€æœ¯" class="headerlink" title="8ã€Thymeleaf - è§†å›¾æ¨¡æ¿æŠ€æœ¯"></a>8ã€Thymeleaf - è§†å›¾æ¨¡æ¿æŠ€æœ¯</h2><p>è¿‡ç¨‹å›¾ç¤ºï¼š</p>
<p><img src="/2022/09/30/JavaWeb/image-20220702132830048.png" alt="image-20220702132830048"></p>
<p>Thymeleafä¸­æä¾›processTemplate( )æ–¹æ³•å°†æ•°æ®æ¸²æŸ“åˆ°htmlé¡µé¢</p>
<ol>
<li>æ·»åŠ thymeleafçš„jaråŒ…</li>
</ol>
<p><img src="/2022/09/30/JavaWeb/image-20220702130459879.png" alt="image-20220702130459879"></p>
<ol start="2">
<li><p>åœ¨web.xmlæ–‡ä»¶ä¸­æ·»åŠ é…ç½®</p>
<ul>
<li>é…ç½®å‰ç¼€ view-prefix</li>
<li>é…ç½®åç¼€ view-suffix</li>
</ul>
</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- é…ç½®ä¸Šä¸‹æ–‡å‚æ•° --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>view-prefix<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>/<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>view-suffix<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>.html<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li><p>æ–°å»ºä¸€ä¸ªServletç±»ViewBaseServletï¼Œæœ¬è´¨ä¸Šæ˜¯æ­å»ºThymeleafæ‰€éœ€çš„ç¯å¢ƒ</p>
<p>ViewBaseServletç»§æ‰¿æ˜¯HttpServlet</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ViewBaseServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> TemplateEngine templateEngine;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">        <span class="comment">// 1.è·å–ServletContextå¯¹è±¡</span></span><br><span class="line">        <span class="type">ServletContext</span> <span class="variable">servletContext</span> <span class="operator">=</span> <span class="built_in">this</span>.getServletContext();</span><br><span class="line">        <span class="comment">// 2.åˆ›å»ºThymeleafè§£æå™¨å¯¹è±¡</span></span><br><span class="line">        <span class="type">ServletContextTemplateResolver</span> <span class="variable">templateResolver</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServletContextTemplateResolver</span>(servletContext);</span><br><span class="line">        <span class="comment">// 3.ç»™è§£æå™¨å¯¹è±¡è®¾ç½®å‚æ•°</span></span><br><span class="line">        <span class="comment">// â‘ HTMLæ˜¯é»˜è®¤æ¨¡å¼ï¼Œæ˜ç¡®è®¾ç½®æ˜¯ä¸ºäº†ä»£ç æ›´å®¹æ˜“ç†è§£</span></span><br><span class="line">        templateResolver.setTemplateMode(TemplateMode.HTML);</span><br><span class="line">        <span class="comment">// â‘¡è®¾ç½®å‰ç¼€</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">viewPrefix</span> <span class="operator">=</span> servletContext.getInitParameter(<span class="string">&quot;view-prefix&quot;</span>);</span><br><span class="line">        templateResolver.setPrefix(viewPrefix);</span><br><span class="line">        <span class="comment">// â‘¢è®¾ç½®åç¼€</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">viewSuffix</span> <span class="operator">=</span> servletContext.getInitParameter(<span class="string">&quot;view-suffix&quot;</span>);</span><br><span class="line">        templateResolver.setSuffix(viewSuffix);</span><br><span class="line">        <span class="comment">// â‘£è®¾ç½®ç¼“å­˜è¿‡æœŸæ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</span></span><br><span class="line">        templateResolver.setCacheTTLMs(<span class="number">60000L</span>);</span><br><span class="line">        <span class="comment">// â‘¤è®¾ç½®æ˜¯å¦ç¼“å­˜</span></span><br><span class="line">        templateResolver.setCacheable(<span class="literal">true</span>);</span><br><span class="line">        <span class="comment">// â‘¥è®¾ç½®æœåŠ¡å™¨ç«¯ç¼–ç æ–¹å¼</span></span><br><span class="line">        templateResolver.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">        <span class="comment">// 4.åˆ›å»ºæ¨¡æ¿å¼•æ“å¯¹è±¡</span></span><br><span class="line">        templateEngine = <span class="keyword">new</span> <span class="title class_">TemplateEngine</span>();</span><br><span class="line">        <span class="comment">// 5.ç»™æ¨¡æ¿å¼•æ“å¯¹è±¡è®¾ç½®æ¨¡æ¿è§£æå™¨</span></span><br><span class="line">        templateEngine.setTemplateResolver(templateResolver);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">processTemplate</span><span class="params">(String templateName, HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">// 1.è®¾ç½®å“åº”ä½“å†…å®¹ç±»å‹å’Œå­—ç¬¦é›†</span></span><br><span class="line">        resp.setContentType(<span class="string">&quot;text/html;charset=UTF-8&quot;</span>);</span><br><span class="line">        <span class="comment">// 2.åˆ›å»ºWebContextå¯¹è±¡</span></span><br><span class="line">        <span class="type">WebContext</span> <span class="variable">webContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">WebContext</span>(req, resp, getServletContext());</span><br><span class="line">        <span class="comment">// 3.å¤„ç†æ¨¡æ¿æ•°æ®</span></span><br><span class="line">        templateEngine.process(templateName, webContext, resp.getWriter());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä½¿å¾—æˆ‘ä»¬çš„Servletç»§æ‰¿ViewBaseServlet</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Servletä»3.0ç‰ˆæœ¬å¼€å§‹æ”¯æŒæ³¨è§£æ–¹å¼çš„æ³¨å†Œï¼Œæ— éœ€åœ¨xmlæ–‡ä»¶ä¸­é…ç½®indexä¸IndexServletå¯¹åº”ä¿¡æ¯</span></span><br><span class="line"><span class="meta">@WebServlet(&quot;/index&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">IndexServlet</span> <span class="keyword">extends</span> <span class="title class_">ViewBaseServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request , HttpServletResponse response)</span><span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        <span class="type">FruitDAO</span> <span class="variable">fruitDAO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FruitDAOImpl</span>();</span><br><span class="line">        List&lt;Fruit&gt; fruitList = fruitDAO.getFruitList();</span><br><span class="line">        <span class="comment">//ä¿å­˜åˆ°sessionä½œç”¨åŸŸ</span></span><br><span class="line">        <span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> request.getSession() ;</span><br><span class="line">        session.setAttribute(<span class="string">&quot;fruitList&quot;</span>,fruitList);</span><br><span class="line">        <span class="comment">//æ­¤å¤„çš„è§†å›¾åç§°æ˜¯ index</span></span><br><span class="line">        <span class="comment">//é‚£ä¹ˆthymeleafä¼šå°†è¿™ä¸ª é€»è¾‘è§†å›¾åç§° å¯¹åº”åˆ° ç‰©ç†è§†å›¾ åç§°ä¸Šå»</span></span><br><span class="line">        <span class="comment">//é€»è¾‘è§†å›¾åç§° ï¼š   index</span></span><br><span class="line">        <span class="comment">//ç‰©ç†è§†å›¾åç§° ï¼š   view-prefix + é€»è¾‘è§†å›¾åç§° + view-suffix</span></span><br><span class="line">        <span class="comment">//æ‰€ä»¥çœŸå®çš„è§†å›¾åç§°æ˜¯ï¼š      /       index       .html</span></span><br><span class="line">        <span class="built_in">super</span>.processTemplate(<span class="string">&quot;index&quot;</span>,request,response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><blockquote>
<p>æ ¹æ®é€»è¾‘è§†å›¾åç§° å¾—åˆ° ç‰©ç†è§†å›¾åç§°<br>æ­¤å¤„çš„è§†å›¾åç§°æ˜¯ index<br>é‚£ä¹ˆthymeleafä¼šå°†è¿™ä¸ª é€»è¾‘è§†å›¾åç§° å¯¹åº”åˆ° ç‰©ç†è§†å›¾ åç§°ä¸Šå»<br>é€»è¾‘è§†å›¾åç§° ï¼š   index<br>ç‰©ç†è§†å›¾åç§° ï¼š   view-prefix + é€»è¾‘è§†å›¾åç§° + view-suffix<br>æ‰€ä»¥çœŸå®çš„è§†å›¾åç§°æ˜¯ï¼š      &#x2F;       index       .html<br>super.processTemplate(â€œindexâ€,request,response);</p>
</blockquote>
</li>
<li><p>ä½¿ç”¨thymeleafçš„æ ‡ç­¾<br>  th:if   ,  th:unless   , th:each   ,   th:text</p>
</li>
<li><p>index.htmlæ°´æœåº“å­˜é¡µé¢</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;css/index.css&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;div_container&quot;</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;div_fruit_list&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;center f30&quot;</span>&gt;</span>æ¬¢è¿ä½¿ç”¨æ°´æœåº“å­˜åå°ç®¡ç†ç³»ç»Ÿ<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">table</span> <span class="attr">id</span>=<span class="string">&quot;tbl_fruit&quot;</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">th</span> <span class="attr">class</span>=<span class="string">&quot;w20&quot;</span>&gt;</span>åç§°<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">th</span> <span class="attr">class</span>=<span class="string">&quot;w20&quot;</span>&gt;</span>å•ä»·<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">th</span> <span class="attr">class</span>=<span class="string">&quot;w20&quot;</span>&gt;</span>åº“å­˜<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">th</span>&gt;</span>æ“ä½œ<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">tr</span> <span class="attr">th:if</span>=<span class="string">&quot;$&#123;#lists.isEmpty(session.fruitList)&#125;&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">td</span> <span class="attr">colspan</span>=<span class="string">&quot;4&quot;</span>&gt;</span>å¯¹ä¸èµ·ï¼Œåº“å­˜ä¸ºç©ºï¼<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">tr</span> <span class="attr">th:unless</span>=<span class="string">&quot;$&#123;#lists.isEmpty(session.fruitList)&#125;&quot;</span> <span class="attr">th:each</span>=<span class="string">&quot;fruit : $&#123;session.fruitList&#125;&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;fruit.fname&#125;&quot;</span>&gt;</span>è‹¹æœ<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;fruit.price&#125;&quot;</span>&gt;</span>5<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;fruit.fcount&#125;&quot;</span>&gt;</span>20<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;imgs/del.jpg&quot;</span> <span class="attr">class</span>=<span class="string">&quot;delImg&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>æ“ä½œæ³¨æ„ï¼š</p>
</li>
</ol>
<img src="/2022/09/30/JavaWeb/image-20220702132012777.png" alt="image-20220702132012777" style="zoom:67%;">

<blockquote>
<p>URLï¼šé»˜è®¤åœ°å€indexåä¸åŠ  .html</p>
</blockquote>
<p>&#x2F;&#x2F; 200 : æ­£å¸¸å“åº”<br>&#x2F;&#x2F; 404 : æ‰¾ä¸åˆ°èµ„æº<br>&#x2F;&#x2F; 405 : è¯·æ±‚æ–¹å¼ä¸æ”¯æŒ<br>&#x2F;&#x2F; 500 : æœåŠ¡å™¨å†…éƒ¨é”™è¯¯</p>
<h2 id="9ã€ä¿å­˜ä½œç”¨åŸŸ"><a href="#9ã€ä¿å­˜ä½œç”¨åŸŸ" class="headerlink" title="9ã€ä¿å­˜ä½œç”¨åŸŸ"></a>9ã€ä¿å­˜ä½œç”¨åŸŸ</h2><p>åŸå§‹æƒ…å†µä¸‹ï¼Œä¿å­˜ä½œç”¨åŸŸæˆ‘ä»¬å¯ä»¥è®¤ä¸ºæœ‰å››ä¸ªï¼š </p>
<ul>
<li>pageï¼ˆé¡µé¢çº§åˆ«ï¼Œç°åœ¨å‡ ä¹ä¸ç”¨ï¼‰ </li>
<li>requestï¼ˆä¸€æ¬¡è¯·æ±‚å“åº”èŒƒå›´ï¼‰ </li>
<li>sessionï¼ˆä¸€æ¬¡ä¼šè¯èŒƒå›´ï¼‰ </li>
<li>applicationï¼ˆæ•´ä¸ªåº”ç”¨ç¨‹åºèŒƒå›´ï¼‰</li>
</ul>
<p> 1ï¼‰ requestï¼šä¸€æ¬¡è¯·æ±‚å“åº”èŒƒå›´</p>
<p><img src="/2022/09/30/JavaWeb/image-20220702140400146.png" alt="image-20220702140400146"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ¼”ç¤ºrequestä¿å­˜ä½œç”¨åŸŸï¼ˆdemo01å’Œdemo02ï¼‰</span></span><br><span class="line"><span class="meta">@WebServlet(&quot;/demo01&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo01Servlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">//1.å‘requestä¿å­˜ä½œç”¨åŸŸä¿å­˜æ•°æ®</span></span><br><span class="line">        request.setAttribute(<span class="string">&quot;uname&quot;</span>,<span class="string">&quot;lili&quot;</span>);</span><br><span class="line">        <span class="comment">//2.å®¢æˆ·ç«¯é‡å®šå‘</span></span><br><span class="line">        <span class="comment">//response.sendRedirect(&quot;demo02&quot;); ä¸å¯ä»¥</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.æœåŠ¡å™¨ç«¯è½¬å‘</span></span><br><span class="line">        request.getRequestDispatcher(<span class="string">&quot;demo02&quot;</span>).forward(request,response);  <span class="comment">//ç›¸å½“äºä¸€æ¬¡è¯·æ±‚</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/demo02&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo02Servlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">//1.è·å–requestä¿å­˜ä½œç”¨åŸŸä¿å­˜çš„æ•°æ®ï¼Œkeyä¸ºuname</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">unameObj</span> <span class="operator">=</span> request.getAttribute(<span class="string">&quot;uname&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;unameObj = &quot;</span> + unameObj);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p> 2ï¼‰ sessionï¼šä¸€æ¬¡ä¼šè¯èŒƒå›´æœ‰æ•ˆ</p>
<p><img src="/2022/09/30/JavaWeb/image-20220702140443309.png" alt="image-20220702140443309"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ¼”ç¤ºsessionä¿å­˜ä½œç”¨åŸŸï¼ˆdemo03å’Œdemo04ï¼‰</span></span><br><span class="line"><span class="meta">@WebServlet(&quot;/demo03&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo03Servlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">//1.å‘sessionä¿å­˜ä½œç”¨åŸŸä¿å­˜æ•°æ®</span></span><br><span class="line">        request.getSession().setAttribute(<span class="string">&quot;uname&quot;</span>,<span class="string">&quot;lili&quot;</span>);</span><br><span class="line">        <span class="comment">//2.å®¢æˆ·ç«¯é‡å®šå‘</span></span><br><span class="line">        response.sendRedirect(<span class="string">&quot;demo04&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.æœåŠ¡å™¨ç«¯è½¬å‘</span></span><br><span class="line">        <span class="comment">//request.getRequestDispatcher(&quot;demo04&quot;).forward(request,response);</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/demo04&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo04Servlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">//1.è·å–sessionä¿å­˜ä½œç”¨åŸŸä¿å­˜çš„æ•°æ®ï¼Œkeyä¸ºuname</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">unameObj</span> <span class="operator">=</span> request.getSession().getAttribute(<span class="string">&quot;uname&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;unameObj = &quot;</span> + unameObj);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 3ï¼‰ applicationï¼š ä¸€æ¬¡åº”ç”¨ç¨‹åºèŒƒå›´æœ‰æ•ˆ</p>
<p><img src="/2022/09/30/JavaWeb/image-20220702140505247.png" alt="image-20220702140505247"></p>
<h2 id="10ã€è·¯å¾„é—®é¢˜"><a href="#10ã€è·¯å¾„é—®é¢˜" class="headerlink" title="10ã€è·¯å¾„é—®é¢˜"></a>10ã€è·¯å¾„é—®é¢˜</h2><p><img src="/2022/09/30/JavaWeb/image-20220702184941299.png" alt="image-20220702184941299"></p>
<p>. .  è¡¨ç¤ºè¿”å›ä¸Šä¸€çº§</p>
<h1 id="æ°´æœç³»ç»Ÿé¡¹ç›®"><a href="#æ°´æœç³»ç»Ÿé¡¹ç›®" class="headerlink" title="æ°´æœç³»ç»Ÿé¡¹ç›®"></a>æ°´æœç³»ç»Ÿé¡¹ç›®</h1><h2 id="æ°´æœç³»ç»Ÿ"><a href="#æ°´æœç³»ç»Ÿ" class="headerlink" title="æ°´æœç³»ç»Ÿ"></a>æ°´æœç³»ç»Ÿ</h2><h3 id="1-å»ºç«‹æ•°æ®åº“å’Œè¡¨"><a href="#1-å»ºç«‹æ•°æ®åº“å’Œè¡¨" class="headerlink" title="1.å»ºç«‹æ•°æ®åº“å’Œè¡¨"></a>1.å»ºç«‹æ•°æ®åº“å’Œè¡¨</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t_fruit(</span><br><span class="line">	fid <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT <span class="keyword">PRIMARY</span> KEY,  #è‡ªå¢fidè¯­å¥</span><br><span class="line">	fname <span class="type">VARCHAR</span>(<span class="number">15</span>) <span class="keyword">NULL</span>,</span><br><span class="line">	price <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">	fcount <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">	remark <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NULL</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> t_fruit;  #åˆ é™¤è¡¨è¯­å¥</span><br></pre></td></tr></table></figure>



<h3 id="2-åˆ›å»ºJavaWbeé¡¹ç›®æ¨¡å—"><a href="#2-åˆ›å»ºJavaWbeé¡¹ç›®æ¨¡å—" class="headerlink" title="2.åˆ›å»ºJavaWbeé¡¹ç›®æ¨¡å—"></a>2.åˆ›å»ºJavaWbeé¡¹ç›®æ¨¡å—</h3><ul>
<li>åˆ›å»ºJavaWebæ¨¡å—</li>
<li>å°†MySQLé©±åŠ¨libä¾èµ–æ·»åŠ æ–°æ¨¡å—ä¸­</li>
<li>å°†thyemleaf jaråŒ…ä¾èµ–æ·»åŠ åˆ°æ–°æ¨¡å—ä¸­</li>
<li>å°†æ–°æ¨¡å—åŠ å…¥Tomcatä¸­ï¼Œå¹¶åŠ å…¥Tomcatä¾èµ–æ·»åŠ æ–°æ¨¡å—ä¸­</li>
<li>åœ¨web.xmlä¸­ï¼Œé…ç½®å‰ç¼€å’Œåç¼€ï¼Œç”¨äºthyemleafçš„é€»è¾‘åœ°å€è½¬æ¢ä¸ºç‰©ç†åœ°å€</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>view-prefix<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>/<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>view-suffix<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>.html<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="3ã€ä¸»ç´¢å¼•indexé¡µé¢"><a href="#3ã€ä¸»ç´¢å¼•indexé¡µé¢" class="headerlink" title="3ã€ä¸»ç´¢å¼•indexé¡µé¢"></a>3ã€ä¸»ç´¢å¼•indexé¡µé¢</h3><h4 id="éœ€æ±‚"><a href="#éœ€æ±‚" class="headerlink" title="éœ€æ±‚"></a>éœ€æ±‚</h4><ul>
<li>æŒ‰5æ¡åº“å­˜è®°å½•å±•ç¤ºåœ¨é¡µé¢ä¸­</li>
<li>æ·»åŠ åº“å­˜è®°å½•åŠŸèƒ½ï¼Œè·³è½¬è‡³add.html</li>
<li>é¦–é¡µã€ä¸Šä¸€é¡µã€ä¸‹ä¸€é¡µã€å°¾é¡µåŠŸèƒ½ï¼Œæ¯é¡µ5æ¡åº“å­˜è®°å½•</li>
</ul>
<h4 id="1ï¼‰ç¼–å†™index-htmlé¡µé¢"><a href="#1ï¼‰ç¼–å†™index-htmlé¡µé¢" class="headerlink" title="1ï¼‰ç¼–å†™index.htmlé¡µé¢"></a>1ï¼‰ç¼–å†™index.htmlé¡µé¢</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;css/index.css&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">script</span> <span class="attr">language</span>=<span class="string">&quot;JavaScript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;js/index.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;div_container&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;div_fruit_list&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;center f30&quot;</span>&gt;</span>æ¬¢è¿ä½¿ç”¨æ°´æœåº“å­˜åå°ç®¡ç†ç³»ç»Ÿ<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;border:0px solid red;width:60%;margin-left:20%;text-align:right;&quot;</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/add.html&#125;&quot;</span> <span class="attr">style</span>=<span class="string">&quot;border:0px solid blue;margin-bottom:4px;&quot;</span>&gt;</span>æ·»åŠ æ–°åº“å­˜è®°å½•<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">table</span> <span class="attr">id</span>=<span class="string">&quot;tbl_fruit&quot;</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span> <span class="attr">class</span>=<span class="string">&quot;w20&quot;</span>&gt;</span>åç§°1<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span> <span class="attr">class</span>=<span class="string">&quot;w20&quot;</span>&gt;</span>å•ä»·<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span> <span class="attr">class</span>=<span class="string">&quot;w20&quot;</span>&gt;</span>åº“å­˜<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>æ“ä½œ<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">tr</span> <span class="attr">th:if</span>=<span class="string">&quot;$&#123;#lists.isEmpty(session.fruitList)&#125;&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span> <span class="attr">colspan</span>=<span class="string">&quot;4&quot;</span>&gt;</span>å¯¹ä¸èµ·ï¼Œåº“å­˜ä¸ºç©ºï¼<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">tr</span> <span class="attr">th:unless</span>=<span class="string">&quot;$&#123;#lists.isEmpty(session.fruitList)&#125;&quot;</span> <span class="attr">th:each</span>=<span class="string">&quot;fruit : $&#123;session.fruitList&#125;&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- &lt;td&gt;&lt;a th:text=&quot;$&#123;fruit.fname&#125;&quot; th:href=&quot;@&#123;&#x27;/edit.do?fid=&#x27;+$&#123;fruit.fid&#125;&#125;&quot;&gt;è‹¹æœ&lt;/a&gt;&lt;/td&gt; --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;fruit.fname&#125;&quot;</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/edit.do(fid=$&#123;fruit.fid&#125;)&#125;&quot;</span>&gt;</span>è‹¹æœ<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;fruit.price&#125;&quot;</span>&gt;</span>5<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;fruit.fcount&#125;&quot;</span>&gt;</span>20<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- &lt;td&gt;&lt;img src=&quot;imgs/del.jpg&quot; class=&quot;delImg&quot; th:onclick=&quot;&#x27;delFruit(&#x27;+$&#123;fruit.fid&#125;+&#x27;)&#x27;&quot;/&gt;&lt;/td&gt; --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;imgs/del.jpg&quot;</span> <span class="attr">class</span>=<span class="string">&quot;delImg&quot;</span> <span class="attr">th:onclick</span>=<span class="string">&quot;|delFruit($&#123;fruit.fid&#125;)|&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;width:60%;margin-left:20%;border:0px solid red;padding-top:4px;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;center&quot;</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;é¦–  é¡µ1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn&quot;</span> <span class="attr">th:onclick</span>=<span class="string">&quot;|page(1)|&quot;</span> <span class="attr">th:disabled</span>=<span class="string">&quot;$&#123;session.pageNo==1&#125;&quot;</span>/&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;ä¸Šä¸€é¡µ&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn&quot;</span> <span class="attr">th:onclick</span>=<span class="string">&quot;|page($&#123;session.pageNo-1&#125;)|&quot;</span> <span class="attr">th:disabled</span>=<span class="string">&quot;$&#123;session.pageNo==1&#125;&quot;</span>/&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;ä¸‹ä¸€é¡µ&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn&quot;</span> <span class="attr">th:onclick</span>=<span class="string">&quot;|page($&#123;session.pageNo+1&#125;)|&quot;</span> <span class="attr">th:disabled</span>=<span class="string">&quot;$&#123;session.pageNo==session.pageCount&#125;&quot;</span>/&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;å°¾  é¡µ&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn&quot;</span> <span class="attr">th:onclick</span>=<span class="string">&quot;|page($&#123;session.pageCount&#125;)|&quot;</span> <span class="attr">th:disabled</span>=<span class="string">&quot;$&#123;session.pageNo==session.pageCount&#125;&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h4 id="2ï¼‰ç¼–å†™index-css"><a href="#2ï¼‰ç¼–å†™index-css" class="headerlink" title="2ï¼‰ç¼–å†™index.css"></a>2ï¼‰ç¼–å†™index.css</h4><p>ç•¥</p>
<h4 id="3ï¼‰ç¼–å†™index-js"><a href="#3ï¼‰ç¼–å†™index-js" class="headerlink" title="3ï¼‰ç¼–å†™index.js"></a>3ï¼‰ç¼–å†™index.js</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">delFruit</span>(<span class="params">fid</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_">confirm</span>(<span class="string">&#x27;æ˜¯å¦ç¡®è®¤åˆ é™¤ï¼Ÿ&#x27;</span>))&#123;</span><br><span class="line">        <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&#x27;del.do?fid=&#x27;</span>+fid; </span><br><span class="line">        <span class="comment">//å½“å‰çª—å£åœ°å€+åŠ ä¸Šdel.do?fid=fid ,å³ä¼ è¾“ä¸€ä¸ªå‚æ•°ç»™del.do</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">page</span>(<span class="params">pageNo</span>)&#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;index?pageNo=&quot;</span>+pageNo;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4ï¼‰ç¼–å†™indexServlet"><a href="#4ï¼‰ç¼–å†™indexServlet" class="headerlink" title="4ï¼‰ç¼–å†™indexServlet"></a>4ï¼‰ç¼–å†™indexServlet</h4><p>åœ¨FruitDAOæ¥å£ä¸­æ·»åŠ æ–¹æ³•ï¼Œåœ¨FruitDAOImplå®ç°ç±»ä¸­é‡å†™æ­¤æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> List&lt;Fruit&gt; <span class="title function_">getFruitList</span><span class="params">(Integer pageNo)</span> &#123; <span class="comment">//æŒ‰ä¸€é¡µ5æ¡æ•°æ®çš„è¿”å›</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">super</span>.executeQuery(<span class="string">&quot;select * from t_fruit limit ?, 5&quot;</span> ,(pageNo-<span class="number">1</span>)*<span class="number">5</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getFruitCount</span><span class="params">()</span> &#123;  <span class="comment">//æŸ¥è¯¢æ€»è®°å½•æ¡æ•°</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select count(*) from t_fruit&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> ((Long)<span class="built_in">super</span>.executeComplexQuery(sql)[<span class="number">0</span>]).intValue();</span><br><span class="line">        <span class="comment">//executeComplexQueryè¿”å›çš„æ˜¯ä¸€ä¸ªObject[] ,æ•°å€¼ä¸ºlongç±»å‹ï¼Œä¸èƒ½ç›´æ¥è½¬æˆintç±»å‹ï¼Œæ‰€ä»¥å…ˆè½¬æˆLongå¼•ç”¨ç±»å‹ä¹‹ååœ¨ç”¨intValue()è½¬ä¸ºintç±»å‹</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¹‹ååœ¨ç¼–å†™indexServlet</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Servletä»3.0ç‰ˆæœ¬å¼€å§‹æ”¯æŒæ³¨è§£æ–¹å¼çš„æ³¨å†Œ</span></span><br><span class="line"><span class="meta">@WebServlet(&quot;/index&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">IndexServlet</span> <span class="keyword">extends</span> <span class="title class_">ViewBaseServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request , HttpServletResponse response)</span><span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">pageNo</span> <span class="operator">=</span> <span class="number">1</span> ;</span><br><span class="line">        <span class="type">String</span> <span class="variable">pageNoStr</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;pageNo&quot;</span>);  <span class="comment">//jsè¿”å›çš„é¡µ</span></span><br><span class="line">        <span class="keyword">if</span>(StringUtil.isNotEmpty(pageNoStr))&#123;</span><br><span class="line">            pageNo = Integer.parseInt(pageNoStr);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> request.getSession() ;</span><br><span class="line">        session.setAttribute(<span class="string">&quot;pageNo&quot;</span>,pageNo);</span><br><span class="line"></span><br><span class="line">        <span class="type">FruitDAO</span> <span class="variable">fruitDAO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FruitDAOImpl</span>();</span><br><span class="line">        List&lt;Fruit&gt; fruitList = fruitDAO.getFruitList(pageNo);</span><br><span class="line"></span><br><span class="line">        session.setAttribute(<span class="string">&quot;fruitList&quot;</span>,fruitList);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ€»è®°å½•æ¡æ•°</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">fruitCount</span> <span class="operator">=</span> fruitDAO.getFruitCount();</span><br><span class="line">        <span class="comment">//æ€»é¡µæ•°</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">pageCount</span> <span class="operator">=</span> (fruitCount+<span class="number">5</span>-<span class="number">1</span>)/<span class="number">5</span> ;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        æ€»è®°å½•æ¡æ•°       æ€»é¡µæ•°</span></span><br><span class="line"><span class="comment">        1               1</span></span><br><span class="line"><span class="comment">        5               1</span></span><br><span class="line"><span class="comment">        6               2</span></span><br><span class="line"><span class="comment">        10              2</span></span><br><span class="line"><span class="comment">        11              3</span></span><br><span class="line"><span class="comment">        fruitCount      (fruitCount+5-1)/5</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        session.setAttribute(<span class="string">&quot;pageCount&quot;</span>,pageCount);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ­¤å¤„çš„è§†å›¾åç§°æ˜¯ index</span></span><br><span class="line">        <span class="comment">//é‚£ä¹ˆthymeleafä¼šå°†è¿™ä¸ª é€»è¾‘è§†å›¾åç§° å¯¹åº”åˆ° ç‰©ç†è§†å›¾ åç§°ä¸Šå»</span></span><br><span class="line">        <span class="comment">//é€»è¾‘è§†å›¾åç§° ï¼š   index</span></span><br><span class="line">        <span class="comment">//ç‰©ç†è§†å›¾åç§° ï¼š   view-prefix + é€»è¾‘è§†å›¾åç§° + view-suffix</span></span><br><span class="line">        <span class="comment">//æ‰€ä»¥çœŸå®çš„è§†å›¾åç§°æ˜¯ï¼š      /       index       .html</span></span><br><span class="line">        <span class="built_in">super</span>.processTemplate(<span class="string">&quot;index&quot;</span>,request,response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="é—®é¢˜ä¸€ï¼šTomcatçƒ­éƒ¨ç½²"><a href="#é—®é¢˜ä¸€ï¼šTomcatçƒ­éƒ¨ç½²" class="headerlink" title="é—®é¢˜ä¸€ï¼šTomcatçƒ­éƒ¨ç½²"></a>é—®é¢˜ä¸€ï¼šTomcatçƒ­éƒ¨ç½²</h4><p>Tomcatçƒ­éƒ¨ç½²åŸå› å¯¼åˆšä¿®æ”¹çš„æ•°æ®åŠ è½½ä¸ä¸Šæ¥ï¼Œå› æ­¤éœ€è¦åˆ é™¤Artifactçš„é¡¹ç›®æ¨¡å—ï¼Œé‡å¯Tomcaté€ æ¬¡åŠ è½½</p>
<h3 id="4ã€æ·»åŠ addæ“ä½œ"><a href="#4ã€æ·»åŠ addæ“ä½œ" class="headerlink" title="4ã€æ·»åŠ addæ“ä½œ"></a>4ã€æ·»åŠ addæ“ä½œ</h3><h4 id="1ï¼‰ç¼–å†™add-htmlé¡µé¢"><a href="#1ï¼‰ç¼–å†™add-htmlé¡µé¢" class="headerlink" title="1ï¼‰ç¼–å†™add.htmlé¡µé¢"></a>1ï¼‰ç¼–å†™add.htmlé¡µé¢</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span>    <span class="comment">&lt;!--thymeleafçš„å£°æ˜--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;css/add.css&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;div_container&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;div_fruit_list&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;center f30&quot;</span>&gt;</span>æ–°å¢åº“å­˜ä¿¡æ¯<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;add.do&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">table</span> <span class="attr">id</span>=<span class="string">&quot;tbl_fruit&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">th</span> <span class="attr">class</span>=<span class="string">&quot;w20&quot;</span>&gt;</span>åç§°ï¼š<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">               <span class="comment">&lt;!-- &lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;fname&quot; th:value=&quot;$&#123;fruit.fname&#125;&quot;/&gt;&lt;/td&gt; --&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;fname&quot;</span> /&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">th</span> <span class="attr">class</span>=<span class="string">&quot;w20&quot;</span>&gt;</span>å•ä»·ï¼š<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;price&quot;</span> /&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">th</span> <span class="attr">class</span>=<span class="string">&quot;w20&quot;</span>&gt;</span>åº“å­˜ï¼š<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;fcount&quot;</span> /&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">th</span> <span class="attr">class</span>=<span class="string">&quot;w20&quot;</span>&gt;</span>å¤‡æ³¨ï¼š<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;remark&quot;</span> /&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">th</span> <span class="attr">colspan</span>=<span class="string">&quot;2&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;æ·»åŠ &quot;</span> /&gt;</span></span><br><span class="line">               <span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="2ï¼‰ç¼–å†™add-cssæ ·å¼"><a href="#2ï¼‰ç¼–å†™add-cssæ ·å¼" class="headerlink" title="2ï¼‰ç¼–å†™add.cssæ ·å¼"></a>2ï¼‰ç¼–å†™add.cssæ ·å¼</h4><p>ç•¥</p>
<h4 id="3ï¼‰ç¼–å†™addServlet"><a href="#3ï¼‰ç¼–å†™addServlet" class="headerlink" title="3ï¼‰ç¼–å†™addServlet"></a>3ï¼‰ç¼–å†™addServlet</h4><p>åœ¨FruitDAOæ¥å£ä¸­æ·»åŠ addFruitæ–¹æ³•ï¼Œåœ¨FruitDAOImplå®ç°ç±»ä¸­é‡å†™æ­¤æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FruitDAOImpl</span> <span class="keyword">extends</span> <span class="title class_">BaseDAO</span>&lt;Fruit&gt; <span class="keyword">implements</span> <span class="title class_">FruitDAO</span> &#123;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addFruit</span><span class="params">(Fruit fruit)</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into t_fruit values(0,?,?,?,?)&quot;</span>;</span><br><span class="line">    <span class="built_in">super</span>.executeUpdate(sql,fruit.getFname(),fruit.getPrice(),fruit.getFcount(),fruit.getRemark());</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¹‹åè¿›è¡Œç¼–å†™addServletç±»</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/add.do&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AddServlet</span> <span class="keyword">extends</span> <span class="title class_">ViewBaseServlet</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">FruitDAO</span> <span class="variable">fruitDAO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FruitDAOImpl</span>();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        req.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="type">String</span> <span class="variable">fname</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;fname&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">priceStr</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;price&quot;</span>);</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">price</span> <span class="operator">=</span> Integer.parseInt(priceStr);</span><br><span class="line">        <span class="type">String</span> <span class="variable">fcountStr</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;fcount&quot;</span>);</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">fcount</span> <span class="operator">=</span> Integer.parseInt(fcountStr);</span><br><span class="line">        <span class="type">String</span> <span class="variable">remark</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;remark&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Fruit</span> <span class="variable">fruit</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Fruit</span>(<span class="number">0</span>,fname,price,fcount,remark);</span><br><span class="line">        fruitDAO.addFruit(fruit);</span><br><span class="line">        </span><br><span class="line">        resp.sendRedirect(<span class="string">&quot;index&quot;</span>); <span class="comment">//è·³è½¬å›ä¸»é¡µé¢çš„æ“ä½œï¼Œä½¿å®¢æˆ·ç«¯å‘index.htmlè¯·æ±‚</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="é—®é¢˜ä¸€ï¼šåå°„ç±»å‹è½¬æ¢å¤±è´¥"><a href="#é—®é¢˜ä¸€ï¼šåå°„ç±»å‹è½¬æ¢å¤±è´¥" class="headerlink" title="é—®é¢˜ä¸€ï¼šåå°„ç±»å‹è½¬æ¢å¤±è´¥"></a>é—®é¢˜ä¸€ï¼šåå°„ç±»å‹è½¬æ¢å¤±è´¥</h3><p>java.lang.Class cannot be cast to java.lang.reflect.ParameterizedType</p>
<p>è§£å†³æ–¹æ³•ï¼š</p>
<ul>
<li>instanceofæ˜¯Javaä¸­çš„äºŒå…ƒ<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E8%BF%90%E7%AE%97%E7%AC%A6&spm=1001.2101.3001.7020">è¿ç®—ç¬¦</a>ï¼Œå·¦è¾¹æ˜¯å¯¹è±¡ï¼Œå³è¾¹æ˜¯ç±»ï¼›å½“å¯¹è±¡æ˜¯å³è¾¹ç±»æˆ–å­ç±»æ‰€åˆ›å»ºå¯¹è±¡æ—¶ï¼Œè¿”å›trueï¼›å¦åˆ™ï¼Œè¿”å›falseã€‚</li>
<li>åœ¨å¼ºåˆ¶è½¬åŒ–<code>å‚æ•°åŒ–ç±»å‹</code> å½“å‚æ•°ç±»å‹å¯èƒ½æœ‰å¤šä¸ªæ³›å‹å‚æ•°çš„æ—¶å€™<br>éœ€è¦å¤šä¸€å±‚åˆ¤æ–­æ˜¯å¦åŒ…å« ï¼ˆæ­¤ä¸€ä¸ªå¯¹è±¡æ˜¯å¦ä¸ºä¸€ä¸ªç±»çš„å®ä¾‹ï¼‰ï¼Œ ç„¶åå†æ‰§è¡Œé€»è¾‘ä»£ç </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">BaseDAO</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="comment">//getClass() è·å–Classå¯¹è±¡ï¼Œå½“å‰æˆ‘ä»¬æ‰§è¡Œçš„æ˜¯new FruitDAOImpl() , åˆ›å»ºçš„æ˜¯FruitDAOImplçš„å®ä¾‹</span></span><br><span class="line">    <span class="comment">//é‚£ä¹ˆå­ç±»æ„é€ æ–¹æ³•å†…éƒ¨é¦–å…ˆä¼šè°ƒç”¨çˆ¶ç±»ï¼ˆBaseDAOï¼‰çš„æ— å‚æ„é€ æ–¹æ³•</span></span><br><span class="line">    <span class="comment">//å› æ­¤æ­¤å¤„çš„getClass()ä¼šè¢«æ‰§è¡Œï¼Œä½†æ˜¯getClassè·å–çš„æ˜¯FruitDAOImplçš„Class</span></span><br><span class="line">    <span class="comment">//æ‰€ä»¥getGenericSuperclass()è·å–åˆ°çš„æ˜¯BaseDAOçš„Class</span></span><br><span class="line">    <span class="type">Type</span> <span class="variable">genericType</span> <span class="operator">=</span> getClass().getGenericSuperclass();</span><br><span class="line">    <span class="comment">//ParameterizedType å‚æ•°åŒ–ç±»å‹</span></span><br><span class="line">    <span class="keyword">if</span>(genericType <span class="keyword">instanceof</span> ParameterizedType)&#123;  <span class="comment">//æ·»åŠ ç±»å‹åˆ¤æ–­</span></span><br><span class="line">        Type[] actualTypeArguments = ((ParameterizedType) genericType).getActualTypeArguments();</span><br><span class="line">        <span class="comment">//è·å–åˆ°çš„&lt;T&gt;ä¸­çš„Tçš„çœŸå®çš„ç±»å‹</span></span><br><span class="line">        <span class="type">Type</span> <span class="variable">actualType</span> <span class="operator">=</span> actualTypeArguments[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            entityClass = Class.forName(actualType.getTypeName());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="5ã€ç¼–è¾‘editæ“ä½œ"><a href="#5ã€ç¼–è¾‘editæ“ä½œ" class="headerlink" title="5ã€ç¼–è¾‘editæ“ä½œ"></a>5ã€ç¼–è¾‘editæ“ä½œ</h3><h4 id="1ï¼‰ç¼–å†™edit-htmlé¡µé¢"><a href="#1ï¼‰ç¼–å†™edit-htmlé¡µé¢" class="headerlink" title="1ï¼‰ç¼–å†™edit.htmlé¡µé¢"></a>1ï¼‰ç¼–å†™edit.htmlé¡µé¢</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;css/edit.css&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;div_container&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;div_fruit_list&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;center f30&quot;</span>&gt;</span>ç¼–è¾‘åº“å­˜ä¿¡æ¯3<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/update.do&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">th:object</span>=<span class="string">&quot;$&#123;fruit&#125;&quot;</span>&gt;</span></span><br><span class="line">         <span class="comment">&lt;!-- éšè—åŸŸ ï¼š åŠŸèƒ½ç±»ä¼¼äºæ–‡æœ¬æ¡† ï¼Œ å®ƒçš„å€¼ä¼šéšç€è¡¨å•çš„å‘é€ä¹Ÿä¼šå‘é€ç»™æœåŠ¡å™¨ï¼Œä½†æ˜¯ç•Œé¢ä¸Šç”¨æˆ·çœ‹ä¸åˆ° --&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;fid&quot;</span> <span class="attr">th:value</span>=<span class="string">&quot;*&#123;fid&#125;&quot;</span>/&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">table</span> <span class="attr">id</span>=<span class="string">&quot;tbl_fruit&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">th</span> <span class="attr">class</span>=<span class="string">&quot;w20&quot;</span>&gt;</span>åç§°ï¼š<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">               <span class="comment">&lt;!-- &lt;td=&quot;w20&quot;&gt;å•ä»·ï¼š&lt;/th&gt;</span></span><br><span class="line"><span class="comment">               &lt;td&gt;&lt;inpu&gt;&lt;input type=&quot;text&quot; name=&quot;fname&quot; th:value=&quot;$&#123;fruit.fname&#125;&quot;/&gt;&lt;/td&gt; --&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;fname&quot;</span> <span class="attr">th:value</span>=<span class="string">&quot;*&#123;fname&#125;&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">th</span> <span class="attr">classt</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;price&quot;</span> <span class="attr">th:value</span>=<span class="string">&quot;*&#123;price&#125;&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">th</span> <span class="attr">class</span>=<span class="string">&quot;w20&quot;</span>&gt;</span>åº“å­˜ï¼š<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;fcount&quot;</span> <span class="attr">th:value</span>=<span class="string">&quot;*&#123;fcount&#125;&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">th</span> <span class="attr">class</span>=<span class="string">&quot;w20&quot;</span>&gt;</span>å¤‡æ³¨ï¼š<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;remark&quot;</span> <span class="attr">th:value</span>=<span class="string">&quot;*&#123;remark&#125;&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">th</span> <span class="attr">colspan</span>=<span class="string">&quot;2&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;ä¿®æ”¹&quot;</span> /&gt;</span></span><br><span class="line">               <span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>é—®é¢˜ä¸€ï¼š</p>
<p>th:object&#x3D;â€${fruit}   è¡¨ç¤ºä»¥ä¸‹çš„è°ƒç”¨ï¼Œéƒ½æ˜¯è°ƒç”¨è¿™ä¸ªå¯¹è±¡</p>
<p>th:value&#x3D;â€*{fid}</p>
<p>é—®é¢˜äºŒï¼š</p>
<p>valueè¡¨ç¤ºæ–‡æœ¬æ¡†ä¸­çš„å€¼</p>
<p>é—®é¢˜ä¸‰ï¼š</p>
<p>æ­¤formè¡¨å•åœ¨edité¡µé¢ï¼Œç‚¹å‡»ä¿®æ”¹åˆ™å°†æ•°æ®å‘é€è‡³update.do</p>
</blockquote>
<h4 id="2ï¼‰ç¼–å†™edit-css"><a href="#2ï¼‰ç¼–å†™edit-css" class="headerlink" title="2ï¼‰ç¼–å†™edit.css"></a>2ï¼‰ç¼–å†™edit.css</h4><p>ç•¥</p>
<h4 id="3ï¼‰ç¼–å†™editServlet"><a href="#3ï¼‰ç¼–å†™editServlet" class="headerlink" title="3ï¼‰ç¼–å†™editServlet"></a>3ï¼‰ç¼–å†™editServlet</h4><p>åœ¨FruitDAOæ¥å£ä¸­æ·»åŠ getFruitByFidæ–¹æ³•ï¼Œåœ¨FruitDAOImplå®ç°ç±»ä¸­é‡å†™æ­¤æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Fruit <span class="title function_">getFruitByFid</span><span class="params">(Integer fid)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">super</span>.load(<span class="string">&quot;select * from t_fruit where fid= ?&quot;</span>,fid); <span class="comment">//è¿”å›æŸ¥è¯¢çš„ä¸ªä½“å¯¹è±¡</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç¼–å†™editServlet</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/edit.do&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EditServlet</span> <span class="keyword">extends</span> <span class="title class_">ViewBaseServlet</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">FruitDAO</span> <span class="variable">fruitDAO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FruitDAOImpl</span>();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request , HttpServletResponse response)</span><span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">fidStr</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;fid&quot;</span>); <span class="comment">//å®¢æˆ·ç«¯åœ¨indexé¡µé¢è¯·æ±‚edité¡µé¢å‘é€è¿‡æ¥çš„</span></span><br><span class="line">        <span class="keyword">if</span>(StringUtil.isNotEmpty(fidStr))&#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">fid</span> <span class="operator">=</span> Integer.parseInt(fidStr);</span><br><span class="line">            <span class="type">Fruit</span> <span class="variable">fruit</span> <span class="operator">=</span> fruitDAO.getFruitByFid(fid);</span><br><span class="line">            </span><br><span class="line">            request.setAttribute(<span class="string">&quot;fruit&quot;</span>,fruit); <span class="comment">//åœ¨ä¸€æ¬¡è¯·æ±‚ä¸­æœ‰æ•ˆï¼Œè®¾ç½®åœ¨è¯·æ±‚ä¸­</span></span><br><span class="line">            <span class="built_in">super</span>.processTemplate(<span class="string">&quot;edit&quot;</span>,request,response); <span class="comment">//åœ¨æœåŠ¡å™¨ç«¯å†…éƒ¨è¯·æ±‚è½¬å‘requestç»™edit</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h3 id="6ã€æ›´æ–°updateæ“ä½œ"><a href="#6ã€æ›´æ–°updateæ“ä½œ" class="headerlink" title="6ã€æ›´æ–°updateæ“ä½œ"></a>6ã€æ›´æ–°updateæ“ä½œ</h3><p>åœ¨FruitDAOæ¥å£ä¸­æ·»åŠ updateFruitæ–¹æ³•ï¼Œåœ¨FruitDAOImplå®ç°ç±»ä¸­é‡å†™æ­¤æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateFruit</span><span class="params">(Fruit fruit)</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update t_fruit set fname = ? , price = ? , fcount = ? , remark = ? where fid = ? &quot;</span> ;</span><br><span class="line">    <span class="built_in">super</span>.executeUpdate(sql,fruit.getFname(),fruit.getPrice(),fruit.getFcount(),fruit.getRemark(),fruit.getFid());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç¼–å†™updateServlet</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/update.do&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UpdateServlet</span> <span class="keyword">extends</span> <span class="title class_">ViewBaseServlet</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">FruitDAO</span> <span class="variable">fruitDAO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FruitDAOImpl</span>();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">//1.è®¾ç½®ç¼–ç </span></span><br><span class="line">        request.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.è·å–å‚æ•°</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">fidStr</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;fid&quot;</span>);</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">fid</span> <span class="operator">=</span> Integer.parseInt(fidStr);</span><br><span class="line">        <span class="type">String</span> <span class="variable">fname</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;fname&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">priceStr</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;price&quot;</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">price</span> <span class="operator">=</span> Integer.parseInt(priceStr);</span><br><span class="line">        <span class="type">String</span> <span class="variable">fcountStr</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;fcount&quot;</span>);</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">fcount</span> <span class="operator">=</span> Integer.parseInt(fcountStr);</span><br><span class="line">        <span class="type">String</span> <span class="variable">remark</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;remark&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.æ‰§è¡Œæ›´æ–°</span></span><br><span class="line">        fruitDAO.updateFruit(<span class="keyword">new</span> <span class="title class_">Fruit</span>(fid,fname, price ,fcount ,remark ));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4.èµ„æºè·³è½¬</span></span><br><span class="line">        <span class="comment">//super.processTemplate(&quot;index&quot;,request,response);</span></span><br><span class="line">        <span class="comment">//ç›¸å½“äºä¸‹é¢è¿™å¥è¯ï¼Œå³æœåŠ¡å™¨å†…èµ„æºé‡å®šå‘</span></span><br><span class="line">        <span class="comment">//request.getRequestDispatcher(&quot;index.html&quot;).forward(request,response);</span></span><br><span class="line">        <span class="comment">//å› ä¸ºindexæ˜¯ç”¨sessionä¿å­˜æ•°æ®çš„ï¼Œæ‰€ä»¥åˆšåˆšæ›´æ–°çš„æ•°æ®æ­¤æ—¶indexçš„sessionè¿˜æ²¡æœ‰ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨è¿™ä¸ªå¥è¯</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">//æ­¤å¤„éœ€è¦é‡å®šå‘ï¼Œç›®çš„æ˜¯é‡æ–°ç»™IndexServletå‘è¯·æ±‚ï¼Œé‡æ–°è·å–furitListï¼Œç„¶åè¦†ç›–åˆ°sessionä¸­ï¼Œè¿™æ ·index.htmlé¡µé¢ä¸Šæ˜¾ç¤ºçš„sessionä¸­çš„æ•°æ®æ‰æ˜¯æœ€æ–°çš„</span></span><br><span class="line">        response.sendRedirect(<span class="string">&quot;index&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="7ã€åˆ é™¤deleteæ“ä½œ"><a href="#7ã€åˆ é™¤deleteæ“ä½œ" class="headerlink" title="7ã€åˆ é™¤deleteæ“ä½œ"></a>7ã€åˆ é™¤deleteæ“ä½œ</h3><p>åœ¨FruitDAOæ¥å£ä¸­æ·»åŠ delFruitæ–¹æ³•ï¼Œåœ¨FruitDAOImplå®ç°ç±»ä¸­é‡å†™æ­¤æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delFruit</span><span class="params">(Integer fid)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>.executeUpdate(<span class="string">&quot;delete from t_fruit where fid = ? &quot;</span> , fid) ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç¼–å†™delServlet</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/del.do&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DelServlet</span> <span class="keyword">extends</span> <span class="title class_">ViewBaseServlet</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">FruitDAO</span> <span class="variable">fruitDAO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FruitDAOImpl</span>();</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request , HttpServletResponse response)</span><span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">fidStr</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;fid&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(StringUtil.isNotEmpty(fidStr))&#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">fid</span> <span class="operator">=</span> Integer.parseInt(fidStr);</span><br><span class="line">            fruitDAO.delFruit(fid);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//super.processTemplate(&quot;index&quot;,request,response);</span></span><br><span class="line">            response.sendRedirect(<span class="string">&quot;index&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h3 id="8ã€æ•´ä½“çš„ç›®å½•å’Œå·¥å…·ç±»"><a href="#8ã€æ•´ä½“çš„ç›®å½•å’Œå·¥å…·ç±»" class="headerlink" title="8ã€æ•´ä½“çš„ç›®å½•å’Œå·¥å…·ç±»"></a>8ã€æ•´ä½“çš„ç›®å½•å’Œå·¥å…·ç±»</h3><img src="/2022/09/30/JavaWeb/image-20220704151614586.png" alt="image-20220704151614586" style="zoom:50%;">

<h4 id="BaseDAO"><a href="#BaseDAO" class="headerlink" title="BaseDAO"></a>BaseDAO</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">BaseDAO</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DRIVER</span> <span class="operator">=</span> <span class="string">&quot;com.mysql.jdbc.Driver&quot;</span> ;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">URL</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/test?useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=false&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">USER</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">PWD</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span> ;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> Connection conn ;</span><br><span class="line">    <span class="keyword">protected</span> PreparedStatement psmt ;</span><br><span class="line">    <span class="keyword">protected</span> ResultSet rs ;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Tçš„Classå¯¹è±¡</span></span><br><span class="line">    <span class="keyword">private</span> Class entityClass ;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BaseDAO</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//getClass() è·å–Classå¯¹è±¡ï¼Œå½“å‰æˆ‘ä»¬æ‰§è¡Œçš„æ˜¯new FruitDAOImpl() , åˆ›å»ºçš„æ˜¯FruitDAOImplçš„å®ä¾‹</span></span><br><span class="line">        <span class="comment">//é‚£ä¹ˆå­ç±»æ„é€ æ–¹æ³•å†…éƒ¨é¦–å…ˆä¼šè°ƒç”¨çˆ¶ç±»ï¼ˆBaseDAOï¼‰çš„æ— å‚æ„é€ æ–¹æ³•</span></span><br><span class="line">        <span class="comment">//å› æ­¤æ­¤å¤„çš„getClass()ä¼šè¢«æ‰§è¡Œï¼Œä½†æ˜¯getClassè·å–çš„æ˜¯FruitDAOImplçš„Class</span></span><br><span class="line">        <span class="comment">//æ‰€ä»¥getGenericSuperclass()è·å–åˆ°çš„æ˜¯BaseDAOçš„Class</span></span><br><span class="line">        <span class="type">Type</span> <span class="variable">genericType</span> <span class="operator">=</span> getClass().getGenericSuperclass();</span><br><span class="line">        <span class="comment">//ParameterizedType å‚æ•°åŒ–ç±»å‹</span></span><br><span class="line">        Type[] actualTypeArguments = ((ParameterizedType) genericType).getActualTypeArguments();</span><br><span class="line">        <span class="comment">//è·å–åˆ°çš„&lt;T&gt;ä¸­çš„Tçš„çœŸå®çš„ç±»å‹</span></span><br><span class="line">        <span class="type">Type</span> <span class="variable">actualType</span> <span class="operator">=</span> actualTypeArguments[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            entityClass = Class.forName(actualType.getTypeName());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> Connection <span class="title function_">getConn</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//1.åŠ è½½é©±åŠ¨</span></span><br><span class="line">            Class.forName(DRIVER);</span><br><span class="line">            <span class="comment">//2.é€šè¿‡é©±åŠ¨ç®¡ç†å™¨è·å–è¿æ¥å¯¹è±¡</span></span><br><span class="line">            <span class="keyword">return</span> DriverManager.getConnection(URL, USER, PWD);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException | SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span> ;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">(ResultSet rs , PreparedStatement psmt , Connection conn)</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (rs != <span class="literal">null</span>) &#123;</span><br><span class="line">                rs.close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(psmt!=<span class="literal">null</span>)&#123;</span><br><span class="line">                psmt.close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(conn!=<span class="literal">null</span> &amp;&amp; !conn.isClosed())&#123;</span><br><span class="line">                conn.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç»™é¢„å¤„ç†å‘½ä»¤å¯¹è±¡è®¾ç½®å‚æ•°</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">setParams</span><span class="params">(PreparedStatement psmt , Object... params)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="keyword">if</span>(params!=<span class="literal">null</span> &amp;&amp; params.length&gt;<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; params.length; i++) &#123;</span><br><span class="line">                psmt.setObject(i+<span class="number">1</span>,params[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ‰§è¡Œæ›´æ–°ï¼Œè¿”å›å½±å“è¡Œæ•°</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="type">int</span> <span class="title function_">executeUpdate</span><span class="params">(String sql , Object... params)</span>&#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">insertFlag</span> <span class="operator">=</span> <span class="literal">false</span> ;</span><br><span class="line">        insertFlag = sql.trim().toUpperCase().startsWith(<span class="string">&quot;INSERT&quot;</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            conn = getConn();</span><br><span class="line">            <span class="keyword">if</span>(insertFlag)&#123;</span><br><span class="line">                psmt = conn.prepareStatement(sql,Statement.RETURN_GENERATED_KEYS);</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                psmt = conn.prepareStatement(sql);</span><br><span class="line">            &#125;</span><br><span class="line">            setParams(psmt,params);</span><br><span class="line">            <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> psmt.executeUpdate() ;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(insertFlag)&#123;</span><br><span class="line">                rs = psmt.getGeneratedKeys();</span><br><span class="line">                <span class="keyword">if</span>(rs.next())&#123;</span><br><span class="line">                    <span class="keyword">return</span> ((Long)rs.getLong(<span class="number">1</span>)).intValue();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> count ;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            close(rs,psmt,conn);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//é€šè¿‡åå°„æŠ€æœ¯ç»™objå¯¹è±¡çš„propertyå±æ€§èµ‹propertyValueå€¼</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">setValue</span><span class="params">(Object obj ,  String property , Object propertyValue)</span>&#123;</span><br><span class="line">        <span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> obj.getClass();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//è·å–propertyè¿™ä¸ªå­—ç¬¦ä¸²å¯¹åº”çš„å±æ€§å ï¼Œ æ¯”å¦‚ &quot;fid&quot;  å»æ‰¾ objå¯¹è±¡ä¸­çš„ fid å±æ€§</span></span><br><span class="line">            <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> clazz.getDeclaredField(property);</span><br><span class="line">            <span class="keyword">if</span>(field!=<span class="literal">null</span>)&#123;</span><br><span class="line">                field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">                field.set(obj,propertyValue);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchFieldException | IllegalAccessException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ‰§è¡Œå¤æ‚æŸ¥è¯¢ï¼Œè¿”å›ä¾‹å¦‚ç»Ÿè®¡ç»“æœ</span></span><br><span class="line">    <span class="keyword">protected</span> Object[] executeComplexQuery(String sql , Object... params)&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            conn = getConn() ;</span><br><span class="line">            psmt = conn.prepareStatement(sql);</span><br><span class="line">            setParams(psmt,params);</span><br><span class="line">            rs = psmt.executeQuery();</span><br><span class="line"></span><br><span class="line">            <span class="comment">//é€šè¿‡rså¯ä»¥è·å–ç»“æœé›†çš„å…ƒæ•°æ®</span></span><br><span class="line">            <span class="comment">//å…ƒæ•°æ®ï¼šæè¿°ç»“æœé›†æ•°æ®çš„æ•°æ® , ç®€å•è®²ï¼Œå°±æ˜¯è¿™ä¸ªç»“æœé›†æœ‰å“ªäº›åˆ—ï¼Œä»€ä¹ˆç±»å‹ç­‰ç­‰</span></span><br><span class="line"></span><br><span class="line">            <span class="type">ResultSetMetaData</span> <span class="variable">rsmd</span> <span class="operator">=</span> rs.getMetaData();</span><br><span class="line">            <span class="comment">//è·å–ç»“æœé›†çš„åˆ—æ•°</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">columnCount</span> <span class="operator">=</span> rsmd.getColumnCount();</span><br><span class="line">            Object[] columnValueArr = <span class="keyword">new</span> <span class="title class_">Object</span>[columnCount];</span><br><span class="line">            <span class="comment">//6.è§£ærs</span></span><br><span class="line">            <span class="keyword">if</span>(rs.next())&#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span> ; i&lt;columnCount;i++)&#123;</span><br><span class="line">                    <span class="type">Object</span> <span class="variable">columnValue</span> <span class="operator">=</span> rs.getObject(i+<span class="number">1</span>);     <span class="comment">//33    è‹¹æœ      5</span></span><br><span class="line">                    columnValueArr[i]=columnValue;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> columnValueArr ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            close(rs,psmt,conn);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span> ;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ‰§è¡ŒæŸ¥è¯¢ï¼Œè¿”å›å•ä¸ªå®ä½“å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">protected</span> T <span class="title function_">load</span><span class="params">(String sql , Object... params)</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            conn = getConn() ;</span><br><span class="line">            psmt = conn.prepareStatement(sql);</span><br><span class="line">            setParams(psmt,params);</span><br><span class="line">            rs = psmt.executeQuery();</span><br><span class="line"></span><br><span class="line">            <span class="comment">//é€šè¿‡rså¯ä»¥è·å–ç»“æœé›†çš„å…ƒæ•°æ®</span></span><br><span class="line">            <span class="comment">//å…ƒæ•°æ®ï¼šæè¿°ç»“æœé›†æ•°æ®çš„æ•°æ® , ç®€å•è®²ï¼Œå°±æ˜¯è¿™ä¸ªç»“æœé›†æœ‰å“ªäº›åˆ—ï¼Œä»€ä¹ˆç±»å‹ç­‰ç­‰</span></span><br><span class="line"></span><br><span class="line">            <span class="type">ResultSetMetaData</span> <span class="variable">rsmd</span> <span class="operator">=</span> rs.getMetaData();</span><br><span class="line">            <span class="comment">//è·å–ç»“æœé›†çš„åˆ—æ•°</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">columnCount</span> <span class="operator">=</span> rsmd.getColumnCount();</span><br><span class="line">            <span class="comment">//6.è§£ærs</span></span><br><span class="line">            <span class="keyword">if</span>(rs.next())&#123;</span><br><span class="line">                <span class="type">T</span> <span class="variable">entity</span> <span class="operator">=</span> (T)entityClass.newInstance();</span><br><span class="line"></span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span> ; i&lt;columnCount;i++)&#123;</span><br><span class="line">                    <span class="type">String</span> <span class="variable">columnName</span> <span class="operator">=</span> rsmd.getColumnName(i+<span class="number">1</span>);            <span class="comment">//fid   fname   price</span></span><br><span class="line">                    <span class="type">Object</span> <span class="variable">columnValue</span> <span class="operator">=</span> rs.getObject(i+<span class="number">1</span>);     <span class="comment">//33    è‹¹æœ      5</span></span><br><span class="line">                    setValue(entity,columnName,columnValue);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> entity ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InstantiationException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            close(rs,psmt,conn);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span> ;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ‰§è¡ŒæŸ¥è¯¢ï¼Œè¿”å›List</span></span><br><span class="line">    <span class="keyword">protected</span> List&lt;T&gt; <span class="title function_">executeQuery</span><span class="params">(String sql , Object... params)</span>&#123;</span><br><span class="line">        List&lt;T&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            conn = getConn() ;</span><br><span class="line">            psmt = conn.prepareStatement(sql);</span><br><span class="line">            setParams(psmt,params);</span><br><span class="line">            rs = psmt.executeQuery();</span><br><span class="line"></span><br><span class="line">            <span class="comment">//é€šè¿‡rså¯ä»¥è·å–ç»“æœé›†çš„å…ƒæ•°æ®</span></span><br><span class="line">            <span class="comment">//å…ƒæ•°æ®ï¼šæè¿°ç»“æœé›†æ•°æ®çš„æ•°æ® , ç®€å•è®²ï¼Œå°±æ˜¯è¿™ä¸ªç»“æœé›†æœ‰å“ªäº›åˆ—ï¼Œä»€ä¹ˆç±»å‹ç­‰ç­‰</span></span><br><span class="line"></span><br><span class="line">            <span class="type">ResultSetMetaData</span> <span class="variable">rsmd</span> <span class="operator">=</span> rs.getMetaData();</span><br><span class="line">            <span class="comment">//è·å–ç»“æœé›†çš„åˆ—æ•°</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">columnCount</span> <span class="operator">=</span> rsmd.getColumnCount();</span><br><span class="line">            <span class="comment">//6.è§£ærs</span></span><br><span class="line">            <span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line">                <span class="type">T</span> <span class="variable">entity</span> <span class="operator">=</span> (T)entityClass.newInstance();</span><br><span class="line"></span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span> ; i&lt;columnCount;i++)&#123;</span><br><span class="line">                    <span class="type">String</span> <span class="variable">columnName</span> <span class="operator">=</span> rsmd.getColumnName(i+<span class="number">1</span>);            <span class="comment">//fid   fname   price</span></span><br><span class="line">                    <span class="type">Object</span> <span class="variable">columnValue</span> <span class="operator">=</span> rs.getObject(i+<span class="number">1</span>);     <span class="comment">//33    è‹¹æœ      5</span></span><br><span class="line">                    setValue(entity,columnName,columnValue);</span><br><span class="line">                &#125;</span><br><span class="line">                list.add(entity);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InstantiationException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            close(rs,psmt,conn);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> list ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="ViewBaseServlet"><a href="#ViewBaseServlet" class="headerlink" title="ViewBaseServlet"></a>ViewBaseServlet</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ViewBaseServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> TemplateEngine templateEngine;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 1.è·å–ServletContextå¯¹è±¡</span></span><br><span class="line">        <span class="type">ServletContext</span> <span class="variable">servletContext</span> <span class="operator">=</span> <span class="built_in">this</span>.getServletContext();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2.åˆ›å»ºThymeleafè§£æå™¨å¯¹è±¡</span></span><br><span class="line">        <span class="type">ServletContextTemplateResolver</span> <span class="variable">templateResolver</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServletContextTemplateResolver</span>(servletContext);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3.ç»™è§£æå™¨å¯¹è±¡è®¾ç½®å‚æ•°</span></span><br><span class="line">        <span class="comment">// â‘ HTMLæ˜¯é»˜è®¤æ¨¡å¼ï¼Œæ˜ç¡®è®¾ç½®æ˜¯ä¸ºäº†ä»£ç æ›´å®¹æ˜“ç†è§£</span></span><br><span class="line">        templateResolver.setTemplateMode(TemplateMode.HTML);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// â‘¡è®¾ç½®å‰ç¼€</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">viewPrefix</span> <span class="operator">=</span> servletContext.getInitParameter(<span class="string">&quot;view-prefix&quot;</span>);</span><br><span class="line"></span><br><span class="line">        templateResolver.setPrefix(viewPrefix);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// â‘¢è®¾ç½®åç¼€</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">viewSuffix</span> <span class="operator">=</span> servletContext.getInitParameter(<span class="string">&quot;view-suffix&quot;</span>);</span><br><span class="line"></span><br><span class="line">        templateResolver.setSuffix(viewSuffix);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// â‘£è®¾ç½®ç¼“å­˜è¿‡æœŸæ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</span></span><br><span class="line">        templateResolver.setCacheTTLMs(<span class="number">60000L</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// â‘¤è®¾ç½®æ˜¯å¦ç¼“å­˜</span></span><br><span class="line">        templateResolver.setCacheable(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// â‘¥è®¾ç½®æœåŠ¡å™¨ç«¯ç¼–ç æ–¹å¼</span></span><br><span class="line">        templateResolver.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 4.åˆ›å»ºæ¨¡æ¿å¼•æ“å¯¹è±¡</span></span><br><span class="line">        templateEngine = <span class="keyword">new</span> <span class="title class_">TemplateEngine</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 5.ç»™æ¨¡æ¿å¼•æ“å¯¹è±¡è®¾ç½®æ¨¡æ¿è§£æå™¨</span></span><br><span class="line">        templateEngine.setTemplateResolver(templateResolver);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">processTemplate</span><span class="params">(String templateName, HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">// 1.è®¾ç½®å“åº”ä½“å†…å®¹ç±»å‹å’Œå­—ç¬¦é›†</span></span><br><span class="line">        resp.setContentType(<span class="string">&quot;text/html;charset=UTF-8&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2.åˆ›å»ºWebContextå¯¹è±¡</span></span><br><span class="line">        <span class="type">WebContext</span> <span class="variable">webContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">WebContext</span>(req, resp, getServletContext());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3.å¤„ç†æ¨¡æ¿æ•°æ®</span></span><br><span class="line">        templateEngine.process(templateName, webContext, resp.getWriter());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="StringUtil"><a href="#StringUtil" class="headerlink" title="StringUtil"></a>StringUtil</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StringUtil</span> &#123;</span><br><span class="line">    <span class="comment">//åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ä¸ºnullæˆ–è€…&quot;&quot;</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">(String str)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> str==<span class="literal">null</span> || <span class="string">&quot;&quot;</span>.equals(str);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isNotEmpty</span><span class="params">(String str)</span>&#123; <span class="keyword">return</span> !isEmpty(str); &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="9ã€å¢æ·»æŸ¥è¯¢åŠŸèƒ½"><a href="#9ã€å¢æ·»æŸ¥è¯¢åŠŸèƒ½" class="headerlink" title="9ã€å¢æ·»æŸ¥è¯¢åŠŸèƒ½"></a>9ã€å¢æ·»æŸ¥è¯¢åŠŸèƒ½</h3><p>æŸ¥è¯¢åŠŸèƒ½ï¼šæ ¹æ®åœ¨formè¡¨å•ä¸­è¾“å…¥å…³é”®å­—ï¼Œå‘é€è‡³æœåŠ¡ç«¯ï¼Œè¿”å›fnameæˆ–remarkä¸­å­˜åœ¨å…³é”®å­—çš„åº“å­˜è®°å½•ï¼Œè¿˜æ˜¯æŒ‰æ˜¾ç¤ºå‡ºæ¥ã€‚</p>
<p>ç”±äºæ­¤åŠŸèƒ½é™¤äº†ä¸indexåŸºæœ¬ç›¸ä¼¼ï¼ŒåŒºåˆ«åœ¨äºindexæŸ¥è¯¢æ˜¾ç¤ºå…¨éƒ¨æ•°æ®ï¼Œè€Œè¿™æ˜¯é€šè¿‡æŸ¥è¯¢åŒ¹é…çš„å…³é”®çš„æ•°æ®å› æ­¤åœ¨index.htmlä¸­å¢åŠ formè¡¨å•æ–‡æœ¬æ¡†ï¼Œå‘é€indexServlet</p>
<p><img src="/2022/09/30/JavaWeb/image-20220705111704829.png" alt="image-20220705111704829"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;border:0px solid red;width:60%;margin-left:20%;text-align:right;&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/index&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">style</span>=<span class="string">&quot;float:left;width:60%;margin-left:20%;&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;oper&quot;</span> <span class="attr">value</span>=<span class="string">&quot;search&quot;</span>/&gt;</span></span><br><span class="line">      è¯·è¾“å…¥å…³é”®å­—ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;keyword&quot;</span> <span class="attr">th:value</span>=<span class="string">&quot;$&#123;session.keyword&#125;&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;æŸ¥è¯¢&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn&quot;</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/add.html&#125;&quot;</span> <span class="attr">style</span>=<span class="string">&quot;border:0px solid blue;margin-bottom:4px;&quot;</span>&gt;</span>æ·»åŠ æ–°åº“å­˜è®°å½•<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å¯¹åº”çš„sqlä¿®æ”¹</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> List&lt;Fruit&gt; <span class="title function_">getFruitList</span><span class="params">(String keyword , Integer pageNo)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">super</span>.executeQuery(<span class="string">&quot;select * from t_fruit where fname like ? or remark like ? limit ? , 5&quot;</span> ,<span class="string">&quot;%&quot;</span>+keyword+<span class="string">&quot;%&quot;</span>,<span class="string">&quot;%&quot;</span>+keyword+<span class="string">&quot;%&quot;</span>, (pageNo-<span class="number">1</span>)*<span class="number">5</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>indexä¿®æ”¹</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/index&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">IndexServlet</span> <span class="keyword">extends</span> <span class="title class_">ViewBaseServlet</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        doGet(req,resp);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request , HttpServletResponse response)</span><span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        request.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">       <span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> request.getSession() ;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è®¾ç½®å½“å‰é¡µï¼Œé»˜è®¤å€¼1</span></span><br><span class="line">        <span class="type">Integer</span> <span class="variable">pageNo</span> <span class="operator">=</span> <span class="number">1</span> ;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">oper</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;oper&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¦‚æœoper!=null è¯´æ˜ é€šè¿‡è¡¨å•çš„æŸ¥è¯¢æŒ‰é’®ç‚¹å‡»è¿‡æ¥çš„</span></span><br><span class="line">        <span class="comment">//å¦‚æœoperæ˜¯ç©ºçš„ï¼Œè¯´æ˜ ä¸æ˜¯é€šè¿‡è¡¨å•çš„æŸ¥è¯¢æŒ‰é’®ç‚¹å‡»è¿‡æ¥çš„</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">keyword</span> <span class="operator">=</span> <span class="literal">null</span> ;</span><br><span class="line">        <span class="keyword">if</span>(StringUtil.isNotEmpty(oper) &amp;&amp; <span class="string">&quot;search&quot;</span>.equals(oper))&#123;</span><br><span class="line">            <span class="comment">//è¯´æ˜æ˜¯ç‚¹å‡»è¡¨å•æŸ¥è¯¢å‘é€è¿‡æ¥çš„è¯·æ±‚</span></span><br><span class="line">            <span class="comment">//æ­¤æ—¶ï¼ŒpageNoåº”è¯¥è¿˜åŸä¸º1 ï¼Œ keywordåº”è¯¥ä»è¯·æ±‚å‚æ•°ä¸­è·å–</span></span><br><span class="line">            pageNo = <span class="number">1</span> ;</span><br><span class="line">            keyword = request.getParameter(<span class="string">&quot;keyword&quot;</span>);</span><br><span class="line">            <span class="comment">//å¦‚æœkeywordä¸ºnullï¼Œéœ€è¦è®¾ç½®ä¸ºç©ºå­—ç¬¦ä¸²&quot;&quot;ï¼Œå¦åˆ™æŸ¥è¯¢æ—¶ä¼šæ‹¼æ¥æˆ %null% , æˆ‘ä»¬æœŸæœ›çš„æ˜¯ %%</span></span><br><span class="line">            <span class="keyword">if</span>(StringUtil.isEmpty(keyword))&#123;</span><br><span class="line">                keyword = <span class="string">&quot;&quot;</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//å°†keywordä¿å­˜ï¼ˆè¦†ç›–ï¼‰åˆ°sessionä¸­ï¼Œä¾¿äºæŸ¥æ‰¾ä¸Šä¸€é¡µæˆ–ä¸‹ä¸€é¡µæ—¶ä½¿ç”¨</span></span><br><span class="line">            session.setAttribute(<span class="string">&quot;keyword&quot;</span>,keyword);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">//è¯´æ˜æ­¤å¤„ä¸æ˜¯ç‚¹å‡»è¡¨å•æŸ¥è¯¢å‘é€è¿‡æ¥çš„è¯·æ±‚ï¼ˆæ¯”å¦‚ç‚¹å‡»ä¸‹é¢çš„ä¸Šä¸€é¡µä¸‹ä¸€é¡µæˆ–è€…ç›´æ¥åœ¨åœ°å€æ è¾“å…¥ç½‘å€ï¼‰</span></span><br><span class="line">            <span class="comment">//æ­¤æ—¶keywordåº”è¯¥ä»sessionä½œç”¨åŸŸè·å–</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">pageNoStr</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;pageNo&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span>(StringUtil.isNotEmpty(pageNoStr))&#123;</span><br><span class="line">                pageNo = Integer.parseInt(pageNoStr);   <span class="comment">//å¦‚æœä»è¯·æ±‚ä¸­è¯»å–åˆ°pageNoï¼Œåˆ™ç±»å‹è½¬æ¢ã€‚å¦åˆ™ï¼ŒpageNoé»˜è®¤å°±æ˜¯1</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//å¦‚æœä¸æ˜¯ç‚¹å‡»çš„æŸ¥è¯¢æŒ‰é’®ï¼Œé‚£ä¹ˆæŸ¥è¯¢æ˜¯åŸºäºsessionä¸­ä¿å­˜çš„ç°æœ‰keywordè¿›è¡ŒæŸ¥è¯¢</span></span><br><span class="line">            <span class="type">Object</span> <span class="variable">keywordObj</span> <span class="operator">=</span> session.getAttribute(<span class="string">&quot;keyword&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span>(keywordObj!=<span class="literal">null</span>)&#123;</span><br><span class="line">                keyword = (String)keywordObj ;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                keyword = <span class="string">&quot;&quot;</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é‡æ–°æ›´æ–°å½“å‰é¡µçš„å€¼</span></span><br><span class="line">        session.setAttribute(<span class="string">&quot;pageNo&quot;</span>,pageNo);</span><br><span class="line"></span><br><span class="line">        <span class="type">FruitDAO</span> <span class="variable">fruitDAO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FruitDAOImpl</span>();</span><br><span class="line">        List&lt;Fruit&gt; fruitList = fruitDAO.getFruitList(keyword , pageNo);</span><br><span class="line">        session.setAttribute(<span class="string">&quot;fruitList&quot;</span>,fruitList);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ€»è®°å½•æ¡æ•°</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">fruitCount</span> <span class="operator">=</span> fruitDAO.getFruitCount(keyword);</span><br><span class="line">        <span class="comment">//æ€»é¡µæ•°</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">pageCount</span> <span class="operator">=</span> (fruitCount+<span class="number">5</span>-<span class="number">1</span>)/<span class="number">5</span> ;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        æ€»è®°å½•æ¡æ•°       æ€»é¡µæ•°</span></span><br><span class="line"><span class="comment">        1               1</span></span><br><span class="line"><span class="comment">        5               1</span></span><br><span class="line"><span class="comment">        6               2</span></span><br><span class="line"><span class="comment">        10              2</span></span><br><span class="line"><span class="comment">        11              3</span></span><br><span class="line"><span class="comment">        fruitCount      (fruitCount+5-1)/5</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        session.setAttribute(<span class="string">&quot;pageCount&quot;</span>,pageCount);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ­¤å¤„çš„è§†å›¾åç§°æ˜¯ index</span></span><br><span class="line">        <span class="comment">//é‚£ä¹ˆthymeleafä¼šå°†è¿™ä¸ª é€»è¾‘è§†å›¾åç§° å¯¹åº”åˆ° ç‰©ç†è§†å›¾ åç§°ä¸Šå»</span></span><br><span class="line">        <span class="comment">//é€»è¾‘è§†å›¾åç§° ï¼š   index</span></span><br><span class="line">        <span class="comment">//ç‰©ç†è§†å›¾åç§° ï¼š   view-prefix + é€»è¾‘è§†å›¾åç§° + view-suffix</span></span><br><span class="line">        <span class="comment">//æ‰€ä»¥çœŸå®çš„è§†å›¾åç§°æ˜¯ï¼š      /       index       .html</span></span><br><span class="line">        <span class="built_in">super</span>.processTemplate(<span class="string">&quot;index&quot;</span>,request,response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="æ°´æœç³»ç»Ÿ-ä¼˜åŒ–1"><a href="#æ°´æœç³»ç»Ÿ-ä¼˜åŒ–1" class="headerlink" title="æ°´æœç³»ç»Ÿ-ä¼˜åŒ–1"></a>æ°´æœç³»ç»Ÿ-ä¼˜åŒ–1</h2><h3 id="åŸå§‹é¡¹ç›®ç®€å›¾"><a href="#åŸå§‹é¡¹ç›®ç®€å›¾" class="headerlink" title="åŸå§‹é¡¹ç›®ç®€å›¾"></a>åŸå§‹é¡¹ç›®ç®€å›¾</h3><p><img src="/2022/09/30/JavaWeb/image-20220705114314955.png" alt="image-20220705114314955"></p>
<blockquote>
<p>ç¼ºç‚¹æ˜¯å®¢æˆ·ç«¯éœ€è¦å‘å¤šä¸ªServletå‘é€è¯·æ±‚ï¼Œç»“æ„æ··ä¹±</p>
</blockquote>
<h3 id="ä¼˜åŒ–1ç®€å›¾"><a href="#ä¼˜åŒ–1ç®€å›¾" class="headerlink" title="ä¼˜åŒ–1ç®€å›¾"></a>ä¼˜åŒ–1ç®€å›¾</h3><p><img src="/2022/09/30/JavaWeb/image-20220705114518645.png" alt="image-20220705114518645"></p>
<blockquote>
<p>å»ºç«‹ä¸€ä¸ªæ€»Serlvetï¼Œæ ¹æ®è¯·æ±‚ä¸­çš„operateè°ƒç”¨ç›¸åº”Servlet</p>
</blockquote>
<h3 id="ä¿®æ”¹html"><a href="#ä¿®æ”¹html" class="headerlink" title="ä¿®æ”¹html"></a>ä¿®æ”¹html</h3><p><img src="/2022/09/30/JavaWeb/image-20220705115816559.png" alt="image-20220705115816559"></p>
<blockquote>
<p>æä¾›operateä¿¡æ¯ï¼Œå…¨éƒ¨è¯·æ±‚å‘é€è‡³fruit.do ï¼ŒFruitServletæ ¹æ®operateè°ƒç”¨ç›¸å…³Servlet</p>
</blockquote>
<h3 id="ä¼˜åŒ–1-ç¼–å†™FruitServlet-switch"><a href="#ä¼˜åŒ–1-ç¼–å†™FruitServlet-switch" class="headerlink" title="ä¼˜åŒ–1.ç¼–å†™FruitServlet-switch"></a>ä¼˜åŒ–1.ç¼–å†™FruitServlet-switch</h3><p>è¿™é‡Œä½¿ç”¨switchè¿›è¡ŒåŒºåˆ†ä¸åŒæ“ä½œè€Œè°ƒç”¨ç›¸åº”æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/fruit.do&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FruitServlet</span> <span class="keyword">extends</span> <span class="title class_">ViewBaseServlet</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">FruitDAO</span> <span class="variable">fruitDAO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FruitDAOImpl</span>();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">//è®¾ç½®ç¼–ç </span></span><br><span class="line">        request.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">operate</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;operate&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(StringUtil.isEmpty(operate))&#123; <span class="comment">//æ²¡æœ‰å…¶ä½™æ“ä½œï¼Œé»˜è®¤è·³è½¬index</span></span><br><span class="line">            operate = <span class="string">&quot;index&quot;</span> ;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">switch</span>(operate)&#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;index&quot;</span>:</span><br><span class="line">                index(request,response);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;add&quot;</span>:</span><br><span class="line">                add(request,response);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;del&quot;</span>:</span><br><span class="line">                del(request,response);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;edit&quot;</span>:</span><br><span class="line">                edit(request,response);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;update&quot;</span>:</span><br><span class="line">                update(request,response);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;operateå€¼éæ³•!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">//1.è®¾ç½®ç¼–ç </span></span><br><span class="line">        request.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.è·å–å‚æ•°</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">fidStr</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;fid&quot;</span>);</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">fid</span> <span class="operator">=</span> Integer.parseInt(fidStr);</span><br><span class="line">        <span class="type">String</span> <span class="variable">fname</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;fname&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">priceStr</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;price&quot;</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">price</span> <span class="operator">=</span> Integer.parseInt(priceStr);</span><br><span class="line">        <span class="type">String</span> <span class="variable">fcountStr</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;fcount&quot;</span>);</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">fcount</span> <span class="operator">=</span> Integer.parseInt(fcountStr);</span><br><span class="line">        <span class="type">String</span> <span class="variable">remark</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;remark&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.æ‰§è¡Œæ›´æ–°</span></span><br><span class="line">        fruitDAO.updateFruit(<span class="keyword">new</span> <span class="title class_">Fruit</span>(fid,fname, price ,fcount ,remark ));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4.èµ„æºè·³è½¬</span></span><br><span class="line">        <span class="comment">//super.processTemplate(&quot;index&quot;,request,response);</span></span><br><span class="line">        <span class="comment">//request.getRequestDispatcher(&quot;index.html&quot;).forward(request,response);</span></span><br><span class="line">        <span class="comment">//æ­¤å¤„éœ€è¦é‡å®šå‘ï¼Œç›®çš„æ˜¯é‡æ–°ç»™IndexServletå‘è¯·æ±‚ï¼Œé‡æ–°è·å–furitListï¼Œç„¶åè¦†ç›–åˆ°sessionä¸­ï¼Œè¿™æ ·index.htmlé¡µé¢ä¸Šæ˜¾ç¤ºçš„sessionä¸­çš„æ•°æ®æ‰æ˜¯æœ€æ–°çš„</span></span><br><span class="line">        response.sendRedirect(<span class="string">&quot;fruit.do&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">edit</span><span class="params">(HttpServletRequest request , HttpServletResponse response)</span><span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">fidStr</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;fid&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(StringUtil.isNotEmpty(fidStr))&#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">fid</span> <span class="operator">=</span> Integer.parseInt(fidStr);</span><br><span class="line">            <span class="type">Fruit</span> <span class="variable">fruit</span> <span class="operator">=</span> fruitDAO.getFruitByFid(fid);</span><br><span class="line">            request.setAttribute(<span class="string">&quot;fruit&quot;</span>,fruit);</span><br><span class="line">            <span class="built_in">super</span>.processTemplate(<span class="string">&quot;edit&quot;</span>,request,response);  <span class="comment">//æ‰¾åˆ°edit.htmlï¼Œå°†æ•°æ®æ¸²æŸ“ä¸Šå»</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">del</span><span class="params">(HttpServletRequest request , HttpServletResponse response)</span><span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">fidStr</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;fid&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(StringUtil.isNotEmpty(fidStr))&#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">fid</span> <span class="operator">=</span> Integer.parseInt(fidStr);</span><br><span class="line">            fruitDAO.delFruit(fid);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//super.processTemplate(&quot;index&quot;,request,response);</span></span><br><span class="line">            response.sendRedirect(<span class="string">&quot;fruit.do&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        request.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">fname</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;fname&quot;</span>);</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">price</span> <span class="operator">=</span> Integer.parseInt(request.getParameter(<span class="string">&quot;price&quot;</span>)) ;</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">fcount</span> <span class="operator">=</span> Integer.parseInt(request.getParameter(<span class="string">&quot;fcount&quot;</span>));</span><br><span class="line">        <span class="type">String</span> <span class="variable">remark</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;remark&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Fruit</span> <span class="variable">fruit</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Fruit</span>(<span class="number">0</span>,fname , price , fcount , remark ) ;</span><br><span class="line"></span><br><span class="line">        fruitDAO.addFruit(fruit);</span><br><span class="line"></span><br><span class="line">        response.sendRedirect(<span class="string">&quot;fruit.do&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">index</span><span class="params">(HttpServletRequest request , HttpServletResponse response)</span><span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        <span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> request.getSession() ;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è®¾ç½®å½“å‰é¡µï¼Œé»˜è®¤å€¼1</span></span><br><span class="line">        <span class="type">Integer</span> <span class="variable">pageNo</span> <span class="operator">=</span> <span class="number">1</span> ;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">oper</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;oper&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¦‚æœoper!=null è¯´æ˜ é€šè¿‡è¡¨å•çš„æŸ¥è¯¢æŒ‰é’®ç‚¹å‡»è¿‡æ¥çš„</span></span><br><span class="line">        <span class="comment">//å¦‚æœoperæ˜¯ç©ºçš„ï¼Œè¯´æ˜ ä¸æ˜¯é€šè¿‡è¡¨å•çš„æŸ¥è¯¢æŒ‰é’®ç‚¹å‡»è¿‡æ¥çš„</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">keyword</span> <span class="operator">=</span> <span class="literal">null</span> ;</span><br><span class="line">        <span class="keyword">if</span>(StringUtil.isNotEmpty(oper) &amp;&amp; <span class="string">&quot;search&quot;</span>.equals(oper))&#123;</span><br><span class="line">            <span class="comment">//è¯´æ˜æ˜¯ç‚¹å‡»è¡¨å•æŸ¥è¯¢å‘é€è¿‡æ¥çš„è¯·æ±‚</span></span><br><span class="line">            <span class="comment">//æ­¤æ—¶ï¼ŒpageNoåº”è¯¥è¿˜åŸä¸º1 ï¼Œ keywordåº”è¯¥ä»è¯·æ±‚å‚æ•°ä¸­è·å–</span></span><br><span class="line">            pageNo = <span class="number">1</span> ;</span><br><span class="line">            keyword = request.getParameter(<span class="string">&quot;keyword&quot;</span>);</span><br><span class="line">            <span class="comment">//å¦‚æœkeywordä¸ºnullï¼Œéœ€è¦è®¾ç½®ä¸ºç©ºå­—ç¬¦ä¸²&quot;&quot;ï¼Œå¦åˆ™æŸ¥è¯¢æ—¶ä¼šæ‹¼æ¥æˆ %null% , æˆ‘ä»¬æœŸæœ›çš„æ˜¯ %%</span></span><br><span class="line">            <span class="keyword">if</span>(StringUtil.isEmpty(keyword))&#123;</span><br><span class="line">                keyword = <span class="string">&quot;&quot;</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//å°†keywordä¿å­˜ï¼ˆè¦†ç›–ï¼‰åˆ°sessionä¸­</span></span><br><span class="line">            session.setAttribute(<span class="string">&quot;keyword&quot;</span>,keyword);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">//è¯´æ˜æ­¤å¤„ä¸æ˜¯ç‚¹å‡»è¡¨å•æŸ¥è¯¢å‘é€è¿‡æ¥çš„è¯·æ±‚ï¼ˆæ¯”å¦‚ç‚¹å‡»ä¸‹é¢çš„ä¸Šä¸€é¡µä¸‹ä¸€é¡µæˆ–è€…ç›´æ¥åœ¨åœ°å€æ è¾“å…¥ç½‘å€ï¼‰</span></span><br><span class="line">            <span class="comment">//æ­¤æ—¶keywordåº”è¯¥ä»sessionä½œç”¨åŸŸè·å–</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">pageNoStr</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;pageNo&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span>(StringUtil.isNotEmpty(pageNoStr))&#123;</span><br><span class="line">                pageNo = Integer.parseInt(pageNoStr);   <span class="comment">//å¦‚æœä»è¯·æ±‚ä¸­è¯»å–åˆ°pageNoï¼Œåˆ™ç±»å‹è½¬æ¢ã€‚å¦åˆ™ï¼ŒpageNoé»˜è®¤å°±æ˜¯1</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//å¦‚æœä¸æ˜¯ç‚¹å‡»çš„æŸ¥è¯¢æŒ‰é’®ï¼Œé‚£ä¹ˆæŸ¥è¯¢æ˜¯åŸºäºsessionä¸­ä¿å­˜çš„ç°æœ‰keywordè¿›è¡ŒæŸ¥è¯¢</span></span><br><span class="line">            <span class="type">Object</span> <span class="variable">keywordObj</span> <span class="operator">=</span> session.getAttribute(<span class="string">&quot;keyword&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span>(keywordObj!=<span class="literal">null</span>)&#123;</span><br><span class="line">                keyword = (String)keywordObj ;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                keyword = <span class="string">&quot;&quot;</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é‡æ–°æ›´æ–°å½“å‰é¡µçš„å€¼</span></span><br><span class="line">        session.setAttribute(<span class="string">&quot;pageNo&quot;</span>,pageNo);</span><br><span class="line"></span><br><span class="line">        <span class="type">FruitDAO</span> <span class="variable">fruitDAO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FruitDAOImpl</span>();</span><br><span class="line">        List&lt;Fruit&gt; fruitList = fruitDAO.getFruitList(keyword , pageNo);</span><br><span class="line">        session.setAttribute(<span class="string">&quot;fruitList&quot;</span>,fruitList);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ€»è®°å½•æ¡æ•°</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">fruitCount</span> <span class="operator">=</span> fruitDAO.getFruitCount(keyword);</span><br><span class="line">        <span class="comment">//æ€»é¡µæ•°</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">pageCount</span> <span class="operator">=</span> (fruitCount+<span class="number">5</span>-<span class="number">1</span>)/<span class="number">5</span> ;</span><br><span class="line">       </span><br><span class="line">        session.setAttribute(<span class="string">&quot;pageCount&quot;</span>,pageCount);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//é‚£ä¹ˆthymeleafä¼šå°†è¿™ä¸ª é€»è¾‘è§†å›¾åç§° å¯¹åº”åˆ° ç‰©ç†è§†å›¾ åç§°ä¸Šå»</span></span><br><span class="line">        <span class="built_in">super</span>.processTemplate(<span class="string">&quot;index&quot;</span>,request,response); <span class="comment">//æ‰¾åˆ°index.htmlï¼Œå°†æ•°æ®æ¸²æŸ“ä¸Šå»</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="ä¼˜åŒ–1-5ç¼–å†™FruitServlet-åå°„"><a href="#ä¼˜åŒ–1-5ç¼–å†™FruitServlet-åå°„" class="headerlink" title="ä¼˜åŒ–1.5ç¼–å†™FruitServlet-åå°„"></a>ä¼˜åŒ–1.5ç¼–å†™FruitServlet-åå°„</h2><p>ç”±äºä¼˜åŒ–1ä½¿ç”¨switchè¿›è¡ŒåŒºåˆ†è°ƒç”¨operateç›¸åº”æ–¹æ³•ï¼Œå¦‚æœæ–¹æ³•å¾ˆå¤šï¼Œswitchæ˜¾å¾—ç¬¨æ‹™ï¼Œè¿™é‡Œå°†ä½¿ç”¨åå°„æœºåˆ¶ï¼Œå°†æœ¬ç±»åŒåæ–¹æ³•æ‰¾å‡º</p>
<p>åªéœ€è¦é‡å†™ä¿®æ”¹serviceæ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">//è®¾ç½®ç¼–ç </span></span><br><span class="line">        request.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="type">String</span> <span class="variable">operate</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;operate&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(StringUtil.isEmpty(operate))&#123;</span><br><span class="line">            operate = <span class="string">&quot;index&quot;</span> ;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> <span class="built_in">this</span>.getClass().getDeclaredMethod(operate,HttpServletRequest.class,HttpServletResponse.class);</span><br><span class="line">            <span class="keyword">if</span>(method!=<span class="literal">null</span>)&#123;</span><br><span class="line">                method.setAccessible(<span class="literal">true</span>);</span><br><span class="line">                method.invoke(<span class="built_in">this</span>,request,response);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;operateå€¼éæ³•!&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>





<h2 id="æ°´æœç³»ç»Ÿ-ä¼˜åŒ–2"><a href="#æ°´æœç³»ç»Ÿ-ä¼˜åŒ–2" class="headerlink" title="æ°´æœç³»ç»Ÿ-ä¼˜åŒ–2"></a>æ°´æœç³»ç»Ÿ-ä¼˜åŒ–2</h2><h3 id="DispatcherServletçš„å¼•å…¥"><a href="#DispatcherServletçš„å¼•å…¥" class="headerlink" title="DispatcherServletçš„å¼•å…¥"></a>DispatcherServletçš„å¼•å…¥</h3><p><img src="/2022/09/30/JavaWeb/image-20220705171834121.png" alt="image-20220705171834121"></p>
<p>éšç€ç»„ä»¶çš„å¢å¤šï¼Œæ¯ä¸ªç»„ä»¶åˆæœ‰å¾ˆå¤šåŠŸèƒ½ï¼Œå› æ­¤å°†å„ä¸ªç»„ä»¶æœ‰ä¸­å¤®æ§åˆ¶å™¨æ¥æ§åˆ¶è°ƒç”¨</p>
<h3 id="DispatcherServlet"><a href="#DispatcherServlet" class="headerlink" title="DispatcherServlet"></a>DispatcherServlet</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;*.do&quot;)</span>  <span class="comment">//&quot;*&quot; è¡¨ä»»æ„å­—ç¬¦ï¼Œåå¸¦.doçš„å¯ä»¥åŒ¹é…æ­¤Servlet</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DispatcherServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String,Object&gt; beanMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">DispatcherServlet</span><span class="params">()</span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">	<span class="comment">//åˆå§‹åŒ–æ–¹æ³•ï¼šä»xmlä¸­è¯»å–æ§åˆ¶å™¨ï¼ˆç±»åå’Œä½ç½®ï¼‰ï¼Œåˆ›å»ºæ§åˆ¶å™¨å®ä¾‹ï¼Œå°†æ‰€æœ‰å®ä¾‹ä¿å­˜è‡³beanMapä¸­</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> getClass().getClassLoader().getResourceAsStream(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">            <span class="comment">//1.åˆ›å»ºDocumentBuilderFactory</span></span><br><span class="line">            <span class="type">DocumentBuilderFactory</span> <span class="variable">documentBuilderFactory</span> <span class="operator">=</span> DocumentBuilderFactory.newInstance();</span><br><span class="line">            <span class="comment">//2.åˆ›å»ºDocumentBuilderå¯¹è±¡</span></span><br><span class="line">            <span class="type">DocumentBuilder</span> <span class="variable">documentBuilder</span> <span class="operator">=</span> documentBuilderFactory.newDocumentBuilder() ;</span><br><span class="line">            <span class="comment">//3.åˆ›å»ºDocumentå¯¹è±¡</span></span><br><span class="line">            <span class="type">Document</span> <span class="variable">document</span> <span class="operator">=</span> documentBuilder.parse(inputStream);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//4.è·å–æ‰€æœ‰çš„beanèŠ‚ç‚¹</span></span><br><span class="line">            <span class="type">NodeList</span> <span class="variable">beanNodeList</span> <span class="operator">=</span> document.getElementsByTagName(<span class="string">&quot;bean&quot;</span>);</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span> ; i&lt;beanNodeList.getLength() ; i++)&#123;</span><br><span class="line">                <span class="type">Node</span> <span class="variable">beanNode</span> <span class="operator">=</span> beanNodeList.item(i);</span><br><span class="line">                <span class="keyword">if</span>(beanNode.getNodeType() == Node.ELEMENT_NODE)&#123;  <span class="comment">//æ˜¯ä¸æ˜¯å…ƒç´ èŠ‚ç‚¹</span></span><br><span class="line">                    <span class="type">Element</span> <span class="variable">beanElement</span> <span class="operator">=</span> (Element)beanNode ;</span><br><span class="line">                    <span class="type">String</span> <span class="variable">beanId</span> <span class="operator">=</span>  beanElement.getAttribute(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">                    <span class="type">String</span> <span class="variable">className</span> <span class="operator">=</span> beanElement.getAttribute(<span class="string">&quot;class&quot;</span>);</span><br><span class="line">                    <span class="type">Class</span> <span class="variable">controllerBeanClass</span> <span class="operator">=</span> Class.forName(className);</span><br><span class="line">                    <span class="type">Object</span> <span class="variable">beanObj</span> <span class="operator">=</span> controllerBeanClass.newInstance() ;</span><br><span class="line">                    </span><br><span class="line">                    <span class="comment">//ç”±äºæ§åˆ¶å™¨æ²¡æœ‰setServletContext</span></span><br><span class="line">                    <span class="comment">//æ‰€ä»¥åœ¨è¿™é‡Œé¡ºä¾¿å°†setServletContextä¼ ç»™å®ƒ</span></span><br><span class="line">                    <span class="type">Method</span> <span class="variable">setServletContextMethod</span> <span class="operator">=</span> controllerBeanClass.getDeclaredMethod(<span class="string">&quot;setServletContext&quot;</span>,ServletContext.class);</span><br><span class="line">                    setServletContextMethod.invoke(beanObj , <span class="built_in">this</span>.getServletContext());</span><br><span class="line"></span><br><span class="line">                    beanMap.put(beanId , beanObj) ;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">//è®¾ç½®ç¼–ç </span></span><br><span class="line">        request.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        <span class="comment">//å‡è®¾urlæ˜¯ï¼š  http://localhost:8080/pro15/hello.do</span></span><br><span class="line">        <span class="comment">//é‚£ä¹ˆservletPathæ˜¯ï¼š    /hello.do</span></span><br><span class="line">        <span class="comment">// æˆ‘çš„æ€è·¯æ˜¯ï¼š</span></span><br><span class="line">        <span class="comment">// ç¬¬1æ­¥ï¼š /hello.do -&gt;   hello   æˆ–è€…  /fruit.do  -&gt; fruit</span></span><br><span class="line">        <span class="comment">// ç¬¬2æ­¥ï¼š hello -&gt; HelloController æˆ–è€… fruit -&gt; FruitController</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">servletPath</span> <span class="operator">=</span> request.getServletPath(); <span class="comment">//å…·ä½“æ§åˆ¶å™¨åç§°</span></span><br><span class="line">        servletPath = servletPath.substring(<span class="number">1</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">lastDotIndex</span> <span class="operator">=</span> servletPath.lastIndexOf(<span class="string">&quot;.do&quot;</span>) ;</span><br><span class="line">        servletPath = servletPath.substring(<span class="number">0</span>,lastDotIndex); <span class="comment">// å»æ‰/ å’Œ.do çš„å­—ç¬¦</span></span><br><span class="line">		</span><br><span class="line">    	<span class="comment">//ç”¨servletPathå°±å¯è·å–å¯¹åº”çš„å¯¹è±¡</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">controllerBeanObj</span> <span class="operator">=</span> beanMap.get(servletPath);</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">operate</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;operate&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(StringUtil.isEmpty(operate))&#123;</span><br><span class="line">            operate = <span class="string">&quot;index&quot;</span> ;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> controllerBeanObj.getClass().getDeclaredMethod(operate,HttpServletRequest.class,HttpServletResponse.class);</span><br><span class="line">            <span class="keyword">if</span>(method!=<span class="literal">null</span>)&#123;</span><br><span class="line">                method.setAccessible(<span class="literal">true</span>);</span><br><span class="line">                method.invoke(controllerBeanObj,request,response);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;operateå€¼éæ³•!&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ViewBaseServlet-1"><a href="#ViewBaseServlet-1" class="headerlink" title="ViewBaseServlet"></a>ViewBaseServlet</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ViewBaseServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> TemplateEngine templateEngine;</span><br><span class="line">    <span class="keyword">private</span> ServletContext servletContext ;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(ServletContext servletContext)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">        <span class="built_in">this</span>.servletContext = servletContext ;</span><br><span class="line">        <span class="comment">// 1.è·å–ServletContextå¯¹è±¡</span></span><br><span class="line">        <span class="comment">//ServletContext servletContext = this.getServletContext();</span></span><br><span class="line">        <span class="comment">// 2.åˆ›å»ºThymeleafè§£æå™¨å¯¹è±¡</span></span><br><span class="line">        <span class="type">ServletContextTemplateResolver</span> <span class="variable">templateResolver</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServletContextTemplateResolver</span>(servletContext);</span><br><span class="line">        <span class="comment">// 3.ç»™è§£æå™¨å¯¹è±¡è®¾ç½®å‚æ•°</span></span><br><span class="line">        <span class="comment">// â‘ HTMLæ˜¯é»˜è®¤æ¨¡å¼ï¼Œæ˜ç¡®è®¾ç½®æ˜¯ä¸ºäº†ä»£ç æ›´å®¹æ˜“ç†è§£</span></span><br><span class="line">        templateResolver.setTemplateMode(TemplateMode.HTML);</span><br><span class="line">        <span class="comment">// â‘¡è®¾ç½®å‰ç¼€</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">viewPrefix</span> <span class="operator">=</span> servletContext.getInitParameter(<span class="string">&quot;view-prefix&quot;</span>);</span><br><span class="line">        templateResolver.setPrefix(viewPrefix);</span><br><span class="line">        <span class="comment">// â‘¢è®¾ç½®åç¼€</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">viewSuffix</span> <span class="operator">=</span> servletContext.getInitParameter(<span class="string">&quot;view-suffix&quot;</span>);</span><br><span class="line">        templateResolver.setSuffix(viewSuffix);</span><br><span class="line">        <span class="comment">// â‘£è®¾ç½®ç¼“å­˜è¿‡æœŸæ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</span></span><br><span class="line">        templateResolver.setCacheTTLMs(<span class="number">60000L</span>);</span><br><span class="line">        <span class="comment">// â‘¤è®¾ç½®æ˜¯å¦ç¼“å­˜</span></span><br><span class="line">        templateResolver.setCacheable(<span class="literal">true</span>);</span><br><span class="line">        <span class="comment">// â‘¥è®¾ç½®æœåŠ¡å™¨ç«¯ç¼–ç æ–¹å¼</span></span><br><span class="line">        templateResolver.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">        <span class="comment">// 4.åˆ›å»ºæ¨¡æ¿å¼•æ“å¯¹è±¡</span></span><br><span class="line">        templateEngine = <span class="keyword">new</span> <span class="title class_">TemplateEngine</span>();</span><br><span class="line">        <span class="comment">// 5.ç»™æ¨¡æ¿å¼•æ“å¯¹è±¡è®¾ç½®æ¨¡æ¿è§£æå™¨</span></span><br><span class="line">        templateEngine.setTemplateResolver(templateResolver);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">processTemplate</span><span class="params">(String templateName, HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">// 1.è®¾ç½®å“åº”ä½“å†…å®¹ç±»å‹å’Œå­—ç¬¦é›†</span></span><br><span class="line">        resp.setContentType(<span class="string">&quot;text/html;charset=UTF-8&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2.åˆ›å»ºWebContextå¯¹è±¡</span></span><br><span class="line">        <span class="type">WebContext</span> <span class="variable">webContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">WebContext</span>(req, resp, <span class="built_in">this</span>.servletContext);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3.å¤„ç†æ¨¡æ¿æ•°æ®</span></span><br><span class="line">        templateEngine.process(templateName, webContext, resp.getWriter());</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="FruitController"><a href="#FruitController" class="headerlink" title="FruitController"></a>FruitController</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FruitController</span> <span class="keyword">extends</span> <span class="title class_">ViewBaseServlet</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä¹‹å‰FruitServletæ˜¯ä¸€ä¸ªSevletç»„ä»¶ï¼Œé‚£ä¹ˆå…¶ä¸­çš„initæ–¹æ³•ä¸€å®šä¼šè¢«è°ƒç”¨ </span></span><br><span class="line">    <span class="comment">//ä¹‹å‰çš„initæ–¹æ³•å†…éƒ¨ä¼šå‡ºç°ä¸€å¥è¯ï¼šsuper.init();</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ServletContext servletContext ;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setServletContext</span><span class="params">(ServletContext servletContext)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">        <span class="built_in">this</span>.servletContext = servletContext;</span><br><span class="line">        <span class="built_in">super</span>.init(servletContext);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="type">FruitDAO</span> <span class="variable">fruitDAO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FruitDAOImpl</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">//1.è®¾ç½®ç¼–ç </span></span><br><span class="line">        request.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.è·å–å‚æ•°</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">fidStr</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;fid&quot;</span>);</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">fid</span> <span class="operator">=</span> Integer.parseInt(fidStr);</span><br><span class="line">        <span class="type">String</span> <span class="variable">fname</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;fname&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">priceStr</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;price&quot;</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">price</span> <span class="operator">=</span> Integer.parseInt(priceStr);</span><br><span class="line">        <span class="type">String</span> <span class="variable">fcountStr</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;fcount&quot;</span>);</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">fcount</span> <span class="operator">=</span> Integer.parseInt(fcountStr);</span><br><span class="line">        <span class="type">String</span> <span class="variable">remark</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;remark&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.æ‰§è¡Œæ›´æ–°</span></span><br><span class="line">        fruitDAO.updateFruit(<span class="keyword">new</span> <span class="title class_">Fruit</span>(fid,fname, price ,fcount ,remark ));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4.èµ„æºè·³è½¬</span></span><br><span class="line">        <span class="comment">//super.processTemplate(&quot;index&quot;,request,response);</span></span><br><span class="line">        <span class="comment">//request.getRequestDispatcher(&quot;index.html&quot;).forward(request,response);</span></span><br><span class="line">        <span class="comment">//æ­¤å¤„éœ€è¦é‡å®šå‘ï¼Œç›®çš„æ˜¯é‡æ–°ç»™IndexServletå‘è¯·æ±‚ï¼Œé‡æ–°è·å–furitListï¼Œç„¶åè¦†ç›–åˆ°sessionä¸­ï¼Œè¿™æ ·index.htmlé¡µé¢ä¸Šæ˜¾ç¤ºçš„sessionä¸­çš„æ•°æ®æ‰æ˜¯æœ€æ–°çš„</span></span><br><span class="line">        response.sendRedirect(<span class="string">&quot;fruit.do&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">edit</span><span class="params">(HttpServletRequest request , HttpServletResponse response)</span><span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">fidStr</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;fid&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(StringUtil.isNotEmpty(fidStr))&#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">fid</span> <span class="operator">=</span> Integer.parseInt(fidStr);</span><br><span class="line">            <span class="type">Fruit</span> <span class="variable">fruit</span> <span class="operator">=</span> fruitDAO.getFruitByFid(fid);</span><br><span class="line">            request.setAttribute(<span class="string">&quot;fruit&quot;</span>,fruit);</span><br><span class="line">            <span class="built_in">super</span>.processTemplate(<span class="string">&quot;edit&quot;</span>,request,response);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">del</span><span class="params">(HttpServletRequest request , HttpServletResponse response)</span><span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">fidStr</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;fid&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(StringUtil.isNotEmpty(fidStr))&#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">fid</span> <span class="operator">=</span> Integer.parseInt(fidStr);</span><br><span class="line">            fruitDAO.delFruit(fid);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//super.processTemplate(&quot;index&quot;,request,response);</span></span><br><span class="line">            response.sendRedirect(<span class="string">&quot;fruit.do&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        request.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">fname</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;fname&quot;</span>);</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">price</span> <span class="operator">=</span> Integer.parseInt(request.getParameter(<span class="string">&quot;price&quot;</span>)) ;</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">fcount</span> <span class="operator">=</span> Integer.parseInt(request.getParameter(<span class="string">&quot;fcount&quot;</span>));</span><br><span class="line">        <span class="type">String</span> <span class="variable">remark</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;remark&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Fruit</span> <span class="variable">fruit</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Fruit</span>(<span class="number">0</span>,fname , price , fcount , remark ) ;</span><br><span class="line"></span><br><span class="line">        fruitDAO.addFruit(fruit);</span><br><span class="line"></span><br><span class="line">        response.sendRedirect(<span class="string">&quot;fruit.do&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">index</span><span class="params">(HttpServletRequest request , HttpServletResponse response)</span><span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        <span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> request.getSession() ;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è®¾ç½®å½“å‰é¡µï¼Œé»˜è®¤å€¼1</span></span><br><span class="line">        <span class="type">Integer</span> <span class="variable">pageNo</span> <span class="operator">=</span> <span class="number">1</span> ;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">oper</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;oper&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¦‚æœoper!=null è¯´æ˜ é€šè¿‡è¡¨å•çš„æŸ¥è¯¢æŒ‰é’®ç‚¹å‡»è¿‡æ¥çš„</span></span><br><span class="line">        <span class="comment">//å¦‚æœoperæ˜¯ç©ºçš„ï¼Œè¯´æ˜ ä¸æ˜¯é€šè¿‡è¡¨å•çš„æŸ¥è¯¢æŒ‰é’®ç‚¹å‡»è¿‡æ¥çš„</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">keyword</span> <span class="operator">=</span> <span class="literal">null</span> ;</span><br><span class="line">        <span class="keyword">if</span>(StringUtil.isNotEmpty(oper) &amp;&amp; <span class="string">&quot;search&quot;</span>.equals(oper))&#123;</span><br><span class="line">            <span class="comment">//è¯´æ˜æ˜¯ç‚¹å‡»è¡¨å•æŸ¥è¯¢å‘é€è¿‡æ¥çš„è¯·æ±‚</span></span><br><span class="line">            <span class="comment">//æ­¤æ—¶ï¼ŒpageNoåº”è¯¥è¿˜åŸä¸º1 ï¼Œ keywordåº”è¯¥ä»è¯·æ±‚å‚æ•°ä¸­è·å–</span></span><br><span class="line">            pageNo = <span class="number">1</span> ;</span><br><span class="line">            keyword = request.getParameter(<span class="string">&quot;keyword&quot;</span>);</span><br><span class="line">            <span class="comment">//å¦‚æœkeywordä¸ºnullï¼Œéœ€è¦è®¾ç½®ä¸ºç©ºå­—ç¬¦ä¸²&quot;&quot;ï¼Œå¦åˆ™æŸ¥è¯¢æ—¶ä¼šæ‹¼æ¥æˆ %null% , æˆ‘ä»¬æœŸæœ›çš„æ˜¯ %%</span></span><br><span class="line">            <span class="keyword">if</span>(StringUtil.isEmpty(keyword))&#123;</span><br><span class="line">                keyword = <span class="string">&quot;&quot;</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//å°†keywordä¿å­˜ï¼ˆè¦†ç›–ï¼‰åˆ°sessionä¸­</span></span><br><span class="line">            session.setAttribute(<span class="string">&quot;keyword&quot;</span>,keyword);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">//è¯´æ˜æ­¤å¤„ä¸æ˜¯ç‚¹å‡»è¡¨å•æŸ¥è¯¢å‘é€è¿‡æ¥çš„è¯·æ±‚ï¼ˆæ¯”å¦‚ç‚¹å‡»ä¸‹é¢çš„ä¸Šä¸€é¡µä¸‹ä¸€é¡µæˆ–è€…ç›´æ¥åœ¨åœ°å€æ è¾“å…¥ç½‘å€ï¼‰</span></span><br><span class="line">            <span class="comment">//æ­¤æ—¶keywordåº”è¯¥ä»sessionä½œç”¨åŸŸè·å–</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">pageNoStr</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;pageNo&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span>(StringUtil.isNotEmpty(pageNoStr))&#123;</span><br><span class="line">                pageNo = Integer.parseInt(pageNoStr);   <span class="comment">//å¦‚æœä»è¯·æ±‚ä¸­è¯»å–åˆ°pageNoï¼Œåˆ™ç±»å‹è½¬æ¢ã€‚å¦åˆ™ï¼ŒpageNoé»˜è®¤å°±æ˜¯1</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//å¦‚æœä¸æ˜¯ç‚¹å‡»çš„æŸ¥è¯¢æŒ‰é’®ï¼Œé‚£ä¹ˆæŸ¥è¯¢æ˜¯åŸºäºsessionä¸­ä¿å­˜çš„ç°æœ‰keywordè¿›è¡ŒæŸ¥è¯¢</span></span><br><span class="line">            <span class="type">Object</span> <span class="variable">keywordObj</span> <span class="operator">=</span> session.getAttribute(<span class="string">&quot;keyword&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span>(keywordObj!=<span class="literal">null</span>)&#123;</span><br><span class="line">                keyword = (String)keywordObj ;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                keyword = <span class="string">&quot;&quot;</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// é‡æ–°æ›´æ–°å½“å‰é¡µçš„å€¼</span></span><br><span class="line">        session.setAttribute(<span class="string">&quot;pageNo&quot;</span>,pageNo);</span><br><span class="line"></span><br><span class="line">        <span class="type">FruitDAO</span> <span class="variable">fruitDAO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FruitDAOImpl</span>();</span><br><span class="line">        List&lt;Fruit&gt; fruitList = fruitDAO.getFruitList(keyword , pageNo);</span><br><span class="line">        session.setAttribute(<span class="string">&quot;fruitList&quot;</span>,fruitList);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ€»è®°å½•æ¡æ•°</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">fruitCount</span> <span class="operator">=</span> fruitDAO.getFruitCount(keyword);</span><br><span class="line">        <span class="comment">//æ€»é¡µæ•°</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">pageCount</span> <span class="operator">=</span> (fruitCount+<span class="number">5</span>-<span class="number">1</span>)/<span class="number">5</span> ;</span><br><span class="line">      </span><br><span class="line">        session.setAttribute(<span class="string">&quot;pageCount&quot;</span>,pageCount);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">super</span>.processTemplate(<span class="string">&quot;index&quot;</span>,request,response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="applicationContext-xml"><a href="#applicationContext-xml" class="headerlink" title="applicationContext.xml"></a>applicationContext.xml</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- è¿™ä¸ªbeanæ ‡ç­¾çš„ä½œç”¨æ˜¯ å°†æ¥servletpathä¸­æ¶‰åŠçš„åå­—å¯¹åº”çš„æ˜¯fruitï¼Œé‚£ä¹ˆå°±è¦FruitControllerè¿™ä¸ªç±»æ¥å¤„ç† --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;fruit&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.atguigu.fruit.controllers.FruitController&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">1.æ¦‚å¿µ</span></span><br><span class="line"><span class="comment">HTML : è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€</span></span><br><span class="line"><span class="comment">XML : å¯æ‰©å±•çš„æ ‡è®°è¯­è¨€ ï¼ˆæ ‡ç­¾åå­—å¯è‡ªå®šä¹‰ï¼‰</span></span><br><span class="line"><span class="comment">HTMLæ˜¯XMLçš„ä¸€ä¸ªå­é›†</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">2.XMLåŒ…å«ä¸‰ä¸ªéƒ¨åˆ†ï¼š</span></span><br><span class="line"><span class="comment">1) XMLå£°æ˜ ï¼Œ è€Œä¸”å£°æ˜è¿™ä¸€è¡Œä»£ç å¿…é¡»åœ¨XMLæ–‡ä»¶çš„ç¬¬ä¸€è¡Œ</span></span><br><span class="line"><span class="comment">2) DTD æ–‡æ¡£ç±»å‹å®šä¹‰</span></span><br><span class="line"><span class="comment">3) XMLæ­£æ–‡</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="æ€è·¯å³é—®é¢˜çš„æ€»ç»“"><a href="#æ€è·¯å³é—®é¢˜çš„æ€»ç»“" class="headerlink" title="æ€è·¯å³é—®é¢˜çš„æ€»ç»“"></a>æ€è·¯å³é—®é¢˜çš„æ€»ç»“</h3><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>DispatcherServletç»§æ‰¿HttpServlet</p>
<ul>
<li>ä¸­å¤®æ§åˆ¶å™¨æ¥å—æ‰€æœ‰å®¢æˆ·ç«¯å‘æ¥çš„æ“ä½œè¯·æ±‚</li>
<li>å…¶ä¸­çš„initæ–¹æ³•åˆå§‹åŒ–æ–¹æ³•ï¼šä»xmlä¸­è¯»å–æ§åˆ¶å™¨ï¼ˆç±»åå’Œä½ç½®ï¼‰ï¼Œåˆ›å»ºæ§åˆ¶å™¨å®ä¾‹ï¼Œå°†æ‰€æœ‰å®ä¾‹ä¿å­˜è‡³beanMapä¸­</li>
<li>serviceæ–¹æ³•å°†è¯·æ±‚ä¸­çš„å…·ä½“çš„â€œxxx.doâ€,â€œxxxâ€å­—ç¬¦æ˜¯å…·ä½“çš„æ§åˆ¶å™¨åç§°ï¼Œå¯åœ¨beanMapä¸­å¾—åˆ°ç›¸åº”å®ä¾‹ï¼Œä¹‹ååœ¨è·å–è¯·æ±‚ä¸­operateå…·ä½“çš„æ“ä½œè¿›è¡Œè°ƒç”¨å®ä¾‹ä¸­çš„æ–¹æ³•</li>
</ul>
<h4 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h4><ul>
<li>ServletContextåœ¨å¯åŠ¨æ—¶è‡ªåŠ¨è°ƒç”¨initæ–¹æ³•åˆ›å»º</li>
<li>FruitServletæ˜¯è¢«DispatcherServletè°ƒç”¨çš„ï¼Œä¸åœ¨æ˜¯ä¸€ä¸ªSevletç»„ä»¶ï¼ŒServletContextæ²¡æœ‰è¢«åˆ›å»º</li>
<li>åœ¨æ§åˆ¶å™¨è‡ªå®šä¹‰setServletContextæ–¹æ³•</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä¹‹å‰FruitServletæ˜¯ä¸€ä¸ªSevletç»„ä»¶ï¼Œé‚£ä¹ˆå…¶ä¸­çš„initæ–¹æ³•ä¸€å®šä¼šè¢«è°ƒç”¨ ï¼Œåˆ›å»ºServletContext</span></span><br><span class="line"><span class="comment">//ä¹‹å‰çš„initæ–¹æ³•å†…éƒ¨ä¼šå‡ºç°ä¸€å¥è¯ï¼šsuper.init();</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FruitController</span> <span class="keyword">extends</span> <span class="title class_">ViewBaseServlet</span> &#123;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">private</span> ServletContext servletContext ;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setServletContext</span><span class="params">(ServletContext servletContext)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">    <span class="built_in">this</span>.servletContext = servletContext;</span><br><span class="line">    <span class="built_in">super</span>.init(servletContext);  <span class="comment">//å°†servletContextä¼ ViewBaseServletï¼Œthyemleafä¸ºäº†æ¸²æŸ“æ•°æ®åˆ°ç½‘é¡µ</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>DispatcherServletæ˜¯ä¸€ä¸ªSevletç»„ä»¶ï¼Œåœ¨è¿™é‡Œå¯ä»¥å¾—åˆ°ServletContextï¼Œé€šè¿‡è°ƒç”¨setServletContextMethodä¼ ç»™æ§åˆ¶å™¨</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">                    <span class="type">Class</span> <span class="variable">controllerBeanClass</span> <span class="operator">=</span> Class.forName(className);</span><br><span class="line">                    <span class="type">Object</span> <span class="variable">beanObj</span> <span class="operator">=</span> controllerBeanClass.newInstance() ; </span><br><span class="line"><span class="type">Method</span> <span class="variable">setServletContextMethod</span> <span class="operator">=</span> controllerBeanClass.getDeclaredMethod(<span class="string">&quot;setServletContext&quot;</span>,ServletContext.class);<span class="comment">//æ–¹æ³•å ï¼Œå‚æ•°</span></span><br><span class="line">                    setServletContextMethod.invoke(beanObj , <span class="built_in">this</span>.getServletContext());</span><br></pre></td></tr></table></figure>





<h2 id="æ°´æœç³»ç»Ÿ-ä¼˜åŒ–2-5"><a href="#æ°´æœç³»ç»Ÿ-ä¼˜åŒ–2-5" class="headerlink" title="æ°´æœç³»ç»Ÿ-ä¼˜åŒ–2.5"></a>æ°´æœç³»ç»Ÿ-ä¼˜åŒ–2.5</h2><h3 id="DispatcherServlet-1"><a href="#DispatcherServlet-1" class="headerlink" title="DispatcherServlet"></a>DispatcherServlet</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;*.do&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DispatcherServlet</span> <span class="keyword">extends</span> <span class="title class_">ViewBaseServlet</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String,Object&gt; beanMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">DispatcherServlet</span><span class="params">()</span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">        <span class="built_in">super</span>.init();  <span class="comment">//è°ƒç”¨ViewBaseServletæ–¹æ³•è¿›è¡Œåˆå§‹åŒ–ï¼Œä¸ºäº†æ¸²æŸ“æ•°æ®å’Œé‡å®šå‘</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> getClass().getClassLoader().getResourceAsStream(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">            <span class="comment">//1.åˆ›å»ºDocumentBuilderFactory</span></span><br><span class="line">            <span class="type">DocumentBuilderFactory</span> <span class="variable">documentBuilderFactory</span> <span class="operator">=</span> DocumentBuilderFactory.newInstance();</span><br><span class="line">            <span class="comment">//2.åˆ›å»ºDocumentBuilderå¯¹è±¡</span></span><br><span class="line">            <span class="type">DocumentBuilder</span> <span class="variable">documentBuilder</span> <span class="operator">=</span> documentBuilderFactory.newDocumentBuilder() ;</span><br><span class="line">            <span class="comment">//3.åˆ›å»ºDocumentå¯¹è±¡</span></span><br><span class="line">            <span class="type">Document</span> <span class="variable">document</span> <span class="operator">=</span> documentBuilder.parse(inputStream);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//4.è·å–æ‰€æœ‰çš„beanèŠ‚ç‚¹</span></span><br><span class="line">            <span class="type">NodeList</span> <span class="variable">beanNodeList</span> <span class="operator">=</span> document.getElementsByTagName(<span class="string">&quot;bean&quot;</span>);</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span> ; i&lt;beanNodeList.getLength() ; i++)&#123;</span><br><span class="line">                <span class="type">Node</span> <span class="variable">beanNode</span> <span class="operator">=</span> beanNodeList.item(i);</span><br><span class="line">                <span class="keyword">if</span>(beanNode.getNodeType() == Node.ELEMENT_NODE)&#123;</span><br><span class="line">                    <span class="type">Element</span> <span class="variable">beanElement</span> <span class="operator">=</span> (Element)beanNode ;</span><br><span class="line">                    <span class="type">String</span> <span class="variable">beanId</span> <span class="operator">=</span>  beanElement.getAttribute(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">                    <span class="type">String</span> <span class="variable">className</span> <span class="operator">=</span> beanElement.getAttribute(<span class="string">&quot;class&quot;</span>);</span><br><span class="line">                    <span class="type">Class</span> <span class="variable">controllerBeanClass</span> <span class="operator">=</span> Class.forName(className);</span><br><span class="line">                    <span class="type">Object</span> <span class="variable">beanObj</span> <span class="operator">=</span> controllerBeanClass.newInstance();</span><br><span class="line"></span><br><span class="line">                    beanMap.put(beanId , beanObj) ;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">//è®¾ç½®ç¼–ç --ç»Ÿä¸€è®¾ç½®ç¼–ç </span></span><br><span class="line">        request.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="type">String</span> <span class="variable">servletPath</span> <span class="operator">=</span> request.getServletPath();</span><br><span class="line">        servletPath = servletPath.substring(<span class="number">1</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">lastDotIndex</span> <span class="operator">=</span> servletPath.lastIndexOf(<span class="string">&quot;.do&quot;</span>) ;</span><br><span class="line">        servletPath = servletPath.substring(<span class="number">0</span>,lastDotIndex);</span><br><span class="line"></span><br><span class="line">        <span class="type">Object</span> <span class="variable">controllerBeanObj</span> <span class="operator">=</span> beanMap.get(servletPath);</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">operate</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;operate&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(StringUtil.isEmpty(operate))&#123;</span><br><span class="line">            operate = <span class="string">&quot;index&quot;</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">		<span class="comment">//operateå’Œæ–¹æ³•åä¸€æ ·ï¼Œæ‰€ä»¥é€šè¿‡åå°„è·å–</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> controllerBeanObj.getClass().getDeclaredMethod(operate,HttpServletRequest.class);</span><br><span class="line">            <span class="keyword">if</span>(method!=<span class="literal">null</span>)&#123;</span><br><span class="line">                method.setAccessible(<span class="literal">true</span>); <span class="comment">//ä½¿å…¶å¯è®¿é—®</span></span><br><span class="line">                <span class="comment">//è°ƒç”¨åå¾—åˆ°è¿”å›å€¼ï¼Œè¿›è¡Œè§£æï¼Œå¯çŸ¥æ˜¯æœåŠ¡å™¨è¿˜æ˜¯å®¢æˆ·ç«¯è½¬å‘</span></span><br><span class="line">                <span class="type">Object</span> <span class="variable">returnObj</span> <span class="operator">=</span> method.invoke(controllerBeanObj, request);</span><br><span class="line">				<span class="type">String</span> <span class="variable">methodReturnStr</span> <span class="operator">=</span> (String)returnObj;</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span>(methodReturnStr.startsWith(<span class="string">&quot;Redirect:&quot;</span>))&#123;</span><br><span class="line">                    <span class="type">String</span> <span class="variable">redirectStr</span> <span class="operator">=</span> methodReturnStr.substring(<span class="string">&quot;Redirect:&quot;</span>.length());</span><br><span class="line">                    response.sendRedirect(redirectStr);</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="built_in">super</span>.processTemplate(methodReturnStr,request,response);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;operateå€¼éæ³•!&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="FruitController-1"><a href="#FruitController-1" class="headerlink" title="FruitController"></a>FruitController</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FruitController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">FruitDAO</span> <span class="variable">fruitDAO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FruitDAOImpl</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_">update</span><span class="params">(HttpServletRequest request)</span>&#123;</span><br><span class="line">        <span class="comment">//1.è®¾ç½®ç¼–ç  --ä¸­å¤®æ§åˆ¶å™¨ç»Ÿä¸€è®¾ç½®</span></span><br><span class="line">        <span class="comment">//request.setCharacterEncoding(&quot;utf-8&quot;);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.è·å–å‚æ•°</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">fidStr</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;fid&quot;</span>);</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">fid</span> <span class="operator">=</span> Integer.parseInt(fidStr);</span><br><span class="line">        <span class="type">String</span> <span class="variable">fname</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;fname&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">priceStr</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;price&quot;</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">price</span> <span class="operator">=</span> Integer.parseInt(priceStr);</span><br><span class="line">        <span class="type">String</span> <span class="variable">fcountStr</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;fcount&quot;</span>);</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">fcount</span> <span class="operator">=</span> Integer.parseInt(fcountStr);</span><br><span class="line">        <span class="type">String</span> <span class="variable">remark</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;remark&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.æ‰§è¡Œæ›´æ–°</span></span><br><span class="line">        fruitDAO.updateFruit(<span class="keyword">new</span> <span class="title class_">Fruit</span>(fid,fname, price ,fcount ,remark ));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4.èµ„æºè·³è½¬</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Redirect:fruit.do&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_">edit</span><span class="params">(HttpServletRequest request )</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">fidStr</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;fid&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(StringUtil.isNotEmpty(fidStr))&#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">fid</span> <span class="operator">=</span> Integer.parseInt(fidStr);</span><br><span class="line">            <span class="type">Fruit</span> <span class="variable">fruit</span> <span class="operator">=</span> fruitDAO.getFruitByFid(fid);</span><br><span class="line">            request.setAttribute(<span class="string">&quot;fruit&quot;</span>,fruit);</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;edit&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_">del</span><span class="params">(HttpServletRequest request )</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">fidStr</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;fid&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(StringUtil.isNotEmpty(fidStr))&#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">fid</span> <span class="operator">=</span> Integer.parseInt(fidStr);</span><br><span class="line">            fruitDAO.delFruit(fid);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//super.processTemplate(&quot;index&quot;,request,response);</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Redirect:fruit.do&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_">add</span><span class="params">(HttpServletRequest request)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">fname</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;fname&quot;</span>);</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">price</span> <span class="operator">=</span> Integer.parseInt(request.getParameter(<span class="string">&quot;price&quot;</span>)) ;</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">fcount</span> <span class="operator">=</span> Integer.parseInt(request.getParameter(<span class="string">&quot;fcount&quot;</span>));</span><br><span class="line">        <span class="type">String</span> <span class="variable">remark</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;remark&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Fruit</span> <span class="variable">fruit</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Fruit</span>(<span class="number">0</span>,fname , price , fcount , remark ) ;</span><br><span class="line"></span><br><span class="line">        fruitDAO.addFruit(fruit);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Redirect:fruit.do&quot;</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_">index</span><span class="params">(HttpServletRequest request )</span>&#123;</span><br><span class="line">        <span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> request.getSession() ;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è®¾ç½®å½“å‰é¡µï¼Œé»˜è®¤å€¼1</span></span><br><span class="line">        <span class="type">Integer</span> <span class="variable">pageNo</span> <span class="operator">=</span> <span class="number">1</span> ;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">oper</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;oper&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¦‚æœoper!=null è¯´æ˜ é€šè¿‡è¡¨å•çš„æŸ¥è¯¢æŒ‰é’®ç‚¹å‡»è¿‡æ¥çš„</span></span><br><span class="line">        <span class="comment">//å¦‚æœoperæ˜¯ç©ºçš„ï¼Œè¯´æ˜ ä¸æ˜¯é€šè¿‡è¡¨å•çš„æŸ¥è¯¢æŒ‰é’®ç‚¹å‡»è¿‡æ¥çš„</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">keyword</span> <span class="operator">=</span> <span class="literal">null</span> ;</span><br><span class="line">        <span class="keyword">if</span>(StringUtil.isNotEmpty(oper) &amp;&amp; <span class="string">&quot;search&quot;</span>.equals(oper))&#123;</span><br><span class="line">            <span class="comment">//è¯´æ˜æ˜¯ç‚¹å‡»è¡¨å•æŸ¥è¯¢å‘é€è¿‡æ¥çš„è¯·æ±‚</span></span><br><span class="line">            <span class="comment">//æ­¤æ—¶ï¼ŒpageNoåº”è¯¥è¿˜åŸä¸º1 ï¼Œ keywordåº”è¯¥ä»è¯·æ±‚å‚æ•°ä¸­è·å–</span></span><br><span class="line">            pageNo = <span class="number">1</span> ;</span><br><span class="line">            keyword = request.getParameter(<span class="string">&quot;keyword&quot;</span>);</span><br><span class="line">            <span class="comment">//å¦‚æœkeywordä¸ºnullï¼Œéœ€è¦è®¾ç½®ä¸ºç©ºå­—ç¬¦ä¸²&quot;&quot;ï¼Œå¦åˆ™æŸ¥è¯¢æ—¶ä¼šæ‹¼æ¥æˆ %null% , æˆ‘ä»¬æœŸæœ›çš„æ˜¯ %%</span></span><br><span class="line">            <span class="keyword">if</span>(StringUtil.isEmpty(keyword))&#123;</span><br><span class="line">                keyword = <span class="string">&quot;&quot;</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//å°†keywordä¿å­˜ï¼ˆè¦†ç›–ï¼‰åˆ°sessionä¸­</span></span><br><span class="line">            session.setAttribute(<span class="string">&quot;keyword&quot;</span>,keyword);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">//è¯´æ˜æ­¤å¤„ä¸æ˜¯ç‚¹å‡»è¡¨å•æŸ¥è¯¢å‘é€è¿‡æ¥çš„è¯·æ±‚ï¼ˆæ¯”å¦‚ç‚¹å‡»ä¸‹é¢çš„ä¸Šä¸€é¡µä¸‹ä¸€é¡µæˆ–è€…ç›´æ¥åœ¨åœ°å€æ è¾“å…¥ç½‘å€ï¼‰</span></span><br><span class="line">            <span class="comment">//æ­¤æ—¶keywordåº”è¯¥ä»sessionä½œç”¨åŸŸè·å–</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">pageNoStr</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;pageNo&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span>(StringUtil.isNotEmpty(pageNoStr))&#123;</span><br><span class="line">                pageNo = Integer.parseInt(pageNoStr);   <span class="comment">//å¦‚æœä»è¯·æ±‚ä¸­è¯»å–åˆ°pageNoï¼Œåˆ™ç±»å‹è½¬æ¢ã€‚å¦åˆ™ï¼ŒpageNoé»˜è®¤å°±æ˜¯1</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//å¦‚æœä¸æ˜¯ç‚¹å‡»çš„æŸ¥è¯¢æŒ‰é’®ï¼Œé‚£ä¹ˆæŸ¥è¯¢æ˜¯åŸºäºsessionä¸­ä¿å­˜çš„ç°æœ‰keywordè¿›è¡ŒæŸ¥è¯¢</span></span><br><span class="line">            <span class="type">Object</span> <span class="variable">keywordObj</span> <span class="operator">=</span> session.getAttribute(<span class="string">&quot;keyword&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span>(keywordObj!=<span class="literal">null</span>)&#123;</span><br><span class="line">                keyword = (String)keywordObj ;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                keyword = <span class="string">&quot;&quot;</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// é‡æ–°æ›´æ–°å½“å‰é¡µçš„å€¼</span></span><br><span class="line">        session.setAttribute(<span class="string">&quot;pageNo&quot;</span>,pageNo);</span><br><span class="line"></span><br><span class="line">        <span class="type">FruitDAO</span> <span class="variable">fruitDAO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FruitDAOImpl</span>();</span><br><span class="line">        List&lt;Fruit&gt; fruitList = fruitDAO.getFruitList(keyword , pageNo);</span><br><span class="line">        session.setAttribute(<span class="string">&quot;fruitList&quot;</span>,fruitList);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ€»è®°å½•æ¡æ•°</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">fruitCount</span> <span class="operator">=</span> fruitDAO.getFruitCount(keyword);</span><br><span class="line">        <span class="comment">//æ€»é¡µæ•°</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">pageCount</span> <span class="operator">=</span> (fruitCount+<span class="number">5</span>-<span class="number">1</span>)/<span class="number">5</span> ;</span><br><span class="line"></span><br><span class="line">        session.setAttribute(<span class="string">&quot;pageCount&quot;</span>,pageCount);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="ViewBaseServlet-2"><a href="#ViewBaseServlet-2" class="headerlink" title="ViewBaseServlet"></a>ViewBaseServlet</h3><p>è¿˜åŸå›åŸæœ€åˆä»£ç </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.myssm.myspringmvc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.thymeleaf.TemplateEngine;</span><br><span class="line"><span class="keyword">import</span> org.thymeleaf.context.WebContext;</span><br><span class="line"><span class="keyword">import</span> org.thymeleaf.templatemode.TemplateMode;</span><br><span class="line"><span class="keyword">import</span> org.thymeleaf.templateresolver.ServletContextTemplateResolver;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletContext;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ViewBaseServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> TemplateEngine templateEngine;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 1.è·å–ServletContextå¯¹è±¡</span></span><br><span class="line">        <span class="type">ServletContext</span> <span class="variable">servletContext</span> <span class="operator">=</span> <span class="built_in">this</span>.getServletContext();</span><br><span class="line">        <span class="comment">// 2.åˆ›å»ºThymeleafè§£æå™¨å¯¹è±¡</span></span><br><span class="line">        <span class="type">ServletContextTemplateResolver</span> <span class="variable">templateResolver</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServletContextTemplateResolver</span>(servletContext);</span><br><span class="line">        <span class="comment">// 3.ç»™è§£æå™¨å¯¹è±¡è®¾ç½®å‚æ•°</span></span><br><span class="line">        <span class="comment">// â‘ HTMLæ˜¯é»˜è®¤æ¨¡å¼ï¼Œæ˜ç¡®è®¾ç½®æ˜¯ä¸ºäº†ä»£ç æ›´å®¹æ˜“ç†è§£</span></span><br><span class="line">        templateResolver.setTemplateMode(TemplateMode.HTML);</span><br><span class="line">        <span class="comment">// â‘¡è®¾ç½®å‰ç¼€</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">viewPrefix</span> <span class="operator">=</span> servletContext.getInitParameter(<span class="string">&quot;view-prefix&quot;</span>);</span><br><span class="line">        templateResolver.setPrefix(viewPrefix);</span><br><span class="line">        <span class="comment">// â‘¢è®¾ç½®åç¼€</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">viewSuffix</span> <span class="operator">=</span> servletContext.getInitParameter(<span class="string">&quot;view-suffix&quot;</span>);</span><br><span class="line">        templateResolver.setSuffix(viewSuffix);</span><br><span class="line">        <span class="comment">// â‘£è®¾ç½®ç¼“å­˜è¿‡æœŸæ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</span></span><br><span class="line">        templateResolver.setCacheTTLMs(<span class="number">60000L</span>);</span><br><span class="line">        <span class="comment">// â‘¤è®¾ç½®æ˜¯å¦ç¼“å­˜</span></span><br><span class="line">        templateResolver.setCacheable(<span class="literal">true</span>);</span><br><span class="line">        <span class="comment">// â‘¥è®¾ç½®æœåŠ¡å™¨ç«¯ç¼–ç æ–¹å¼</span></span><br><span class="line">        templateResolver.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">        <span class="comment">// 4.åˆ›å»ºæ¨¡æ¿å¼•æ“å¯¹è±¡</span></span><br><span class="line">        templateEngine = <span class="keyword">new</span> <span class="title class_">TemplateEngine</span>();</span><br><span class="line">        <span class="comment">// 5.ç»™æ¨¡æ¿å¼•æ“å¯¹è±¡è®¾ç½®æ¨¡æ¿è§£æå™¨</span></span><br><span class="line">        templateEngine.setTemplateResolver(templateResolver);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">processTemplate</span><span class="params">(String templateName, HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">// 1.è®¾ç½®å“åº”ä½“å†…å®¹ç±»å‹å’Œå­—ç¬¦é›† --ä¸­å¤®æ§åˆ¶å™¨è®¾ç½®ä¹Ÿå¯ä»¥</span></span><br><span class="line">        resp.setContentType(<span class="string">&quot;text/html;charset=UTF-8&quot;</span>);</span><br><span class="line">        <span class="comment">// 2.åˆ›å»ºWebContextå¯¹è±¡</span></span><br><span class="line">        <span class="type">WebContext</span> <span class="variable">webContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">WebContext</span>(req, resp, <span class="built_in">this</span>.getServletContext());</span><br><span class="line">        <span class="comment">// 3.å¤„ç†æ¨¡æ¿æ•°æ®</span></span><br><span class="line">        templateEngine.process(templateName, webContext, resp.getWriter());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h3><p>ä¼˜åŒ–2.5åœ¨ä¼˜åŒ–2ä¸Šåšå‡ºçš„æ”¹è¿›ï¼Œç›®çš„æ˜¯å°†FruitControllerå’ŒDispatcherServletä½è€¦åˆï¼Œä½¿FruitControllerå°½é‡å˜æˆæ™®é€šçš„ç±»ï¼Œä½¿ä»£ç æ›´åŠ ç®€æ´</p>
<p>æ€è·¯ï¼š</p>
<ul>
<li>DispatcherServletç»§æ‰¿ViewBaseServletï¼Œå®ƒæ¥è°ƒç”¨initï¼ˆï¼‰ï¼Œç»§ç»­å¯¹æ•°æ®çš„æœåŠ¡ç«¯æ•°æ®çš„æ¸²æŸ“å’Œè½¬å‘é‡å®šå‘</li>
<li>DispatcherServletæ¥è¿›è¡Œé‡å®šå‘çš„è°ƒç”¨ï¼Œå³è¦æ±‚æ§åˆ¶å™¨ç›¸å…³åŠŸèƒ½æ–¹æ³•è¿”å›å­—ç¬¦ä¸²ï¼ˆä»£è¡¨æœåŠ¡ç«¯æˆ–å®¢æˆ·ç«¯è½¬å‘ï¼‰</li>
</ul>
<h2 id="æ°´æœç³»ç»Ÿ-ä¼˜åŒ–3"><a href="#æ°´æœç³»ç»Ÿ-ä¼˜åŒ–3" class="headerlink" title="æ°´æœç³»ç»Ÿ-ä¼˜åŒ–3"></a>æ°´æœç³»ç»Ÿ-ä¼˜åŒ–3</h2><h3 id="DispatcherServlet-2"><a href="#DispatcherServlet-2" class="headerlink" title="DispatcherServlet"></a>DispatcherServlet</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;*.do&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DispatcherServlet</span> <span class="keyword">extends</span> <span class="title class_">ViewBaseServlet</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String,Object&gt; beanMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">DispatcherServlet</span><span class="params">()</span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">        <span class="built_in">super</span>.init();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> getClass().getClassLoader().getResourceAsStream(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">            <span class="comment">//1.åˆ›å»ºDocumentBuilderFactory</span></span><br><span class="line">            <span class="type">DocumentBuilderFactory</span> <span class="variable">documentBuilderFactory</span> <span class="operator">=</span> DocumentBuilderFactory.newInstance();</span><br><span class="line">            <span class="comment">//2.åˆ›å»ºDocumentBuilderå¯¹è±¡</span></span><br><span class="line">            <span class="type">DocumentBuilder</span> <span class="variable">documentBuilder</span> <span class="operator">=</span> documentBuilderFactory.newDocumentBuilder() ;</span><br><span class="line">            <span class="comment">//3.åˆ›å»ºDocumentå¯¹è±¡</span></span><br><span class="line">            <span class="type">Document</span> <span class="variable">document</span> <span class="operator">=</span> documentBuilder.parse(inputStream);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//4.è·å–æ‰€æœ‰çš„beanèŠ‚ç‚¹</span></span><br><span class="line">            <span class="type">NodeList</span> <span class="variable">beanNodeList</span> <span class="operator">=</span> document.getElementsByTagName(<span class="string">&quot;bean&quot;</span>);</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span> ; i&lt;beanNodeList.getLength() ; i++)&#123;</span><br><span class="line">                <span class="type">Node</span> <span class="variable">beanNode</span> <span class="operator">=</span> beanNodeList.item(i);</span><br><span class="line">                <span class="keyword">if</span>(beanNode.getNodeType() == Node.ELEMENT_NODE)&#123;</span><br><span class="line">                    <span class="type">Element</span> <span class="variable">beanElement</span> <span class="operator">=</span> (Element)beanNode ;</span><br><span class="line">                    <span class="type">String</span> <span class="variable">beanId</span> <span class="operator">=</span>  beanElement.getAttribute(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">                    <span class="type">String</span> <span class="variable">className</span> <span class="operator">=</span> beanElement.getAttribute(<span class="string">&quot;class&quot;</span>);</span><br><span class="line">                    <span class="type">Class</span> <span class="variable">controllerBeanClass</span> <span class="operator">=</span> Class.forName(className);</span><br><span class="line">                    <span class="type">Object</span> <span class="variable">beanObj</span> <span class="operator">=</span> controllerBeanClass.newInstance() ;</span><br><span class="line">                    beanMap.put(beanId , beanObj) ;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">//è®¾ç½®ç¼–ç </span></span><br><span class="line">        request.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="type">String</span> <span class="variable">servletPath</span> <span class="operator">=</span> request.getServletPath();</span><br><span class="line">        servletPath = servletPath.substring(<span class="number">1</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">lastDotIndex</span> <span class="operator">=</span> servletPath.lastIndexOf(<span class="string">&quot;.do&quot;</span>) ;</span><br><span class="line">        servletPath = servletPath.substring(<span class="number">0</span>,lastDotIndex);</span><br><span class="line"></span><br><span class="line">        <span class="type">Object</span> <span class="variable">controllerBeanObj</span> <span class="operator">=</span> beanMap.get(servletPath);</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">operate</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;operate&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(StringUtil.isEmpty(operate))&#123;</span><br><span class="line">            operate = <span class="string">&quot;index&quot;</span> ;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Method[] methods = controllerBeanObj.getClass().getDeclaredMethods();</span><br><span class="line">            <span class="keyword">for</span>(Method method : methods)&#123;</span><br><span class="line">                <span class="keyword">if</span>(operate.equals(method.getName()))&#123;</span><br><span class="line">                    <span class="comment">//1.ç»Ÿä¸€è·å–è¯·æ±‚å‚æ•°</span></span><br><span class="line"></span><br><span class="line">                    <span class="comment">//1-1.è·å–å½“å‰æ–¹æ³•çš„å‚æ•°ï¼Œè¿”å›å‚æ•°æ•°ç»„</span></span><br><span class="line">                    Parameter[] parameters = method.getParameters();</span><br><span class="line">                    <span class="comment">//1-2.parameterValues ç”¨æ¥æ‰¿è½½å‚æ•°çš„å€¼</span></span><br><span class="line">                    Object[] parameterValues = <span class="keyword">new</span> <span class="title class_">Object</span>[parameters.length];</span><br><span class="line">                    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; parameters.length; i++) &#123;</span><br><span class="line">                        <span class="type">Parameter</span> <span class="variable">parameter</span> <span class="operator">=</span> parameters[i];</span><br><span class="line">                        <span class="type">String</span> <span class="variable">parameterName</span> <span class="operator">=</span> parameter.getName() ;</span><br><span class="line">                        <span class="comment">//å¦‚æœå‚æ•°åæ˜¯request,response,session é‚£ä¹ˆå°±ä¸æ˜¯é€šè¿‡è¯·æ±‚ä¸­è·å–å‚æ•°çš„æ–¹å¼äº†</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="string">&quot;request&quot;</span>.equals(parameterName))&#123;</span><br><span class="line">                            parameterValues[i] = request ;</span><br><span class="line">                        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">&quot;response&quot;</span>.equals(parameterName))&#123;</span><br><span class="line">                            parameterValues[i] = response ;</span><br><span class="line">                        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">&quot;session&quot;</span>.equals(parameterName))&#123;</span><br><span class="line">                            parameterValues[i] = request.getSession() ;</span><br><span class="line">                        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                            <span class="comment">//ä»è¯·æ±‚ä¸­è·å–å‚æ•°å€¼</span></span><br><span class="line">                            <span class="type">String</span> <span class="variable">parameterValue</span> <span class="operator">=</span> request.getParameter(parameterName);</span><br><span class="line">                            <span class="type">String</span> <span class="variable">typeName</span> <span class="operator">=</span> parameter.getType().getName();</span><br><span class="line"></span><br><span class="line">                            <span class="type">Object</span> <span class="variable">parameterObj</span> <span class="operator">=</span> parameterValue ;</span><br><span class="line"></span><br><span class="line">                            <span class="keyword">if</span>(parameterObj!=<span class="literal">null</span>) &#123; <span class="comment">//è¯¥é¡¹ç›®åªæ¶‰åŠIntegerå’ŒStringç±»å‹</span></span><br><span class="line">                                <span class="keyword">if</span> (<span class="string">&quot;java.lang.Integer&quot;</span>.equals(typeName)) &#123;</span><br><span class="line">                                    parameterObj = Integer.parseInt(parameterValue);</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                            parameterValues[i] = parameterObj ;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">//2.controllerç»„ä»¶ä¸­çš„æ–¹æ³•è°ƒç”¨</span></span><br><span class="line">                    method.setAccessible(<span class="literal">true</span>);</span><br><span class="line">                    <span class="type">Object</span> <span class="variable">returnObj</span> <span class="operator">=</span> method.invoke(controllerBeanObj,parameterValues);</span><br><span class="line"></span><br><span class="line">                    <span class="comment">//3.è§†å›¾å¤„ç†</span></span><br><span class="line">                    <span class="type">String</span> <span class="variable">methodReturnStr</span> <span class="operator">=</span> (String)returnObj ;</span><br><span class="line">                    <span class="keyword">if</span>(methodReturnStr.startsWith(<span class="string">&quot;redirect:&quot;</span>))&#123;        <span class="comment">//æ¯”å¦‚ï¼š  redirect:fruit.do</span></span><br><span class="line">                        <span class="type">String</span> <span class="variable">redirectStr</span> <span class="operator">=</span> methodReturnStr.substring(<span class="string">&quot;redirect:&quot;</span>.length());</span><br><span class="line">                        response.sendRedirect(redirectStr);</span><br><span class="line">                    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                        <span class="built_in">super</span>.processTemplate(methodReturnStr,request,response);    <span class="comment">// æ¯”å¦‚ï¼š  &quot;edit&quot;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">            &#125;else&#123;</span></span><br><span class="line"><span class="comment">                throw new RuntimeException(&quot;operateå€¼éæ³•!&quot;);</span></span><br><span class="line"><span class="comment">            &#125;</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InvocationTargetException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å¸¸è§é”™è¯¯ï¼š IllegalArgumentException: argument type mismatch</span></span><br></pre></td></tr></table></figure>



<h3 id="FruitController-2"><a href="#FruitController-2" class="headerlink" title="FruitController"></a>FruitController</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FruitController</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">FruitDAO</span> <span class="variable">fruitDAO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FruitDAOImpl</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_">update</span><span class="params">(Integer fid , String fname , Integer price , Integer fcount , String remark )</span>&#123;</span><br><span class="line">        <span class="comment">//3.æ‰§è¡Œæ›´æ–°</span></span><br><span class="line">        fruitDAO.updateFruit(<span class="keyword">new</span> <span class="title class_">Fruit</span>(fid,fname, price ,fcount ,remark ));</span><br><span class="line">        <span class="comment">//4.èµ„æºè·³è½¬</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;redirect:fruit.do&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_">edit</span><span class="params">(Integer fid , HttpServletRequest request)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(fid!=<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="type">Fruit</span> <span class="variable">fruit</span> <span class="operator">=</span> fruitDAO.getFruitByFid(fid);</span><br><span class="line">            request.setAttribute(<span class="string">&quot;fruit&quot;</span>,fruit);</span><br><span class="line">            <span class="comment">//super.processTemplate(&quot;edit&quot;,request,response);</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;edit&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;error&quot;</span> ;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_">del</span><span class="params">(Integer fid  )</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(fid!=<span class="literal">null</span>)&#123;</span><br><span class="line">            fruitDAO.delFruit(fid);</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;redirect:fruit.do&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;error&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_">add</span><span class="params">(String fname , Integer price , Integer fcount , String remark )</span> &#123;</span><br><span class="line">        <span class="type">Fruit</span> <span class="variable">fruit</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Fruit</span>(<span class="number">0</span>,fname , price , fcount , remark ) ;</span><br><span class="line">        fruitDAO.addFruit(fruit);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;redirect:fruit.do&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_">index</span><span class="params">(String oper , String keyword , Integer pageNo , HttpServletRequest request )</span> &#123;</span><br><span class="line">        <span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> request.getSession() ;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(pageNo==<span class="literal">null</span>)&#123;</span><br><span class="line">            pageNo = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(StringUtil.isNotEmpty(oper) &amp;&amp; <span class="string">&quot;search&quot;</span>.equals(oper))&#123;</span><br><span class="line">            pageNo = <span class="number">1</span> ;</span><br><span class="line">            <span class="keyword">if</span>(StringUtil.isEmpty(keyword))&#123;</span><br><span class="line">                keyword = <span class="string">&quot;&quot;</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">            session.setAttribute(<span class="string">&quot;keyword&quot;</span>,keyword);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="type">Object</span> <span class="variable">keywordObj</span> <span class="operator">=</span> session.getAttribute(<span class="string">&quot;keyword&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span>(keywordObj!=<span class="literal">null</span>)&#123;</span><br><span class="line">                keyword = (String)keywordObj ;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                keyword = <span class="string">&quot;&quot;</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é‡æ–°æ›´æ–°å½“å‰é¡µçš„å€¼</span></span><br><span class="line">        session.setAttribute(<span class="string">&quot;pageNo&quot;</span>,pageNo);</span><br><span class="line"></span><br><span class="line">        <span class="type">FruitDAO</span> <span class="variable">fruitDAO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FruitDAOImpl</span>();</span><br><span class="line">        List&lt;Fruit&gt; fruitList = fruitDAO.getFruitList(keyword , pageNo);</span><br><span class="line">        session.setAttribute(<span class="string">&quot;fruitList&quot;</span>,fruitList);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ€»è®°å½•æ¡æ•°</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">fruitCount</span> <span class="operator">=</span> fruitDAO.getFruitCount(keyword);</span><br><span class="line">        <span class="comment">//æ€»é¡µæ•°</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">pageCount</span> <span class="operator">=</span> (fruitCount+<span class="number">5</span>-<span class="number">1</span>)/<span class="number">5</span> ;</span><br><span class="line">        session.setAttribute(<span class="string">&quot;pageCount&quot;</span>,pageCount);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;index&quot;</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="æ€»ç»“-1"><a href="#æ€»ç»“-1" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>åœ¨ä¼˜åŒ–2.5ä¹‹ä¸Šåšå‡ºæ”¹è¿›ï¼Œå°†FruitControllerå’ŒDispatcherServletå®ç°ä½è€¦åˆï¼Œä½¿FruitControllerå˜æˆæ™®é€šçš„ç±»ï¼Œä»£ç å˜å¾—ç®€æ´ï¼Œå°†å†—ä½™çš„æ“ä½œæ”¾åœ¨ä¸­å¤®æ§åˆ¶å™¨DispatcherServletå»æ‰§è¡Œ</p>
<ul>
<li>è·å–å‚æ•°åæ˜¯request,response,session</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="string">&quot;request&quot;</span>.equals(parameterName))&#123;</span><br><span class="line">                      parameterValues[i] = request ;</span><br><span class="line">                  &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">&quot;response&quot;</span>.equals(parameterName))&#123;</span><br><span class="line">                      parameterValues[i] = response ;</span><br><span class="line">                  &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">&quot;session&quot;</span>.equals(parameterName))&#123;</span><br><span class="line">                      parameterValues[i] = request.getSession() ;</span><br><span class="line">                  &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>è·å–è¯·æ±‚requestä¸­å‚æ•°</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">parameterValue</span> <span class="operator">=</span> request.getParameter(parameterName); <span class="comment">//æ ¹æ®å‚æ•°åè·å–å‚æ•°å€¼</span></span><br><span class="line">         <span class="type">String</span> <span class="variable">typeName</span> <span class="operator">=</span> parameter.getType().getName(); <span class="comment">//è·å–å‚æ•°ç±»å‹å</span></span><br><span class="line">         <span class="type">Object</span> <span class="variable">parameterObj</span> <span class="operator">=</span> parameterValue ;</span><br><span class="line"></span><br><span class="line">           <span class="keyword">if</span>(parameterObj!=<span class="literal">null</span>) &#123; <span class="comment">//è¯¥é¡¹ç›®åªæ¶‰åŠIntegerå’ŒStringç±»å‹</span></span><br><span class="line">                <span class="keyword">if</span> (<span class="string">&quot;java.lang.Integer&quot;</span>.equals(typeName)) &#123;<span class="comment">//å°†Stringç±»å‹çš„è½¬ä¸ºIntegerç±»å‹</span></span><br><span class="line">                       parameterObj = Integer.parseInt(parameterValue);</span><br><span class="line">                  &#125;</span><br><span class="line">             &#125;</span><br><span class="line">                     parameterValues[i] = parameterObj ; <span class="comment">//æ”¾å…¥å‚æ•°æ•°ç»„</span></span><br><span class="line"> </span><br><span class="line">             <span class="comment">//2.controllerç»„ä»¶ä¸­çš„æ–¹æ³•è°ƒç”¨</span></span><br><span class="line">             method.setAccessible(<span class="literal">true</span>);</span><br><span class="line">             <span class="type">Object</span> <span class="variable">returnObj</span> <span class="operator">=</span> method.invoke(controllerBeanObj,parameterValues);</span><br></pre></td></tr></table></figure>

<ul>
<li>é—®é¢˜ï¼šideaç¼–è¯‘å™¨é»˜è®¤æ˜¯ä¸ç¼–è¯‘å‚æ•°çš„åç§°çš„ï¼Œé»˜è®¤å°†å‚æ•°åç§°å˜ä¸ºarg0ï¼Œarg1ï¼Œarg2â€¦â€¦..</li>
</ul>
<p>å¯åœ¨settingè®¾ç½®ä¸­è¿›è¡Œä¿®æ”¹ç¼–è¯‘å™¨çš„ç¼–è¯‘ä¿¡æ¯ï¼Œå°†å‚æ•°åç§°æ·»åŠ åˆ°ç¼–è¯‘ä¸­</p>
<p><img src="/2022/09/30/JavaWeb/image-20220705231754207.png" alt="image-20220705231754207"></p>
<h2 id="å¤ä¹ æ€»ç»“"><a href="#å¤ä¹ æ€»ç»“" class="headerlink" title="å¤ä¹ æ€»ç»“"></a>å¤ä¹ æ€»ç»“</h2><p>review:</p>
<ol>
<li>æœ€åˆçš„åšæ³•æ˜¯ï¼š ä¸€ä¸ªè¯·æ±‚å¯¹åº”ä¸€ä¸ªServletï¼Œè¿™æ ·å­˜åœ¨çš„é—®é¢˜æ˜¯servletå¤ªå¤šäº†</li>
<li>æŠŠä¸€äº›åˆ—çš„è¯·æ±‚éƒ½å¯¹åº”ä¸€ä¸ªServletï¼Œ<br>IndexServlet&#x2F;AddServlet&#x2F;EditServlet&#x2F;DelServlet&#x2F;UpdateServlet -&gt; åˆå¹¶æˆFruitServlet<br>é€šè¿‡ä¸€ä¸ªoperateçš„å€¼æ¥å†³å®šè°ƒç”¨FruitServletä¸­çš„å“ªä¸€ä¸ªæ–¹æ³•<br>ä½¿ç”¨çš„æ˜¯switch-case</li>
<li>åœ¨ä¸Šä¸€ä¸ªç‰ˆæœ¬ä¸­ï¼ŒServletä¸­å……æ–¥ç€å¤§é‡çš„switch-caseï¼Œè¯•æƒ³ä¸€ä¸‹ï¼Œéšç€æˆ‘ä»¬çš„é¡¹ç›®çš„ä¸šåŠ¡è§„æ¨¡æ‰©å¤§ï¼Œé‚£ä¹ˆä¼šæœ‰å¾ˆå¤šçš„Servletï¼Œä¹Ÿå°±æ„å‘³ç€ä¼šæœ‰å¾ˆå¤šçš„switch-caseï¼Œè¿™æ˜¯ä¸€ç§ä»£ç å†—ä½™<br>å› æ­¤ï¼Œæˆ‘ä»¬åœ¨servletä¸­ä½¿ç”¨äº†åå°„æŠ€æœ¯ï¼Œæˆ‘ä»¬è§„å®šoperateçš„å€¼å’Œæ–¹æ³•åä¸€è‡´ï¼Œé‚£ä¹ˆæ¥æ”¶åˆ°operateçš„å€¼æ˜¯ä»€ä¹ˆå°±è¡¨æ˜æˆ‘ä»¬éœ€è¦è°ƒç”¨å¯¹åº”çš„æ–¹æ³•è¿›è¡Œå“åº”ï¼Œå¦‚æœæ‰¾ä¸åˆ°å¯¹åº”çš„æ–¹æ³•ï¼Œåˆ™æŠ›å¼‚å¸¸</li>
<li>åœ¨ä¸Šä¸€ä¸ªç‰ˆæœ¬ä¸­æˆ‘ä»¬ä½¿ç”¨äº†åå°„æŠ€æœ¯ï¼Œä½†æ˜¯å…¶å®è¿˜æ˜¯å­˜åœ¨ä¸€å®šçš„é—®é¢˜ï¼šæ¯ä¸€ä¸ªservletä¸­éƒ½æœ‰ç±»ä¼¼çš„åå°„æŠ€æœ¯çš„ä»£ç ã€‚å› æ­¤ç»§ç»­æŠ½å–ï¼Œè®¾è®¡äº†ä¸­å¤®æ§åˆ¶å™¨ç±»ï¼šDispatcherServlet<br>DispatcherServletè¿™ä¸ªç±»çš„å·¥ä½œåˆ†ä¸ºä¸¤å¤§éƒ¨åˆ†ï¼š<br>1.æ ¹æ®urlå®šä½åˆ°èƒ½å¤Ÿå¤„ç†è¿™ä¸ªè¯·æ±‚çš„controllerç»„ä»¶ï¼š<br> 1)ä»urlä¸­æå–servletPath : &#x2F;fruit.do -&gt; fruit<br> 2)æ ¹æ®fruitæ‰¾åˆ°å¯¹åº”çš„ç»„ä»¶:FruitController ï¼Œ è¿™ä¸ªå¯¹åº”çš„ä¾æ®æˆ‘ä»¬å­˜å‚¨åœ¨applicationContext.xmlä¸­<br>   &lt;bean id&#x3D;â€fruitâ€ class&#x3D;â€com.atguigu.fruit.controllers.FruitController&#x2F;&gt;<br>   é€šè¿‡DOMæŠ€æœ¯æˆ‘ä»¬å»è§£æXMLæ–‡ä»¶ï¼Œåœ¨ä¸­å¤®æ§åˆ¶å™¨ä¸­å½¢æˆä¸€ä¸ªbeanMapå®¹å™¨ï¼Œç”¨æ¥å­˜æ”¾æ‰€æœ‰çš„Controllerç»„ä»¶<br> 3)æ ¹æ®è·å–åˆ°çš„operateçš„å€¼å®šä½åˆ°æˆ‘ä»¬FruitControllerä¸­éœ€è¦è°ƒç”¨çš„æ–¹æ³•<br>2.è°ƒç”¨Controllerç»„ä»¶ä¸­çš„æ–¹æ³•ï¼š<ol>
<li>è·å–å‚æ•°<br>è·å–å³å°†è¦è°ƒç”¨çš„æ–¹æ³•çš„å‚æ•°ç­¾åä¿¡æ¯: Parameter[] parameters &#x3D; method.getParameters();<br>é€šè¿‡parameter.getName()è·å–å‚æ•°çš„åç§°ï¼›<br>å‡†å¤‡äº†Object[] parameterValues è¿™ä¸ªæ•°ç»„ç”¨æ¥å­˜æ”¾å¯¹åº”å‚æ•°çš„å‚æ•°å€¼<br>å¦å¤–ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘å‚æ•°çš„ç±»å‹é—®é¢˜ï¼Œéœ€è¦åšç±»å‹è½¬åŒ–çš„å·¥ä½œã€‚é€šè¿‡parameter.getType()è·å–å‚æ•°çš„ç±»å‹</li>
<li>æ‰§è¡Œæ–¹æ³•<br>Object returnObj &#x3D; method.invoke(controllerBean , parameterValues);</li>
<li>è§†å›¾å¤„ç†<br>String returnStr &#x3D; (String)returnObj;<br>if(returnStr.startWith(â€œredirect:â€)){<br> â€¦.<br>}else ifâ€¦..</li>
</ol>
</li>
</ol>
<h1 id="å†æ¬¡å­¦ä¹ Servletçš„åˆå§‹åŒ–æ–¹æ³•"><a href="#å†æ¬¡å­¦ä¹ Servletçš„åˆå§‹åŒ–æ–¹æ³•" class="headerlink" title="å†æ¬¡å­¦ä¹ Servletçš„åˆå§‹åŒ–æ–¹æ³•"></a>å†æ¬¡å­¦ä¹ Servletçš„åˆå§‹åŒ–æ–¹æ³•</h1><ol>
<li>Servletç”Ÿå‘½å‘¨æœŸï¼šå®ä¾‹åŒ–ã€åˆå§‹åŒ–ã€æœåŠ¡ã€é”€æ¯</li>
</ol>
<ol start="2">
<li>Servletä¸­çš„åˆå§‹åŒ–æ–¹æ³•æœ‰ä¸¤ä¸ªï¼šinit() , init(config)<br>  å…¶ä¸­å¸¦å‚æ•°çš„æ–¹æ³•ä»£ç å¦‚ä¸‹ï¼š <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(ServletConfig config)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line"><span class="built_in">this</span>.config = config ;</span><br><span class="line">init();</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
  å¦å¤–ä¸€ä¸ªæ— å‚çš„initæ–¹æ³•å¦‚ä¸‹ï¼š <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> <span class="keyword">throws</span> ServletException&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
  å¦‚æœæˆ‘ä»¬æƒ³è¦åœ¨Servletåˆå§‹åŒ–æ—¶åšä¸€äº›å‡†å¤‡å·¥ä½œï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é‡å†™initæ–¹æ³•<br>  æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹æ­¥éª¤å»è·å–åˆå§‹åŒ–è®¾ç½®çš„æ•°æ®</li>
</ol>
<ul>
<li>è·å–configå¯¹è±¡ï¼šServletConfig config &#x3D; getServletConfig();</li>
<li>è·å–åˆå§‹åŒ–å‚æ•°å€¼ï¼š config.getInitParameter(key);</li>
</ul>
<ol start="3">
<li><p>åœ¨web.xmlæ–‡ä»¶ä¸­é…ç½®Servlet</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>Demo01Servlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.atguigu.servlet.Demo01Servlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>world<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>uname<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>jim<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>Demo01Servlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/demo01<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>


</li>
<li><p>ä¹Ÿå¯ä»¥é€šè¿‡æ³¨è§£çš„æ–¹å¼è¿›è¡Œé…ç½®ï¼š</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(urlPatterns = &#123;&quot;/demo01&quot;&#125; ,</span></span><br><span class="line"><span class="meta">initParams = &#123;</span></span><br><span class="line"><span class="meta">    @WebInitParam(name=&quot;hello&quot;,value=&quot;world&quot;),</span></span><br><span class="line"><span class="meta">    @WebInitParam(name=&quot;uname&quot;,value=&quot;jim&quot;)</span></span><br><span class="line"><span class="meta">&#125;)</span></span><br></pre></td></tr></table></figure></li>
</ol>
<ol start="5">
<li>å­¦ä¹ Servletä¸­çš„ServletContextå’Œ<context-param></context-param></li>
</ol>
<ul>
<li><p>è·å–ServletContextï¼Œæœ‰å¾ˆå¤šæ–¹æ³•<br>åœ¨åˆå§‹åŒ–æ–¹æ³•ä¸­ï¼š ServletContxt servletContext &#x3D; getServletContext();<br>åœ¨æœåŠ¡æ–¹æ³•ä¸­ä¹Ÿå¯ä»¥é€šè¿‡requestå¯¹è±¡è·å–ï¼Œä¹Ÿå¯ä»¥é€šè¿‡sessionè·å–ï¼š<br>request.getServletContext(); session.getServletContext()</p>
</li>
<li><p>è·å–åˆå§‹åŒ–å€¼ï¼š<br>servletContext.getInitParameter();</p>
</li>
</ul>
<h1 id="ä¸šåŠ¡å±‚"><a href="#ä¸šåŠ¡å±‚" class="headerlink" title="ä¸šåŠ¡å±‚"></a>ä¸šåŠ¡å±‚</h1><h2 id="MVCæ¦‚å¿µè§£é‡Š"><a href="#MVCæ¦‚å¿µè§£é‡Š" class="headerlink" title="MVCæ¦‚å¿µè§£é‡Š"></a>MVCæ¦‚å¿µè§£é‡Š</h2><p>MVC : Modelï¼ˆæ¨¡å‹ï¼‰ã€Viewï¼ˆè§†å›¾ï¼‰ã€Controllerï¼ˆæ§åˆ¶å™¨ï¼‰</p>
<ul>
<li>è§†å›¾å±‚ï¼šç”¨äºåšæ•°æ®å±•ç¤ºä»¥åŠå’Œç”¨æˆ·äº¤äº’çš„ä¸€ä¸ªç•Œé¢</li>
<li>æ§åˆ¶å±‚ï¼šèƒ½å¤Ÿæ¥å—å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œå…·ä½“çš„ä¸šåŠ¡åŠŸèƒ½è¿˜æ˜¯éœ€è¦å€ŸåŠ©äºæ¨¡å‹ç»„ä»¶æ¥å®Œæˆ</li>
<li>æ¨¡å‹å±‚ï¼šæ¨¡å‹åˆ†ä¸ºå¾ˆå¤šç§ï¼š<ul>
<li>æ•°æ®è®¿é—®æ¨¡å‹ï¼ˆDAOï¼‰</li>
<li>ä¸šåŠ¡é€»è¾‘æ¨¡å‹ï¼ˆBOï¼‰</li>
<li>å€¼å¯¹è±¡æ¨¡å‹ï¼ˆPOJO&#x2F;vo(value object)ï¼‰</li>
<li>æ•°æ®ä¼ è¾“å¯¹è±¡ï¼ˆDTOï¼‰</li>
</ul>
</li>
</ul>
<h2 id="åŒºåˆ†ä¸šåŠ¡å¯¹è±¡å’Œæ•°æ®è®¿é—®å¯¹è±¡"><a href="#åŒºåˆ†ä¸šåŠ¡å¯¹è±¡å’Œæ•°æ®è®¿é—®å¯¹è±¡" class="headerlink" title="åŒºåˆ†ä¸šåŠ¡å¯¹è±¡å’Œæ•°æ®è®¿é—®å¯¹è±¡"></a>åŒºåˆ†ä¸šåŠ¡å¯¹è±¡å’Œæ•°æ®è®¿é—®å¯¹è±¡</h2><p>1ï¼‰ DAOä¸­çš„æ–¹æ³•éƒ½æ˜¯å•ç²¾åº¦æ–¹æ³•æˆ–è€…ç§°ä¹‹ä¸ºç»†ç²’åº¦æ–¹æ³•ã€‚ä»€ä¹ˆå«å•ç²¾åº¦ï¼Ÿä¸€ä¸ªæ–¹æ³•åªè€ƒè™‘ä¸€ä¸ªæ“ä½œï¼Œæ¯”å¦‚æ·»åŠ ï¼Œé‚£å°±æ˜¯insertæ“ä½œã€æŸ¥è¯¢é‚£å°±æ˜¯selectæ“ä½œâ€¦.<br>2ï¼‰ BOä¸­çš„æ–¹æ³•å±äºä¸šåŠ¡æ–¹æ³•ï¼Œä¹Ÿå®é™…çš„ä¸šåŠ¡æ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼Œå› æ­¤ä¸šåŠ¡æ–¹æ³•çš„ç²’åº¦æ˜¯æ¯”è¾ƒç²—çš„</p>
<p>ä¸¾ä¾‹ï¼š</p>
<ul>
<li><p>æ³¨å†Œè¿™ä¸ªåŠŸèƒ½å±äºä¸šåŠ¡åŠŸèƒ½ï¼Œä¹Ÿå°±æ˜¯è¯´æ³¨å†Œè¿™ä¸ªæ–¹æ³•å±äºä¸šåŠ¡æ–¹æ³•ã€‚é‚£ä¹ˆè¿™ä¸ªä¸šåŠ¡æ–¹æ³•ä¸­åŒ…å«äº†å¤šä¸ªDAOæ–¹æ³•ã€‚ä¹Ÿå°±æ˜¯è¯´æ³¨å†Œè¿™ä¸ªä¸šåŠ¡åŠŸèƒ½éœ€è¦é€šè¿‡å¤šä¸ªDAOæ–¹æ³•çš„ç»„åˆè°ƒç”¨ï¼Œä»è€Œå®Œæˆæ³¨å†ŒåŠŸèƒ½çš„å¼€å‘ã€‚</p>
<p>æ³¨å†ŒDAOä¸¾ä¾‹ï¼š</p>
<ul>
<li>æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å·²ç»è¢«æ³¨å†Œ - DAOä¸­çš„selectæ“ä½œ</li>
<li>ç”¨æˆ·è¡¨æ–°å¢ä¸€æ¡æ–°ç”¨æˆ·è®°å½• - DAOä¸­çš„insertæ“ä½œ</li>
<li>å‘ç”¨æˆ·ç§¯åˆ†è¡¨æ–°å¢ä¸€æ¡è®°å½•ï¼ˆæ–°ç”¨æˆ·é»˜è®¤åˆå§‹åŒ–ç§¯åˆ†100åˆ†ï¼‰ - DAOä¸­çš„insertæ“ä½œ</li>
<li>å‘ç³»ç»Ÿæ¶ˆæ¯è¡¨æ–°å¢ä¸€æ¡è®°å½•ï¼ˆæŸæŸæŸæ–°ç”¨æˆ·æ³¨å†Œäº†ï¼Œéœ€è¦æ ¹æ®é€šè®¯å½•ä¿¡æ¯å‘ä»–çš„è”ç³»äººæ¨é€æ¶ˆæ¯ï¼‰ - DAOä¸­çš„insertæ“ä½œ</li>
<li>å‘ç³»ç»Ÿæ—¥å¿—è¡¨æ–°å¢ä¸€æ¡è®°å½•ï¼ˆæŸç”¨æˆ·åœ¨æŸIPåœ¨æŸå¹´æŸæœˆæŸæ—¥æŸæ—¶æŸåˆ†æŸç§’æŸæ¯«ç§’æ³¨å†Œï¼‰ - DAOä¸­çš„insertæ“ä½œ</li>
<li>â€¦.</li>
</ul>
</li>
</ul>
<h1 id="æ°´æœåº“å­˜ç³»ç»Ÿä¸­æ·»åŠ ä¸šåŠ¡å±‚ç»„ä»¶-ä¼˜åŒ–4"><a href="#æ°´æœåº“å­˜ç³»ç»Ÿä¸­æ·»åŠ ä¸šåŠ¡å±‚ç»„ä»¶-ä¼˜åŒ–4" class="headerlink" title="æ°´æœåº“å­˜ç³»ç»Ÿä¸­æ·»åŠ ä¸šåŠ¡å±‚ç»„ä»¶-ä¼˜åŒ–4"></a>æ°´æœåº“å­˜ç³»ç»Ÿä¸­æ·»åŠ ä¸šåŠ¡å±‚ç»„ä»¶-ä¼˜åŒ–4</h1><h2 id="ç®€å›¾1"><a href="#ç®€å›¾1" class="headerlink" title="ç®€å›¾1"></a>ç®€å›¾1</h2><p><img src="/2022/09/30/JavaWeb/image-20220706151602119.png" alt="image-20220706151602119"></p>
<h2 id="ç®€å›¾2"><a href="#ç®€å›¾2" class="headerlink" title="ç®€å›¾2"></a>ç®€å›¾2</h2><p><img src="/2022/09/30/JavaWeb/image-20220706160218945.png" alt="image-20220706160218945"></p>
<blockquote>
<p>å°½ç„¶å‡å°‘è€¦åˆå’Œä¾èµ–ï¼Œä¸‰è€…ä¹‹é—´æœ‰ä¾èµ–å…³ç³»ï¼Œè¿™é‡Œå°†ä¸‰è€…FruitåŠ å…¥åˆ°applicationContexté…ç½®æ–‡ä»¶ä¸­ï¼Œä¾èµ–å…³ç³»ä¹Ÿåœ¨è¿™é‡Œå‘ˆç°ï¼Œæœ€åç”±ClassPathXmlApplictionContextè¿›è¡Œåˆ›å»ºå®ä¾‹å’Œå»ºç«‹ä»–ä»¬çš„ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼ˆå³å¯¹å±æ€§èµ‹å€¼ï¼‰</p>
</blockquote>
<h2 id="applicationContext"><a href="#applicationContext" class="headerlink" title="applicationContext"></a>applicationContext</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;fruitDAO&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.atguigu.fruit.dao.impl.FruitDAOImpl&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;fruitService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.atguigu.fruit.service.impl.FruitServiceImpl&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- propertyæ ‡ç­¾ç”¨æ¥è¡¨ç¤ºå±æ€§ï¼›nameè¡¨ç¤ºå±æ€§åï¼›refè¡¨ç¤ºå¼•ç”¨å…¶ä»–beançš„idå€¼--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;fruitDAO&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;fruitDAO&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;fruit&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.atguigu.fruit.controllers.FruitController&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;fruitService&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;fruitService&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">Node èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">    Element å…ƒç´ èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">    Text æ–‡æœ¬èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">&lt;sname&gt;jim&lt;/sname&gt;</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="ClassPathXmlApplicationContext"><a href="#ClassPathXmlApplicationContext" class="headerlink" title="ClassPathXmlApplicationContext"></a>ClassPathXmlApplicationContext</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ClassPathXmlApplicationContext</span> <span class="keyword">implements</span> <span class="title class_">BeanFactory</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String,Object&gt; beanMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ClassPathXmlApplicationContext</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> getClass().getClassLoader().getResourceAsStream(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">            <span class="comment">//1.åˆ›å»ºDocumentBuilderFactory</span></span><br><span class="line">            <span class="type">DocumentBuilderFactory</span> <span class="variable">documentBuilderFactory</span> <span class="operator">=</span> DocumentBuilderFactory.newInstance();</span><br><span class="line">            <span class="comment">//2.åˆ›å»ºDocumentBuilderå¯¹è±¡</span></span><br><span class="line">            <span class="type">DocumentBuilder</span> <span class="variable">documentBuilder</span> <span class="operator">=</span> documentBuilderFactory.newDocumentBuilder() ;</span><br><span class="line">            <span class="comment">//3.åˆ›å»ºDocumentå¯¹è±¡</span></span><br><span class="line">            <span class="type">Document</span> <span class="variable">document</span> <span class="operator">=</span> documentBuilder.parse(inputStream);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//4.è·å–æ‰€æœ‰çš„beanèŠ‚ç‚¹</span></span><br><span class="line">            <span class="type">NodeList</span> <span class="variable">beanNodeList</span> <span class="operator">=</span> document.getElementsByTagName(<span class="string">&quot;bean&quot;</span>);</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span> ; i&lt;beanNodeList.getLength() ; i++)&#123;</span><br><span class="line">                <span class="type">Node</span> <span class="variable">beanNode</span> <span class="operator">=</span> beanNodeList.item(i);</span><br><span class="line">                <span class="keyword">if</span>(beanNode.getNodeType() == Node.ELEMENT_NODE)&#123;</span><br><span class="line">                    <span class="type">Element</span> <span class="variable">beanElement</span> <span class="operator">=</span> (Element)beanNode ;</span><br><span class="line">                    <span class="type">String</span> <span class="variable">beanId</span> <span class="operator">=</span>  beanElement.getAttribute(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">                    <span class="type">String</span> <span class="variable">className</span> <span class="operator">=</span> beanElement.getAttribute(<span class="string">&quot;class&quot;</span>);</span><br><span class="line">                    <span class="type">Class</span> <span class="variable">beanClass</span> <span class="operator">=</span> Class.forName(className);</span><br><span class="line">                    <span class="comment">//åˆ›å»ºbeanå®ä¾‹</span></span><br><span class="line">                    <span class="type">Object</span> <span class="variable">beanObj</span> <span class="operator">=</span> beanClass.newInstance() ;</span><br><span class="line">                    <span class="comment">//å°†beanå®ä¾‹å¯¹è±¡ä¿å­˜åˆ°mapå®¹å™¨ä¸­</span></span><br><span class="line">                    beanMap.put(beanId , beanObj) ;</span><br><span class="line">                    <span class="comment">//åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæ­¤å¤„éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œbeanå’Œbeanä¹‹é—´çš„ä¾èµ–å…³ç³»è¿˜æ²¡æœ‰è®¾ç½®</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//5.ç»„è£…beanä¹‹é—´çš„ä¾èµ–å…³ç³»</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span> ; i&lt;beanNodeList.getLength() ; i++)&#123;</span><br><span class="line">                <span class="type">Node</span> <span class="variable">beanNode</span> <span class="operator">=</span> beanNodeList.item(i);</span><br><span class="line">                <span class="keyword">if</span>(beanNode.getNodeType() == Node.ELEMENT_NODE) &#123;</span><br><span class="line">                    <span class="type">Element</span> <span class="variable">beanElement</span> <span class="operator">=</span> (Element) beanNode;</span><br><span class="line">                    <span class="type">String</span> <span class="variable">beanId</span> <span class="operator">=</span> beanElement.getAttribute(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">                    <span class="type">NodeList</span> <span class="variable">beanChildNodeList</span> <span class="operator">=</span> beanElement.getChildNodes();</span><br><span class="line">                    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; beanChildNodeList.getLength() ; j++) &#123;</span><br><span class="line">                        <span class="type">Node</span> <span class="variable">beanChildNode</span> <span class="operator">=</span> beanChildNodeList.item(j);</span><br><span class="line">                        <span class="keyword">if</span>(beanChildNode.getNodeType()==Node.ELEMENT_NODE &amp;&amp; <span class="string">&quot;property&quot;</span>.equals(beanChildNode.getNodeName()))&#123;</span><br><span class="line">                            <span class="type">Element</span> <span class="variable">propertyElement</span> <span class="operator">=</span> (Element) beanChildNode;</span><br><span class="line">                            <span class="type">String</span> <span class="variable">propertyName</span> <span class="operator">=</span> propertyElement.getAttribute(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">                            <span class="type">String</span> <span class="variable">propertyRef</span> <span class="operator">=</span> propertyElement.getAttribute(<span class="string">&quot;ref&quot;</span>);</span><br><span class="line">                            <span class="comment">//1) æ‰¾åˆ°propertyRefå¯¹åº”çš„å®ä¾‹</span></span><br><span class="line">                            <span class="type">Object</span> <span class="variable">refObj</span> <span class="operator">=</span> beanMap.get(propertyRef);</span><br><span class="line">                            <span class="comment">//2) å°†refObjè®¾ç½®åˆ°å½“å‰beanå¯¹åº”çš„å®ä¾‹çš„propertyå±æ€§ä¸Šå»</span></span><br><span class="line">                            <span class="type">Object</span> <span class="variable">beanObj</span> <span class="operator">=</span> beanMap.get(beanId);</span><br><span class="line">                            <span class="type">Class</span> <span class="variable">beanClazz</span> <span class="operator">=</span> beanObj.getClass();</span><br><span class="line">                            <span class="type">Field</span> <span class="variable">propertyField</span> <span class="operator">=</span> beanClazz.getDeclaredField(propertyName);</span><br><span class="line">                            propertyField.setAccessible(<span class="literal">true</span>);</span><br><span class="line">                            propertyField.set(beanObj,refObj); <span class="comment">//è®¾ç½®å…¶å±æ€§å€¼ï¼Œå®Œæˆä»–ä»¬çš„ä¾èµ–å…³ç³»</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">getBean</span><span class="params">(String id)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> beanMap.get(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="IOC"><a href="#IOC" class="headerlink" title="IOC"></a>IOC</h1><h2 id="è€¦åˆ-x2F-ä¾èµ–"><a href="#è€¦åˆ-x2F-ä¾èµ–" class="headerlink" title="è€¦åˆ&#x2F;ä¾èµ–"></a>è€¦åˆ&#x2F;ä¾èµ–</h2><p>ä¾èµ–æŒ‡çš„æ˜¯æŸæŸæŸç¦»ä¸å¼€æŸæŸæŸ<br>åœ¨è½¯ä»¶ç³»ç»Ÿä¸­ï¼Œå±‚ä¸å±‚ä¹‹é—´æ˜¯å­˜åœ¨ä¾èµ–çš„ã€‚æˆ‘ä»¬ä¹Ÿç§°ä¹‹ä¸ºè€¦åˆã€‚<br>æˆ‘ä»¬ç³»ç»Ÿæ¶æ„æˆ–è€…æ˜¯è®¾è®¡çš„ä¸€ä¸ªåŸåˆ™æ˜¯ï¼š é«˜å†…èšä½è€¦åˆã€‚<br>å±‚å†…éƒ¨çš„ç»„æˆåº”è¯¥æ˜¯é«˜åº¦èšåˆçš„ï¼Œè€Œå±‚ä¸å±‚ä¹‹é—´çš„å…³ç³»åº”è¯¥æ˜¯ä½è€¦åˆçš„ï¼Œæœ€ç†æƒ³çš„æƒ…å†µ0è€¦åˆï¼ˆå°±æ˜¯æ²¡æœ‰è€¦åˆï¼‰</p>
<h2 id="IOC-æ§åˆ¶åè½¬ï¼š"><a href="#IOC-æ§åˆ¶åè½¬ï¼š" class="headerlink" title="IOC - æ§åˆ¶åè½¬ï¼š"></a>IOC - æ§åˆ¶åè½¬ï¼š</h2><ol>
<li>ä¹‹å‰åœ¨Servletä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºserviceå¯¹è±¡ ï¼Œ FruitService fruitService &#x3D; new FruitServiceImpl();<ul>
<li>è¿™å¥è¯å¦‚æœå‡ºç°åœ¨servletä¸­çš„æŸä¸ªæ–¹æ³•å†…éƒ¨ï¼Œé‚£ä¹ˆè¿™ä¸ªfruitServiceçš„ä½œç”¨åŸŸï¼ˆç”Ÿå‘½å‘¨æœŸï¼‰åº”è¯¥å°±æ˜¯è¿™ä¸ªæ–¹æ³•çº§åˆ«ï¼›</li>
<li>å¦‚æœè¿™å¥è¯å‡ºç°åœ¨servletçš„ç±»ä¸­ï¼Œä¹Ÿå°±æ˜¯è¯´fruitServiceæ˜¯ä¸€ä¸ªæˆå‘˜å˜é‡ï¼Œé‚£ä¹ˆè¿™ä¸ªfruitServiceçš„ä½œç”¨åŸŸï¼ˆç”Ÿå‘½å‘¨æœŸï¼‰åº”è¯¥å°±æ˜¯è¿™ä¸ªservletå®ä¾‹çº§åˆ«</li>
</ul>
</li>
<li>ä¹‹åæˆ‘ä»¬åœ¨applicationContext.xmlä¸­å®šä¹‰äº†è¿™ä¸ªfruitServiceã€‚ç„¶åé€šè¿‡è§£æXMLï¼Œäº§ç”ŸfruitServiceå®ä¾‹ï¼Œå­˜æ”¾åœ¨beanMapä¸­ï¼Œè¿™ä¸ªbeanMapåœ¨ä¸€ä¸ªBeanFactoryä¸­<br>å› æ­¤ï¼Œæˆ‘ä»¬è½¬ç§»ï¼ˆæ”¹å˜ï¼‰äº†ä¹‹å‰çš„serviceå®ä¾‹ã€daoå®ä¾‹ç­‰ç­‰ä»–ä»¬çš„ç”Ÿå‘½å‘¨æœŸã€‚æ§åˆ¶æƒä»ç¨‹åºå‘˜è½¬ç§»åˆ°BeanFactoryã€‚è¿™ä¸ªç°è±¡æˆ‘ä»¬ç§°ä¹‹ä¸ºæ§åˆ¶åè½¬</li>
</ol>
<blockquote>
<p>ä¹‹å‰å¯¹è±¡åœ¨å‡ºç°é¢‘ç¹åˆ›å»ºå’Œé”€æ¯ï¼Œç”Ÿå‘½å‘¨æœŸçŸ­æš‚ï¼Œç°åœ¨ç”Ÿå‘½å‘¨æœŸé•¿ï¼Œåˆ©ç”¨ç‡é«˜</p>
</blockquote>
<h2 id="DI-ä¾èµ–æ³¨å…¥ï¼š"><a href="#DI-ä¾èµ–æ³¨å…¥ï¼š" class="headerlink" title="DI - ä¾èµ–æ³¨å…¥ï¼š"></a>DI - ä¾èµ–æ³¨å…¥ï¼š</h2><ol>
<li><p>ä¹‹å‰æˆ‘ä»¬åœ¨æ§åˆ¶å±‚å‡ºç°ä»£ç ï¼šFruitService fruitService &#x3D; new FruitServiceImpl()ï¼›<br>é‚£ä¹ˆï¼Œæ§åˆ¶å±‚å’Œserviceå±‚å­˜åœ¨è€¦åˆã€‚</p>
</li>
<li><p>ä¹‹åï¼Œæˆ‘ä»¬å°†ä»£ç ä¿®æ”¹æˆFruitService fruitService &#x3D; null ;<br>ç„¶åï¼Œåœ¨applicationContext.xmlé…ç½®æ–‡ä»¶ä¸­é…ç½®:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;fruit&quot;</span> <span class="attr">class</span>=<span class="string">&quot;FruitController&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;fruitService&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;fruitService&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="è¿‡æ»¤å™¨Filter"><a href="#è¿‡æ»¤å™¨Filter" class="headerlink" title="è¿‡æ»¤å™¨Filter"></a>è¿‡æ»¤å™¨Filter</h1><h2 id="è¿‡æ»¤å™¨Filteræ¦‚è¿°"><a href="#è¿‡æ»¤å™¨Filteræ¦‚è¿°" class="headerlink" title="è¿‡æ»¤å™¨Filteræ¦‚è¿°"></a>è¿‡æ»¤å™¨Filteræ¦‚è¿°</h2><ol>
<li>Filterä¹Ÿå±äºServletè§„èŒƒ</li>
<li>Filterå¼€å‘æ­¥éª¤ï¼šæ–°å»ºç±»å®ç°Filteræ¥å£ï¼Œç„¶åå®ç°å…¶ä¸­çš„ä¸‰ä¸ªæ–¹æ³•ï¼šinitã€doFilterã€destroy<br>é…ç½®Filterï¼Œå¯ä»¥ç”¨æ³¨è§£@WebFilterï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨xmlæ–‡ä»¶ <filter> <filter-mapping></filter-mapping></filter></li>
<li>Filteråœ¨é…ç½®æ—¶ï¼Œå’Œservletä¸€æ ·ï¼Œä¹Ÿå¯ä»¥é…ç½®é€šé…ç¬¦ï¼Œä¾‹å¦‚ @WebFilter(â€œ*.doâ€)è¡¨ç¤ºæ‹¦æˆªæ‰€æœ‰ä»¥.doç»“å°¾çš„è¯·æ±‚</li>
<li>è¿‡æ»¤å™¨é“¾<br>1ï¼‰æ‰§è¡Œçš„é¡ºåºä¾æ¬¡æ˜¯ï¼š A B C demo03 C2 B2 A2<br>2ï¼‰å¦‚æœé‡‡å–çš„æ˜¯æ³¨è§£çš„æ–¹å¼è¿›è¡Œé…ç½®ï¼Œé‚£ä¹ˆè¿‡æ»¤å™¨é“¾çš„æ‹¦æˆªé¡ºåºæ˜¯<strong>æŒ‰ç…§å…¨ç±»åçš„å…ˆåé¡ºåºæ’åº</strong>çš„<br>3ï¼‰å¦‚æœé‡‡å–çš„æ˜¯xmlçš„æ–¹å¼è¿›è¡Œé…ç½®ï¼Œé‚£ä¹ˆæŒ‰ç…§<strong>é…ç½®çš„å…ˆåé¡ºåºè¿›è¡Œæ’åº</strong></li>
</ol>
<h2 id="è¿‡æ»¤å™¨é¡¹ç›®ç®€å›¾"><a href="#è¿‡æ»¤å™¨é¡¹ç›®ç®€å›¾" class="headerlink" title="è¿‡æ»¤å™¨é¡¹ç›®ç®€å›¾"></a>è¿‡æ»¤å™¨é¡¹ç›®ç®€å›¾</h2><p><img src="/2022/09/30/JavaWeb/image-20220707122421570.png" alt="image-20220707122421570"></p>
<blockquote>
<p>å®¢æˆ·ç«¯å‘servletå‘é€è¯·æ±‚ï¼Œéœ€è¦å…ˆç»è¿‡å¯¹åº”çš„Filterè¿‡æ»¤å™¨</p>
<p>Servletå‘å¦å¤–å®¢æˆ·ç«¯ç›¸åº”è¿˜æ˜¯åŸè·¯ç»è¿‡Filterè¿”å›ï¼Œç±»ä¼¼é€’å½’</p>
</blockquote>
<h2 id="ä»£ç æ¼”ç¤º"><a href="#ä»£ç æ¼”ç¤º" class="headerlink" title="ä»£ç æ¼”ç¤º"></a>ä»£ç æ¼”ç¤º</h2><h3 id="Filter01"><a href="#Filter01" class="headerlink" title="Filter01"></a>Filter01</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebFilter(&quot;*.do&quot;)</span>  <span class="comment">//ä»»ä½•å‘.doç»“å°¾çš„Serlvetå‘é€è¯·æ±‚éƒ½ä¼šç»è¿‡è¿™</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Filter01</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;A&quot;</span>); <span class="comment">//å®¢æˆ·ç«¯å‘Serveletå‘è¯·æ±‚ï¼Œæ‰§è¡Œå®Œç›¸åº”ä»£ç åæ”¾è¡Œ</span></span><br><span class="line">        <span class="comment">//æ”¾è¡Œ --- è·³è½¬è‡³ä¸‹ä¸€ä¸ªè¿‡æ»¤å™¨æˆ–ç›´æ¥åˆ°è¾¾Servlet</span></span><br><span class="line">        filterChain.doFilter(servletRequest,servletResponse);</span><br><span class="line">        System.out.println(<span class="string">&quot;A2&quot;</span>); <span class="comment">//Servletå‘å®¢æˆ·ç«¯å“åº”ï¼Œæ‰§è¡Œçš„ä»£ç </span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Demo01Servlet"><a href="#Demo01Servlet" class="headerlink" title="Demo01Servlet"></a>Demo01Servlet</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/demo01.do&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo01Servlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;demo01 service.....&quot;</span>);</span><br><span class="line">        request.getRequestDispatcher(<span class="string">&quot;succ.html&quot;</span>).forward(request,response); <span class="comment">//é‡å®šå‘è¿˜æ˜¯è¦ç»è¿‡è¿‡æ»¤å™¨</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="è¿‡æ»¤å™¨çš„ç®€å•åº”ç”¨â€“è®¾ç½®ç¼–ç "><a href="#è¿‡æ»¤å™¨çš„ç®€å•åº”ç”¨â€“è®¾ç½®ç¼–ç " class="headerlink" title="è¿‡æ»¤å™¨çš„ç®€å•åº”ç”¨â€“è®¾ç½®ç¼–ç "></a>è¿‡æ»¤å™¨çš„ç®€å•åº”ç”¨â€“è®¾ç½®ç¼–ç </h2><h3 id="å›¾ç¤º"><a href="#å›¾ç¤º" class="headerlink" title="å›¾ç¤º"></a>å›¾ç¤º</h3><p><img src="/2022/09/30/JavaWeb/image-20220707123727361.png" alt="image-20220707123727361"></p>
<h3 id="CharacterEncodingFilter"><a href="#CharacterEncodingFilter" class="headerlink" title="CharacterEncodingFilter"></a>CharacterEncodingFilter</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebFilter(urlPatterns = &#123;&quot;*.do&quot;&#125;,</span></span><br><span class="line"><span class="meta">		initParams = &#123;@WebInitParam(name = &quot;encoding&quot;,value = &quot;UTF-8&quot;)&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CharacterEncodingFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> <span class="variable">encoding</span> <span class="operator">=</span> <span class="string">&quot;UTF-8&quot;</span>;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">encodingStr</span> <span class="operator">=</span> filterConfig.getInitParameter(<span class="string">&quot;encoding&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(StringUtil.isNotEmpty(encodingStr))&#123;</span><br><span class="line">            encoding = encodingStr ;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        </span><br><span class="line">        ((HttpServletRequest)servletRequest).setCharacterEncoding(encoding);</span><br><span class="line">        </span><br><span class="line">        filterChain.doFilter(servletRequest,servletResponse);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>åˆ©ç”¨é…ç½®æ–‡ä»¶æˆ–æ³¨è§£å¯ä»¥ä¸ºRequestè‡ªå®šä¹‰ç¼–ç é›†</p>
</blockquote>
<h1 id="äº‹åŠ¡ç®¡ç†"><a href="#äº‹åŠ¡ç®¡ç†" class="headerlink" title="äº‹åŠ¡ç®¡ç†"></a>äº‹åŠ¡ç®¡ç†</h1><h2 id="ç¼–ç¨‹å¼ç®¡ç†äº‹åŠ¡"><a href="#ç¼–ç¨‹å¼ç®¡ç†äº‹åŠ¡" class="headerlink" title="ç¼–ç¨‹å¼ç®¡ç†äº‹åŠ¡"></a>ç¼–ç¨‹å¼ç®¡ç†äº‹åŠ¡</h2><p><strong>äº‹åŠ¡ç®¡ç†ä¹‹å‰</strong></p>
<p><img src="/2022/09/30/JavaWeb/image-20220707160516225.png" alt="image-20220707160516225"></p>
<blockquote>
<p>å½“å‰Serviceä¸­åŒ…å«äº†ä¸‰ä¸ªDAOæ“ä½œ</p>
<p>ä¹‹å‰çš„DAOçš„äº‹åŠ¡ç®¡ç†çš„åŸºæœ¬APIæ˜¯å³è¾¹å†™çš„æ–¹å¼</p>
<p>è¿™æ ·çš„æ–¹å¼çš„å¸¦æ¥çš„é—®é¢˜æ˜¯DAO01æ‰§è¡ŒæˆåŠŸ-æäº¤ï¼ŒDAO02æ‰§è¡Œå¤±è´¥-å›æ»šï¼ŒDAO03æ‰§è¡ŒæˆåŠŸ-æäº¤</p>
<p>æ­¤æ—¶serviceæ“ä½œæ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Ÿï¼Ÿ serviceçš„æ“ä½œåº”è¯¥æ˜¯ä¸€ä¸ªæ•´ä½“ï¼Œä¸èƒ½éƒ¨åˆ†æˆåŠŸéƒ¨åˆ†å¤±è´¥ã€‚</p>
<p>å› æ­¤ï¼Œserviceæ˜¯ä¸€ä¸ªæ•´ä½“ï¼Œè¦ä¹ˆéƒ½æˆåŠŸï¼Œè¦ä¹ˆéƒ½å¤±è´¥ â€“  å¾—å‡ºç»“è®ºï¼šäº‹åŠ¡ç®¡ç†ä¸èƒ½ä»¥DAOå±‚çš„å•ç²¾åº¦æ–¹æ³•ä¸ºå•ä½ï¼Œè€Œåº”è¯¥ä»¥ä¸šåŠ¡å±‚çš„æ–¹æ³•ä¸ºå•ä½</p>
</blockquote>
<p><strong>äº‹åŠ¡ç®¡ç†å‰ç½®ä¹‹å</strong></p>
<p><img src="/2022/09/30/JavaWeb/image-20220707161136914.png" alt="image-20220707161136914"></p>
<h2 id="æ°´æœç³»ç»Ÿåœ¨ä¼˜åŒ–-5"><a href="#æ°´æœç³»ç»Ÿåœ¨ä¼˜åŒ–-5" class="headerlink" title="æ°´æœç³»ç»Ÿåœ¨ä¼˜åŒ–-5"></a>æ°´æœç³»ç»Ÿåœ¨ä¼˜åŒ–-5</h2><h3 id="äº‹åŠ¡ç®¡ç†å‰ç½®åˆ°è¿‡æ»¤å™¨"><a href="#äº‹åŠ¡ç®¡ç†å‰ç½®åˆ°è¿‡æ»¤å™¨" class="headerlink" title="äº‹åŠ¡ç®¡ç†å‰ç½®åˆ°è¿‡æ»¤å™¨"></a>äº‹åŠ¡ç®¡ç†å‰ç½®åˆ°è¿‡æ»¤å™¨</h3><p><img src="/2022/09/30/JavaWeb/image-20220707161647857.png" alt="image-20220707161647857"></p>
<p>è§£å†³éš¾ç‚¹ï¼šéœ€è¦è¿™ä¸‰ä¸ªç»„ä»¶ä¸­çš„æ“ä½œéƒ½æ˜¯ç”¨åŒä¸€ä¸ªConnectionï¼Œå°±æ˜¯ä½¿ç”¨ThreadLocalï¼Œèƒ½å¤Ÿå°†è¿æ¥ä¿å­˜åœ¨Map&lt;&gt;ä¸­ï¼Œä½¿ç”¨æ—¶è·å–ï¼Œå…³é—­è¿æ¥æ—¶åœ¨å…³é—­å°±okï¼Œæ­¤æ—¶æ–°å»ºä¸€ä¸ªConnUtilå·¥å…·ç±»è¿›è¡Œå®ç°åˆ›å»ºè¿æ¥å’Œå…³é—­è¿æ¥çš„æ–¹æ³•</p>
<h3 id="ThreadLocal"><a href="#ThreadLocal" class="headerlink" title="ThreadLocal"></a>ThreadLocal</h3><p>get() , set(obj)</p>
<p>ThreadLocalç§°ä¹‹ä¸ºæœ¬åœ°çº¿ç¨‹ ã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡setæ–¹æ³•åœ¨å½“å‰çº¿ç¨‹ä¸Šå­˜å‚¨æ•°æ®ã€é€šè¿‡getæ–¹æ³•åœ¨å½“å‰çº¿ç¨‹ä¸Šè·å–æ•°æ®</p>
<h4 id="setæ–¹æ³•æºç åˆ†æï¼š"><a href="#setæ–¹æ³•æºç åˆ†æï¼š" class="headerlink" title="setæ–¹æ³•æºç åˆ†æï¼š"></a>setæ–¹æ³•æºç åˆ†æï¼š</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">set</span><span class="params">(T value)</span> &#123;</span><br><span class="line"><span class="type">Thread</span> <span class="variable">t</span> <span class="operator">=</span> Thread.currentThread(); <span class="comment">//è·å–å½“å‰çš„çº¿ç¨‹</span></span><br><span class="line"><span class="type">ThreadLocalMap</span> <span class="variable">map</span> <span class="operator">=</span> getMap(t);    <span class="comment">//æ¯ä¸€ä¸ªçº¿ç¨‹éƒ½ç»´æŠ¤å„è‡ªçš„ä¸€ä¸ªå®¹å™¨ï¼ˆThreadLocalMapï¼‰</span></span><br><span class="line"><span class="keyword">if</span> (map != <span class="literal">null</span>)</span><br><span class="line">    map.set(<span class="built_in">this</span>, value);          <span class="comment">//è¿™é‡Œçš„keyå¯¹åº”çš„æ˜¯ThreadLocalï¼Œå› ä¸ºæˆ‘ä»¬çš„ç»„ä»¶ä¸­éœ€è¦ä¼ è¾“ï¼ˆå…±äº«ï¼‰çš„å¯¹è±¡å¯èƒ½ä¼šæœ‰å¤šä¸ªï¼ˆä¸æ­¢Connectionï¼‰</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    createMap(t, value);           <span class="comment">//é»˜è®¤æƒ…å†µä¸‹mapæ˜¯æ²¡æœ‰åˆå§‹åŒ–çš„ï¼Œé‚£ä¹ˆç¬¬ä¸€æ¬¡å¾€å…¶ä¸­æ·»åŠ æ•°æ®æ—¶ï¼Œä¼šå»åˆå§‹åŒ–</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h4 id="getæ–¹æ³•æºç åˆ†æï¼š"><a href="#getæ–¹æ³•æºç åˆ†æï¼š" class="headerlink" title="getæ–¹æ³•æºç åˆ†æï¼š"></a>getæ–¹æ³•æºç åˆ†æï¼š</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">public</span> T <span class="title function_">get</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="type">Thread</span> <span class="variable">t</span> <span class="operator">=</span> Thread.currentThread(); <span class="comment">//è·å–å½“å‰çš„çº¿ç¨‹</span></span><br><span class="line"><span class="type">ThreadLocalMap</span> <span class="variable">map</span> <span class="operator">=</span> getMap(t);    <span class="comment">//è·å–å’Œè¿™ä¸ªçº¿ç¨‹ï¼ˆä¼ä¸šï¼‰ç›¸å…³çš„ThreadLocalMapï¼ˆä¹Ÿå°±æ˜¯å·¥ä½œçº½å¸¦çš„é›†åˆï¼‰</span></span><br><span class="line"><span class="keyword">if</span> (map != <span class="literal">null</span>) &#123;</span><br><span class="line">    ThreadLocalMap.<span class="type">Entry</span> <span class="variable">e</span> <span class="operator">=</span> map.getEntry(<span class="built_in">this</span>);   <span class="comment">//thisæŒ‡çš„æ˜¯ThreadLocalå¯¹è±¡ï¼Œé€šè¿‡å®ƒæ‰èƒ½çŸ¥é“æ˜¯å“ªä¸€ä¸ªå·¥ä½œçº½å¸¦</span></span><br><span class="line">    <span class="keyword">if</span> (e != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line">        <span class="type">T</span> <span class="variable">result</span> <span class="operator">=</span> (T)e.value;     <span class="comment">//entry.valueå°±å¯ä»¥è·å–åˆ°å·¥å…·ç®±äº†</span></span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> setInitialValue();</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å½“å‰çº¿ç¨‹å¯æ¯”ä½œä¸€ä¸ªä¼ä¸šï¼Œæœ¬åœ°çº¿ç¨‹åˆ™å¯æ¯”ä½œä¼ä¸šçš„ä¸€ä¸ªå·¥ä½œï¼Œä¸€ä¸ªå·¥ä½œåªæœ‰ä¸€ä¸ªå·¥å…·ç®±ï¼ˆå¦‚è¿æ¥Connectionï¼‰ä¸€ä¸ªä¼ä¸šä¸­å¯æœ‰å¤šä¸ªå·¥ä½œ</p>
</blockquote>
<h3 id="ConnUtilâ€“ç»Ÿä¸€è¿æ¥"><a href="#ConnUtilâ€“ç»Ÿä¸€è¿æ¥" class="headerlink" title="ConnUtilâ€“ç»Ÿä¸€è¿æ¥"></a>ConnUtilâ€“ç»Ÿä¸€è¿æ¥</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConnUtil</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> ThreadLocal&lt;Connection&gt; threadLocal = <span class="keyword">new</span> <span class="title class_">ThreadLocal</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">//private static ThreadLocal&lt;Object&gt; threadLocal2 = new ThreadLocal&lt;&gt;();</span></span><br><span class="line">    <span class="comment">//private static ThreadLocal&lt;Object&gt; threadLocal3 = new ThreadLocal&lt;&gt;();</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DRIVER</span> <span class="operator">=</span> <span class="string">&quot;com.mysql.jdbc.Driver&quot;</span> ;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">URL</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/fruitdb?useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=false&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">USER</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">PWD</span> <span class="operator">=</span> <span class="string">&quot;123456&quot;</span> ;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Connection <span class="title function_">createConn</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//1.åŠ è½½é©±åŠ¨</span></span><br><span class="line">            Class.forName(DRIVER);</span><br><span class="line">            <span class="comment">//2.é€šè¿‡é©±åŠ¨ç®¡ç†å™¨è·å–è¿æ¥å¯¹è±¡</span></span><br><span class="line">            <span class="keyword">return</span> DriverManager.getConnection(URL, USER, PWD);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException | SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span> ;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title function_">getConn</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> threadLocal.get();</span><br><span class="line">        <span class="keyword">if</span>(conn==<span class="literal">null</span>)&#123;</span><br><span class="line">            conn =createConn();</span><br><span class="line">            threadLocal.set(conn);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> threadLocal.get() ;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">closeConn</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> threadLocal.get();</span><br><span class="line">        <span class="keyword">if</span>(conn==<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(!conn.isClosed())&#123;</span><br><span class="line">            conn.close();</span><br><span class="line">            threadLocal.set(<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="è¿‡æ»¤å™¨æ— æ³•æ•è·å¼‚å¸¸"><a href="#è¿‡æ»¤å™¨æ— æ³•æ•è·å¼‚å¸¸" class="headerlink" title="è¿‡æ»¤å™¨æ— æ³•æ•è·å¼‚å¸¸"></a>è¿‡æ»¤å™¨æ— æ³•æ•è·å¼‚å¸¸</h3><p>é—®é¢˜ï¼šå¦‚æœæ‰€æœ‰å¼‚å¸¸éƒ½å‘ä¸ŠæŠ›å‡ºï¼Œä¹‹åç»Ÿä¸€åœ¨è¿‡æ»¤å™¨ä¸­è¢«å‘ç°å¹¶å¤„ç†ï¼Œä½†æ˜¯å‡ºç°å¼‚å¸¸çš„ä½ç½®å°±éš¾ä»¥å®šä½ï¼Œæ‰€ä»¥å¾—åœ¨å¼‚å¸¸å¤„è¿›è¡Œå¤„ç†ï¼ˆtry-catchï¼‰ï¼Œç„¶ååœ¨å‘ä¸ŠæŠ›å‡ºè‡ªå®šä¹‰å¼‚å¸¸</p>
<p>ä¾‹å¦‚åœ¨BaseDAOä¸­è¿›è¡Œæ•è·å¼‚å¸¸åœ¨æŠ›å‡ºè‡ªå®šä¹‰å¼‚å¸¸</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DAOException</span> <span class="keyword">extends</span> <span class="title class_">RuntimeException</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">DAOException</span><span class="params">(String msg)</span>&#123;</span><br><span class="line">        <span class="built_in">super</span>(msg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2022/09/30/JavaWeb/image-20220707164807611.png" alt="image-20220707164807611"></p>
<h3 id="TransactionManager"><a href="#TransactionManager" class="headerlink" title="TransactionManager"></a>TransactionManager</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TransactionManager</span> &#123;</span><br><span class="line">	<span class="comment">//ä¸‰ä¸ªæ“ä½œè·å–çš„éƒ½æ˜¯ç»Ÿä¸€è¿æ¥ï¼Œè¿›è¡Œå¼€å¯ã€æäº¤ã€å›å½’æ“ä½œ</span></span><br><span class="line">    <span class="comment">//å¼€å¯äº‹åŠ¡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">beginTrans</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        ConnUtil.getConn().setAutoCommit(<span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æäº¤äº‹åŠ¡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">commit</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> ConnUtil.getConn();</span><br><span class="line">        conn.commit();</span><br><span class="line">        ConnUtil.closeConn();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å›æ»šäº‹åŠ¡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">rollback</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> ConnUtil.getConn();</span><br><span class="line">        conn.rollback();</span><br><span class="line">        ConnUtil.closeConn();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="OpenSessionInViewFilter"><a href="#OpenSessionInViewFilter" class="headerlink" title="OpenSessionInViewFilter"></a>OpenSessionInViewFilter</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebFilter(&quot;*.do&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OpenSessionInViewFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            TransactionManager.beginTrans(); <span class="comment">//å°†è¿æ¥çš„è‡ªåŠ¨æäº¤æ”¹ä¸ºfalse</span></span><br><span class="line">            System.out.println(<span class="string">&quot;å¼€å¯äº‹åŠ¡....&quot;</span>);</span><br><span class="line">                filterChain.doFilter(servletRequest, servletResponse);</span><br><span class="line">                TransactionManager.commit();</span><br><span class="line">                System.out.println(<span class="string">&quot;æäº¤äº‹åŠ¡...&quot;</span>);</span><br><span class="line">            &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    TransactionManager.rollback();</span><br><span class="line">                    System.out.println(<span class="string">&quot;å›æ»šäº‹åŠ¡....&quot;</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (SQLException ex) &#123;</span><br><span class="line">                    ex.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ€»ç»“-2"><a href="#æ€»ç»“-2" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>æ­¤æ¬¡æ°´æœç³»ç»Ÿä¼˜åŒ–ï¼Œç»Ÿä¸€äº†å¤šä¸ªDAOæ–¹æ³•çš„äº‹åŠ¡ç®¡ç†ï¼Œç»Ÿä¸€åœ¨è¿‡æ»¤å™¨ä¸­å¤„ç†ï¼Œå¦‚æœ‰å¼‚å¸¸åˆ™å›æ»šï¼Œå¦åˆ™å¯ä»¥æäº¤ã€‚æ­¤æ–¹å¼çš„æ”¹è¿›ä¸­éœ€è¦ç»Ÿä¸€DAOä½¿ç”¨çš„æ•°æ®åº“è¿æ¥ï¼Œå› æ­¤ç¼–å†™ConnUtilï¼Œåˆ©ç”¨ThreadLocalï¼Œèƒ½å¤Ÿå°†è¿æ¥ä¿å­˜åœ¨Map&lt;&gt;ä¸­ï¼Œä½¿ç”¨æ—¶è·å–</p>
<h1 id="ç›‘å¬å™¨"><a href="#ç›‘å¬å™¨" class="headerlink" title="ç›‘å¬å™¨"></a>ç›‘å¬å™¨</h1><h2 id="ç›‘å¬å™¨ç±»å‹"><a href="#ç›‘å¬å™¨ç±»å‹" class="headerlink" title="ç›‘å¬å™¨ç±»å‹"></a>ç›‘å¬å™¨ç±»å‹</h2><ol>
<li>ServletContextListener - ç›‘å¬ServletContextå¯¹è±¡çš„åˆ›å»ºå’Œé”€æ¯çš„è¿‡ç¨‹</li>
<li>HttpSessionListener - ç›‘å¬HttpSessionå¯¹è±¡çš„åˆ›å»ºå’Œé”€æ¯çš„è¿‡ç¨‹</li>
<li>ServletRequestListener - ç›‘å¬ServletRequestå¯¹è±¡çš„åˆ›å»ºå’Œé”€æ¯çš„è¿‡ç¨‹</li>
<li>ServletContextAttributeListener - ç›‘å¬ServletContextçš„ä¿å­˜ä½œç”¨åŸŸçš„æ”¹åŠ¨(add,remove,replace)</li>
<li>HttpSessionAttributeListener - ç›‘å¬HttpSessionçš„ä¿å­˜ä½œç”¨åŸŸçš„æ”¹åŠ¨(add,remove,replace)</li>
<li>ServletRequestAttributeListener - ç›‘å¬ServletRequestçš„ä¿å­˜ä½œç”¨åŸŸçš„æ”¹åŠ¨(add,remove,replace)</li>
<li>HttpSessionBindingListener - ç›‘å¬æŸä¸ªå¯¹è±¡åœ¨SessionåŸŸä¸­çš„åˆ›å»ºä¸ç§»é™¤</li>
<li>HttpSessionActivationListener - ç›‘å¬æŸä¸ªå¯¹è±¡åœ¨SessionåŸŸä¸­çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–</li>
</ol>
<h2 id="ç›‘å¬å™¨çš„ä½¿ç”¨"><a href="#ç›‘å¬å™¨çš„ä½¿ç”¨" class="headerlink" title="ç›‘å¬å™¨çš„ä½¿ç”¨"></a>ç›‘å¬å™¨çš„ä½¿ç”¨</h2><p>1ã€ç›‘å¬å™¨éœ€è¦å®ç°å¯¹åº”çš„ç›‘å¬å™¨æ¥å£ï¼Œå¹¶é‡å†™åˆå§‹å’Œé”€æ¯æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebListener</span> <span class="comment">//ä½¿ç”¨æ³¨è§£é…ç½®ç›‘å¬å™¨</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ContextLoaderListener</span> <span class="keyword">implements</span> <span class="title class_">ServletContextListener</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">contextInitialized</span><span class="params">(ServletContextEvent servletContextEvent)</span> &#123;</span><br><span class="line">        <span class="comment">//è¯¥æ–¹æ³•åœ¨ä¸Šä¸‹æ–‡è¢«åˆ›å»ºæ—¶è°ƒç”¨</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">contextDestroyed</span><span class="params">(ServletContextEvent servletContextEvent)</span> &#123;</span><br><span class="line">		<span class="comment">//è¯¥æ–¹æ³•åœ¨ä¸Šä¸‹æ–‡è¢«é”€æ¯æ—¶è°ƒç”¨</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2ã€è¯†åˆ«ç›‘å¬å™¨å­˜åœ¨å¯åœ¨web.xmlé…ç½®æ–‡ä»¶ä¸­æ·»åŠ ï¼Œä¹Ÿå¯ä½¿ç”¨æ³¨è§£æ·»åŠ </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>com.atguigu.listener.MyServletContextListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="æ°´æœç³»ç»Ÿåœ¨ä¼˜åŒ–-6"><a href="#æ°´æœç³»ç»Ÿåœ¨ä¼˜åŒ–-6" class="headerlink" title="æ°´æœç³»ç»Ÿåœ¨ä¼˜åŒ–-6"></a>æ°´æœç³»ç»Ÿåœ¨ä¼˜åŒ–-6</h2><h3 id="è·å–é…ç½®æ–‡ä»¶åçš„å°è£…"><a href="#è·å–é…ç½®æ–‡ä»¶åçš„å°è£…" class="headerlink" title="è·å–é…ç½®æ–‡ä»¶åçš„å°è£…"></a>è·å–é…ç½®æ–‡ä»¶åçš„å°è£…</h3><h3 id="applicationContext-xml-1"><a href="#applicationContext-xml-1" class="headerlink" title="applicationContext.xml"></a>applicationContext.xml</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>applicationContext.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ä¸Šä¸‹æ–‡å‚æ•°ï¼Œåœ¨åˆå§‹æ—¶å¯ä»¥é€šè¿‡ä¸Šä¸‹æ–‡è·å–ï¼Œå…¶ç›®çš„æ˜¯é¿å…åœ¨javaä»£ç ä¸­å†™æ­»é…ç½®æ–‡ä»¶åï¼Œå¯åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šé…ç½®æ–‡ä»¶å</p>
</blockquote>
<h3 id="ç›‘å¬å™¨çš„åŠ å…¥ï¼šContextLoaderListener"><a href="#ç›‘å¬å™¨çš„åŠ å…¥ï¼šContextLoaderListener" class="headerlink" title="ç›‘å¬å™¨çš„åŠ å…¥ï¼šContextLoaderListener"></a>ç›‘å¬å™¨çš„åŠ å…¥ï¼šContextLoaderListener</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç›‘å¬ä¸Šä¸‹æ–‡å¯åŠ¨ï¼Œåœ¨ä¸Šä¸‹æ–‡å¯åŠ¨çš„æ—¶å€™å»åˆ›å»ºIOCå®¹å™¨,ç„¶åå°†å…¶ä¿å­˜åˆ°applicationä½œç”¨åŸŸ</span></span><br><span class="line"><span class="comment">//åé¢ä¸­å¤®æ§åˆ¶å™¨å†ä»applicationä½œç”¨åŸŸä¸­å»è·å–IOCå®¹å™¨</span></span><br><span class="line"><span class="meta">@WebListener</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ContextLoaderListener</span> <span class="keyword">implements</span> <span class="title class_">ServletContextListener</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">contextInitialized</span><span class="params">(ServletContextEvent servletContextEvent)</span> &#123;</span><br><span class="line">        <span class="comment">//1.è·å–ServletContextå¯¹è±¡</span></span><br><span class="line">        <span class="type">ServletContext</span> <span class="variable">application</span> <span class="operator">=</span> servletContextEvent.getServletContext();</span><br><span class="line">        <span class="comment">//2.è·å–ä¸Šä¸‹æ–‡çš„åˆå§‹åŒ–å‚æ•°</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">path</span> <span class="operator">=</span> application.getInitParameter(<span class="string">&quot;contextConfigLocation&quot;</span>);</span><br><span class="line">        <span class="comment">//3.åˆ›å»ºIOCå®¹å™¨</span></span><br><span class="line">        <span class="type">BeanFactory</span> <span class="variable">beanFactory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(path);</span><br><span class="line">        <span class="comment">//4.å°†IOCå®¹å™¨ä¿å­˜åˆ°applicationä½œç”¨åŸŸ                     pathæ˜¯é…ç½®æ–‡ä»¶å</span></span><br><span class="line">        application.setAttribute(<span class="string">&quot;beanFactory&quot;</span>,beanFactory);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">contextDestroyed</span><span class="params">(ServletContextEvent servletContextEvent)</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä¹‹å‰IOCå®¹å™¨æ˜¯åœ¨ä¸­å¤®æ§åˆ¶å™¨DispatcherServletä¸­åˆ›å»ºçš„ï¼Œç”±äºIOCå®¹å™¨æ‰¿è£…ç€æ‰€æœ‰ç»„ä»¶éœ€è¦ä½¿ç”¨çš„å®ä¾‹ï¼Œå› æ­¤éœ€è¦å°†IOCå®¹å™¨åˆ›å»ºæ—¶é—´æå‰ï¼Œå³åœ¨åˆå§‹Servletä¸Šä¸‹æ–‡æ—¶åˆ›å»ºï¼Œåˆå› ServletContextListenerç›‘å¬å™¨åœ¨Servletä¸Šä¸‹æ–‡åˆå§‹æ—¶ä¼šè°ƒç”¨å…¶å†…éƒ¨çš„æ–¹æ³•ï¼Œå› æ­¤å¯ä»¥é‡å†™æ­¤æ–¹æ³•è¿›è¡Œä¸Šä¸‹æ–‡çš„åˆ›å»º</p>
</blockquote>
<h3 id="DispatcherServletä¸­æ„é€ å™¨"><a href="#DispatcherServletä¸­æ„é€ å™¨" class="headerlink" title="DispatcherServletä¸­æ„é€ å™¨"></a>DispatcherServletä¸­æ„é€ å™¨</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;*.do&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DispatcherServlet</span> <span class="keyword">extends</span> <span class="title class_">ViewBaseServlet</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">    <span class="built_in">super</span>.init();</span><br><span class="line">    <span class="comment">//ä¹‹å‰æ˜¯åœ¨æ­¤å¤„ä¸»åŠ¨åˆ›å»ºIOCå®¹å™¨çš„</span></span><br><span class="line">    <span class="comment">//ç°åœ¨ä¼˜åŒ–ä¸ºä»applicationä½œç”¨åŸŸå»è·å–</span></span><br><span class="line">    <span class="comment">//beanFactory = new ClassPathXmlApplicationContext();</span></span><br><span class="line">    <span class="type">ServletContext</span> <span class="variable">application</span> <span class="operator">=</span> getServletContext();</span><br><span class="line">    <span class="type">Object</span> <span class="variable">beanFactoryObj</span> <span class="operator">=</span> application.getAttribute(<span class="string">&quot;beanFactory&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(beanFactoryObj!=<span class="literal">null</span>)&#123;</span><br><span class="line">        beanFactory = (BeanFactory)beanFactoryObj ;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;IOCå®¹å™¨è·å–å¤±è´¥ï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ServletContextå³Servletä¸Šä¸‹æ–‡</p>
</blockquote>
<h1 id="æ°´æœç³»ç»Ÿæ€»ç»“"><a href="#æ°´æœç³»ç»Ÿæ€»ç»“" class="headerlink" title="æ°´æœç³»ç»Ÿæ€»ç»“"></a>æ°´æœç³»ç»Ÿæ€»ç»“</h1><h2 id="MVCå„å±‚çš„è®¾è®¡"><a href="#MVCå„å±‚çš„è®¾è®¡" class="headerlink" title="MVCå„å±‚çš„è®¾è®¡"></a>MVCå„å±‚çš„è®¾è®¡</h2><p><img src="/2022/09/30/JavaWeb/image-20220707235431197.png" alt="image-20220707235431197"></p>
<h1 id="qqZoneé¡¹ç›®"><a href="#qqZoneé¡¹ç›®" class="headerlink" title="qqZoneé¡¹ç›®"></a>qqZoneé¡¹ç›®</h1><h2 id="1-ç†Ÿæ‚‰QQZoneä¸šåŠ¡éœ€æ±‚"><a href="#1-ç†Ÿæ‚‰QQZoneä¸šåŠ¡éœ€æ±‚" class="headerlink" title="1.ç†Ÿæ‚‰QQZoneä¸šåŠ¡éœ€æ±‚"></a>1.ç†Ÿæ‚‰QQZoneä¸šåŠ¡éœ€æ±‚</h2><ol>
<li><p>ç”¨æˆ·ç™»å½•</p>
</li>
<li><p>ç™»å½•æˆåŠŸï¼Œæ˜¾ç¤ºä¸»ç•Œé¢ã€‚å·¦ä¾§æ˜¾ç¤ºå¥½å‹åˆ—è¡¨ï¼›ä¸Šç«¯æ˜¾ç¤ºæ¬¢è¿è¯ã€‚å¦‚æœä¸æ˜¯è‡ªå·±çš„ç©ºé—´ï¼Œæ˜¾ç¤ºè¶…é“¾æ¥ï¼šè¿”å›è‡ªå·±çš„ç©ºé—´ï¼›ä¸‹ç«¯æ˜¾ç¤ºæ—¥å¿—åˆ—è¡¨</p>
   <img src="/2022/09/30/JavaWeb/image-20220711100050088.png" alt="image-20220711100050088" style="zoom:50%;"></li>
</ol>
<ol start="3">
<li><p>æŸ¥çœ‹æ—¥å¿—è¯¦æƒ…ï¼š</p>
<ul>
<li>æ—¥å¿—æœ¬èº«çš„ä¿¡æ¯ï¼ˆä½œè€…å¤´åƒã€æ˜µç§°ã€æ—¥å¿—æ ‡é¢˜ã€æ—¥å¿—å†…å®¹ã€æ—¥å¿—çš„æ—¥æœŸï¼‰</li>
<li>å›å¤åˆ—è¡¨ï¼ˆå›å¤è€…çš„å¤´åƒã€æ˜µç§°ã€å›å¤å†…å®¹ã€å›å¤æ—¥æœŸï¼‰</li>
<li>ä¸»äººå›å¤ä¿¡æ¯</li>
</ul>
   <img src="/2022/09/30/JavaWeb/image-20220711100334588.png" alt="image-20220711100334588" style="zoom:50%;"></li>
</ol>
<ol start="4">
<li><p>åˆ é™¤æ—¥å¿—ï¼ˆä¸»é¡µé¢æ ‡ç­¾ï¼‰</p>
</li>
<li><p>åˆ é™¤ç‰¹å®šå›å¤ï¼ˆåˆ é™¤æ—¶åº”è¯¥æ˜¯æ£€æŸ¥æ˜¯å¦æœ‰è¢«ä¸»äººå›å¤è¿‡ï¼Œæœ‰åˆ™å…ˆåˆ é™¤ä¸»äººå›å¤åœ¨åˆ é™¤æ­¤å›å¤ï¼‰</p>
</li>
<li><p>åˆ é™¤ç‰¹å®šä¸»äººå›å¤</p>
</li>
<li><p>æ·»åŠ æ—¥å¿—ã€æ·»åŠ å›å¤ã€æ·»åŠ ä¸»äººå›å¤</p>
</li>
<li><p>ç‚¹å‡»å·¦ä¾§å¥½å‹é“¾æ¥ï¼Œè¿›å…¥å¥½å‹çš„ç©ºé—´</p>
</li>
</ol>
<h2 id="2-æ•°æ®åº“è®¾è®¡"><a href="#2-æ•°æ®åº“è®¾è®¡" class="headerlink" title="2.æ•°æ®åº“è®¾è®¡"></a>2.æ•°æ®åº“è®¾è®¡</h2><h3 id="1-æŠ½å–å®ä½“"><a href="#1-æŠ½å–å®ä½“" class="headerlink" title="1.æŠ½å–å®ä½“"></a>1.æŠ½å–å®ä½“</h3><ul>
<li>ç”¨æˆ·ç™»å½•ä¿¡æ¯</li>
<li>ç”¨æˆ·è¯¦æƒ…ä¿¡æ¯</li>
<li>æ—¥å¿— </li>
<li>å›è´´  </li>
<li>ä¸»äººå›å¤</li>
</ul>
<h3 id="2-åˆ†æå…¶ä¸­çš„å±æ€§"><a href="#2-åˆ†æå…¶ä¸­çš„å±æ€§" class="headerlink" title="2.åˆ†æå…¶ä¸­çš„å±æ€§"></a>2.åˆ†æå…¶ä¸­çš„å±æ€§</h3><ul>
<li><p>ç”¨æˆ·ç™»å½•ä¿¡æ¯ï¼šè´¦å·ã€å¯†ç ã€å¤´åƒã€æ˜µç§°</p>
</li>
<li><p>ç”¨æˆ·è¯¦æƒ…ä¿¡æ¯ï¼šçœŸå®å§“åã€æ˜Ÿåº§ã€è¡€å‹ã€é‚®ç®±ã€æ‰‹æœºå·â€¦..</p>
</li>
<li><p>æ—¥å¿—ï¼šæ ‡é¢˜ã€å†…å®¹ã€æ—¥æœŸã€ä½œè€…</p>
</li>
</ul>
<ul>
<li>å›å¤ï¼šå†…å®¹ã€æ—¥æœŸã€ä½œè€…ã€æ—¥å¿—</li>
<li>ä¸»äººå›å¤ï¼šå†…å®¹ã€æ—¥æœŸã€ä½œè€…ã€å›å¤</li>
</ul>
<h3 id="3-åˆ†æå®ä½“ä¹‹é—´çš„å…³ç³»"><a href="#3-åˆ†æå®ä½“ä¹‹é—´çš„å…³ç³»" class="headerlink" title="3.åˆ†æå®ä½“ä¹‹é—´çš„å…³ç³»"></a>3.åˆ†æå®ä½“ä¹‹é—´çš„å…³ç³»</h3><ul>
<li>ç”¨æˆ·ç™»å½•ä¿¡æ¯ ï¼š ç”¨æˆ·è¯¦æƒ…ä¿¡æ¯      1ï¼š1 PK</li>
<li>ç”¨æˆ· ï¼š æ—¥å¿—                   1ï¼šN</li>
<li>æ—¥å¿— ï¼š å›å¤                   1ï¼šN</li>
<li>å›å¤ ï¼š ä¸»äººå›å¤                1ï¼š1 UK</li>
<li>ç”¨æˆ· ï¼š å¥½å‹                   M ï¼š N</li>
</ul>
<h3 id="4-QQZone-ERå›¾"><a href="#4-QQZone-ERå›¾" class="headerlink" title="4.QQZone-ERå›¾"></a>4.QQZone-ERå›¾</h3><p><img src="/2022/09/30/JavaWeb/image-20220711112329855.png" alt="image-20220711112329855"></p>
<h3 id="5-æ•°æ®åº“çš„èŒƒå¼"><a href="#5-æ•°æ®åº“çš„èŒƒå¼" class="headerlink" title="5.æ•°æ®åº“çš„èŒƒå¼"></a>5.æ•°æ®åº“çš„èŒƒå¼</h3><p>1ï¼‰ ç¬¬ä¸€èŒƒå¼ï¼šåˆ—ä¸å¯å†åˆ†<br>2ï¼‰ ç¬¬äºŒèŒƒå¼ï¼šä¸€å¼ è¡¨åªè¡¨è¾¾ä¸€å±‚å«ä¹‰ï¼ˆåªæè¿°ä¸€ä»¶äº‹æƒ…ï¼‰<br>3ï¼‰ ç¬¬ä¸‰èŒƒå¼ï¼šè¡¨ä¸­çš„æ¯ä¸€åˆ—å’Œä¸»é”®éƒ½æ˜¯ç›´æ¥ä¾èµ–å…³ç³»ï¼Œè€Œä¸æ˜¯é—´æ¥ä¾èµ–<br>4.æ•°æ®åº“è®¾è®¡çš„èŒƒå¼å’Œæ•°æ®åº“çš„æŸ¥è¯¢æ€§èƒ½å¾ˆå¤šæ—¶å€™æ˜¯ç›¸æ‚–çš„ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®å®é™…çš„ä¸šåŠ¡æƒ…å†µåšä¸€ä¸ªé€‰æ‹©ï¼š</p>
<ul>
<li>æŸ¥è¯¢é¢‘æ¬¡ä¸é«˜çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ›´å€¾å‘äºæé«˜æ•°æ®åº“çš„è®¾è®¡èŒƒå¼ï¼Œä»è€Œæé«˜å­˜å‚¨æ•ˆç‡</li>
<li>æŸ¥è¯¢é¢‘æ¬¡è¾ƒé«˜çš„æƒ…å½¢ï¼Œæˆ‘ä»¬æ›´å€¾å‘äºç‰ºç‰²æ•°æ®åº“çš„è§„èŒƒåº¦ï¼Œé™ä½æ•°æ®åº“è®¾è®¡çš„èŒƒå¼ï¼Œå…è®¸ç‰¹å®šçš„å†—ä½™ï¼Œä»è€Œæé«˜æŸ¥è¯¢çš„æ€§èƒ½</li>
</ul>
<h3 id="6-æŸ¥è¯¢å¥½å‹åˆ—è¡¨"><a href="#6-æŸ¥è¯¢å¥½å‹åˆ—è¡¨" class="headerlink" title="6.æŸ¥è¯¢å¥½å‹åˆ—è¡¨"></a>6.æŸ¥è¯¢å¥½å‹åˆ—è¡¨</h3><p><img src="/2022/09/30/JavaWeb/image-20220711112727972.png" alt="image-20220711112727972"></p>
<h2 id="3-é¡¹ç›®åˆå§‹åŒ–å·¥ä½œ"><a href="#3-é¡¹ç›®åˆå§‹åŒ–å·¥ä½œ" class="headerlink" title="3.é¡¹ç›®åˆå§‹åŒ–å·¥ä½œ"></a>3.é¡¹ç›®åˆå§‹åŒ–å·¥ä½œ</h2><p>1.åˆ›å»ºJavaWebå·¥ç¨‹é…ç½®tomcatï¼Œå¯¼å…¥MySQLçš„jaråŒ…é©±åŠ¨å’Œthyenleafçš„jaråŒ…ï¼Œå°†å…¶è®¾ç½®ä¸ºlibraryï¼Œå°†åœ¨libraryæ·»åŠ åˆ°è¯¥å·¥ç¨‹ä¾èµ–</p>
<p>2.å°†myssmåŠ å…¥è¿›æ¥</p>
<img src="/2022/09/30/JavaWeb/image-20220711114002663.png" alt="image-20220711114002663" style="zoom: 67%;">

<p><strong>ç›‘å¬å™¨listeners</strong>ï¼šåœ¨ä¸Šä¸‹æ–‡åˆ›å»ºæ—¶å³Tomcatå¼€å¯æ—¶ï¼Œè°ƒç”¨å…¶ä¸­çš„contextInitializedåˆå§‹æ–¹æ³•</p>
<ul>
<li><p>åˆ›å»ºIOCå®¹å™¨</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">BeanFactory</span> <span class="variable">beanFactory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(path);</span><br></pre></td></tr></table></figure>
</li>
<li><p>å°†IOCå®¹å™¨ä¿å­˜åˆ°applicationä½œç”¨åŸŸ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">application.setAttribute(<span class="string">&quot;beanFactory&quot;</span>,beanFactory);</span><br></pre></td></tr></table></figure></li>
</ul>
<p><strong>ioc</strong>ï¼šé€šè¿‡è¯»å–é…ç½®æ–‡ä»¶applicationContextï¼Œä¸ºå…¶ä¸­çš„ç±»å’Œå³ç±»çš„å±æ€§åˆ›å»ºå®ä¾‹ï¼Œå¹¶ä¿å­˜åœ¨beanMapä¸­ï¼ˆå®¹å™¨ï¼‰</p>
<p><strong>filtersè¿‡æ»¤å™¨</strong>ï¼šè®¾ç½®ç¼–ç ã€å¼€å¯äº‹åŠ¡ã€æäº¤äº‹åŠ¡ã€å›æ»šäº‹åŠ¡</p>
<p><strong>basedao</strong>ï¼šConnUtilåˆ›å»ºæ•°æ®åº“è¿æ¥ï¼ŒBaseDAOæä¾›æ“ä½œæ•°æ®çš„åŸºæœ¬æ¥å£å®ç°</p>
<p><strong>myspringmvc</strong>ï¼š</p>
<ul>
<li><p>DispatcherServletä¸­å¤®æ§åˆ¶å™¨ï¼šè·å–å®¢æˆ·ç«¯å‘æ¥çš„è¯·æ±‚ï¼Œé¦–å…ˆæå–è¯·æ±‚ä¸­xxx.doï¼Œä»applicationä½œç”¨åŸŸä¸­ä¿å­˜çš„IOCå®¹å™¨é‡Œå–å‡ºxxxå¯¹åº”çš„å®ä¾‹ï¼Œåœ¨æå–è¯·æ±‚ä¸­operateå’Œæ–¹æ³•å‚æ•°ï¼Œå®ç°xxxå®ä¾‹ä¸­operateå¯¹åº”çš„æ–¹æ³•</p>
</li>
<li><p>ViewBaseServletï¼šé€šè¿‡åŠ å…¥å‰åç¼€æ‰¾åˆ°æŒ‡å®šé¡µé¢ï¼Œé…åˆthyemleafå°†æ•°æ®æ¸²æŸ“åœ¨æŒ‡å®šé¡µé¢ä¸Šï¼Œå“åº”ç»™å®¢æˆ·ç«¯</p>
</li>
<li><p>pageControllerï¼šç”±äºæœ‰äº›é¡µé¢ç›´æ¥è®¿é—®xxx.htmlï¼Œæ²¡æœ‰ç»è¿‡æœåŠ¡å™¨ViewBaseServletï¼Œæ²¡æœ‰åˆ›å»ºthyemleafå®ä¾‹ï¼Œæ— æ³•ä½¿ç”¨thyemleafè¯­æ³•ï¼Œå› æ­¤æ”¹è¿›ï¼Œå°†è¿™äº›ç›´æ¥è®¿é—®çš„é¡µé¢éƒ½å…ˆå‘é€è‡³è¿™ä¸ªé¡µé¢ï¼ˆpage.doï¼‰</p>
<p>è¯·æ±‚ï¼š<a target="_blank" rel="noopener" href="http://localhost:8080/pro22/page.do?operate=page&amp;page=login">http://localhost:8080/pro22/page.do?operate=page&amp;page=login</a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PageController</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">page</span><span class="params">(String page)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> page ;       <span class="comment">// frames/left</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="4-åŠŸèƒ½ä¸€å®ç°"><a href="#4-åŠŸèƒ½ä¸€å®ç°" class="headerlink" title="4.åŠŸèƒ½ä¸€å®ç°"></a>4.åŠŸèƒ½ä¸€å®ç°</h2><h3 id="åŠŸèƒ½ä¸€"><a href="#åŠŸèƒ½ä¸€" class="headerlink" title="åŠŸèƒ½ä¸€"></a>åŠŸèƒ½ä¸€</h3><ul>
<li>ç™»å½•é¡µé¢</li>
<li>ç™»å½•æˆåŠŸåçš„é¡µé¢ï¼Œæ˜¾ç¤ºå¥½å‹åˆ—è¡¨ï¼Œæ—¥å¿—åˆ—è¡¨ï¼Œé¡¶ç«¯çš„æ¬¢è¿ä¿¡æ¯</li>
<li>ç‚¹å‡»å¥½å‹åç§°è¶…é“¾æ¥å¯è¿›å…¥å…¶ç©ºé—´</li>
<li>æ˜¾ç¤ºå¥½å‹ç©ºé—´ä¸­çš„æ—¥å¿—åˆ—è¡¨ï¼Œé¡¶ç«¯æ¬¢è¿ä¿¡æ¯å’Œè¿”å›è‡ªå·±ç©ºé—´çš„è¶…é“¾æ¥</li>
</ul>
<h3 id="login-html"><a href="#login-html" class="headerlink" title="login.html"></a>login.html</h3><img src="/2022/09/30/JavaWeb/image-20220711100006670.png" alt="image-20220711100006670" style="zoom:50%;">



<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;center&quot;</span>&gt;</span>ç”¨æˆ·ç™»å½•1<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/user.do&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;get&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;operate&quot;</span> <span class="attr">value</span>=<span class="string">&quot;login&quot;</span>/&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">th</span>&gt;</span>ç”¨æˆ·åï¼š<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;loginId&quot;</span> <span class="attr">value</span>=<span class="string">&quot;u001&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">th</span>&gt;</span>å¯†ç ï¼š<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;pwd&quot;</span> <span class="attr">value</span>=<span class="string">&quot;ok&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">th</span> <span class="attr">colspan</span>=<span class="string">&quot;2&quot;</span>&gt;</span></span><br><span class="line">                          <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;ç™»å½•&quot;</span>/&gt;</span></span><br><span class="line">                          <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;è¿˜æ²¡æœ‰è´¦å·ï¼Ÿ&quot;</span>/&gt;</span></span><br><span class="line">                      <span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>å‘é€è‡³user.doï¼Œoperateä¸ºloginï¼ŒloginId&#x3D;u001ï¼Œpwd&#x3D;ok</p>
</blockquote>
<h3 id="UserController"><a href="#UserController" class="headerlink" title="UserController"></a>UserController</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> UserBasicService userBasicService ;</span><br><span class="line">    <span class="keyword">private</span> TopicService topicService ;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">login</span><span class="params">(String loginId , String pwd , HttpSession session)</span>&#123;</span><br><span class="line">        <span class="comment">//1.ç™»å½•éªŒè¯</span></span><br><span class="line">        <span class="type">UserBasic</span> <span class="variable">userBasic</span> <span class="operator">=</span> userBasicService.login(loginId, pwd); <span class="comment">//æŸ¥æ‰¾æ•°æ®åº“æ˜¯å¦æœ‰</span></span><br><span class="line">        <span class="keyword">if</span>(userBasic!=<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="comment">//1-1 è·å–ç›¸å…³çš„å¥½å‹ä¿¡æ¯</span></span><br><span class="line">            List&lt;UserBasic&gt; friendList = userBasicService.getFriendList(userBasic);</span><br><span class="line">            <span class="comment">//1-2 è·å–ç›¸å…³çš„æ—¥å¿—åˆ—è¡¨ä¿¡æ¯(ä½†æ˜¯ï¼Œæ—¥å¿—åªæœ‰idï¼Œæ²¡æœ‰å…¶ä»–ä¿¡æ¯ï¼‰</span></span><br><span class="line">            List&lt;Topic&gt; topicList = topicService.getTopicList(userBasic);</span><br><span class="line"></span><br><span class="line">            userBasic.setFriendList(friendList);</span><br><span class="line">            userBasic.setTopicList(topicList);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//userBasicè¿™ä¸ªkeyä¿å­˜çš„æ˜¯ç™»é™†è€…çš„ä¿¡æ¯</span></span><br><span class="line">            <span class="comment">//friendè¿™ä¸ªkeyä¿å­˜çš„æ˜¯å½“å‰è¿›å…¥çš„æ˜¯è°çš„ç©ºé—´</span></span><br><span class="line">            session.setAttribute(<span class="string">&quot;userBasic&quot;</span>,userBasic);</span><br><span class="line">            session.setAttribute(<span class="string">&quot;friend&quot;</span>,userBasic);</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>; <span class="comment">//æˆåŠŸåè¿”å›åˆ°ä¸­å¤®æ§åˆ¶å™¨ï¼Œå°†å“åº”index.htmlç»™å®¢æˆ·ç«¯</span></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;login&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">	<span class="keyword">public</span> String <span class="title function_">friend</span><span class="params">(Integer id, HttpSession session)</span>&#123;</span><br><span class="line">        <span class="comment">//1.æ ¹æ®idè·å–æŒ‡å®šçš„ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">        <span class="type">UserBasic</span> <span class="variable">currFriend</span> <span class="operator">=</span> userBasicService.getUserBasicById(id);</span><br><span class="line">		<span class="comment">//2.æŸ¥è¯¢å¯¹åº”æ—¥å¿—åˆ—è¡¨</span></span><br><span class="line">        List&lt;Topic&gt; topicList = topicService.getTopicList(currFriend);</span><br><span class="line">		<span class="comment">//3.æ·»åŠ èµ‹å€¼</span></span><br><span class="line">        currFriend.setTopicList(topicList);</span><br><span class="line">		<span class="comment">//4.è¦†ç›–sessionä¸­friend</span></span><br><span class="line">        session.setAttribute(<span class="string">&quot;friend&quot;</span>,currFriend);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>UserControllerä¸­æœ‰ä¸¤ä¸ªä¸šåŠ¡å±æ€§ï¼Œä¸ºæ§åˆ¶å™¨æœåŠ¡</p>
<h3 id="index-html"><a href="#index-html" class="headerlink" title="index.html"></a>index.html</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;div_top&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">iframe</span>  <span class="attr">th:src</span>=<span class="string">&quot;@&#123;/page.do?operate=page&amp;page=frames/top&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;div_left&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">th:src</span>=<span class="string">&quot;@&#123;/page.do?operate=page&amp;page=frames/left&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;div_main&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">th:src</span>=<span class="string">&quot;@&#123;/page.do?operate=page&amp;page=frames/main&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;div_bottom&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;center&quot;</span> &gt;</span>ç‰ˆæƒæ‰€æœ‰<span class="symbol">&amp;reg;</span>ï¼Œæ¬¢è¿ç›—ç‰ˆ<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>indexé¡µé¢ä¸­æœ‰å››ä¸ªæ¿å—div_topã€div_leftã€div_mainã€div_bottom</p>
<p>å…¶ä¸­ä¸‰ä¸ªdiv_topã€div_leftã€div_mainé¡µé¢ä¼šå†å»è¯·æ±‚å“åº”çš„é¡µé¢</p>
<h3 id="main-html"><a href="#main-html" class="headerlink" title="main.html"></a>main.html</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;div_topic_list&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;div_to_add&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;right8&quot;</span>&gt;</span>å‘è¡¨æ–°æ—¥å¿—<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">id</span>=<span class="string">&quot;tbl_topic_list&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>ID<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>æ ‡é¢˜<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>æ—¥æœŸ<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>æ“ä½œ<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span> <span class="attr">th:if</span>=<span class="string">&quot;$&#123;#lists.isEmpty(session.friend.topicList)&#125;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span> <span class="attr">colspan</span>=<span class="string">&quot;4&quot;</span>&gt;</span>æš‚æ— æ—¥å¿—åˆ—è¡¨<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span> <span class="attr">th:unless</span>=<span class="string">&quot;$&#123;#lists.isEmpty(session.friend.topicList)&#125;&quot;</span> <span class="attr">th:each</span>=<span class="string">&quot;topic : $&#123;session.friend.topicList&#125;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;topic.id&#125;&quot;</span>&gt;</span>2<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">&quot;left&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;topic.title&#125;&quot;</span>&gt;</span>æˆ‘ä¹”å³°è¦èµ°ï¼Œä½ ä»¬è°å¯é˜»æ‹¦<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;topic.topicDate&#125;&quot;</span>&gt;</span>2021-09-01 12:30:55<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;åˆ é™¤&quot;</span> &lt;/<span class="attr">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>topicListä»sessionä¸­friendè·å–ï¼Œæ— è®ºè‡ªå·±å’Œåˆ«äººçš„ç©ºé—´ï¼ŒtopicListéƒ½æ˜¯å¯¹åº”çš„ï¼Œè€ŒfriendListåªæ˜¾ç¤ºè‡ªå·±çš„å¥½å‹åˆ—è¡¨</p>
<p>è¿™é‡Œåˆ é™¤æ—¥å¿—åŠŸèƒ½è¿˜æœªå®ç°ï¼Œä¸‹é¢å®ç°</p>
</blockquote>
<h3 id="left-html"><a href="#left-html" class="headerlink" title="left.html"></a>left.html</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;div_friendList&quot;</span> &gt;</span></span><br><span class="line">       æˆ‘çš„å¥½å‹<span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">li</span> <span class="attr">th:if</span>=<span class="string">&quot;$&#123;#lists.isEmpty(session.userBasic.friendList)&#125;&quot;</span>&gt;</span>ä¸€ä¸ªå¥½å‹ä¹Ÿæ²¡æœ‰<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">li</span> <span class="attr">th:unless</span>=<span class="string">&quot;$&#123;#lists.isEmpty(session.userBasic.friendList)&#125;&quot;</span> <span class="attr">th:each</span>=<span class="string">&quot;friend : $&#123;session.userBasic.friendList&#125;&quot;</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;|/user.do?operate=friend&amp;id=$&#123;friend.id&#125;|&#125;&quot;</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;friend.nickName&#125;&quot;</span> <span class="attr">target</span>=<span class="string">&quot;_top&quot;</span>&gt;</span>å¼ ä¸‰<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>friendListä»sessionä¸­userBasicè·å–</p>
<p>åå­—è®¾ç½®è¶…é“¾æ¥ï¼Œå¯è¿›å…¥åˆ«äººçš„ç©ºé—´ã€‚</p>
<p>å‘é€è¯·æ±‚ï¼š&#x2F;user.do?operate&#x3D;friend&amp;id&#x3D;${friend.id} ï¼Œé‡æ–°è¦†ç›–friendï¼Œæ›´æ–°å…¶idå’Œæ—¥å¿—åˆ—è¡¨</p>
</blockquote>
<h3 id="top-html"><a href="#top-html" class="headerlink" title="top.html"></a>top.html</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;top_title&quot;</span> &gt;</span>æ¬¢è¿æ¥åˆ°QQZone1ï¼<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;top_link_div&quot;</span> &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">&quot;|æ¬¢è¿è¿›å…¥$&#123;session.friend.nickName&#125;çš„ç©ºé—´ï¼|&quot;</span>&gt;</span>æ¬¢è¿è¿›å…¥Jimçš„ç©ºé—´ï¼<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        åˆ¤æ–­è¿›å…¥çš„æ˜¯å¦æ˜¯è‡ªå·±çš„ç©ºé—´çš„ä¾æ®æ˜¯ï¼š</span></span><br><span class="line"><span class="comment">        userBasicå’Œfriendè¿™ä¸¤ä¸ªkeyä¸­ä¿å­˜çš„UserBasicæ˜¯å¦ä¸€è‡´</span></span><br><span class="line"><span class="comment">        </span></span><br><span class="line"><span class="comment">        userBasic:&lt;span th:text=&quot;$&#123;session.userBasic.id&#125;&quot;&gt;&lt;/span&gt;&lt;br/&gt;</span></span><br><span class="line"><span class="comment">        friend:&lt;span th:text=&quot;$&#123;session.friend.id&#125;&quot;&gt;&lt;/span&gt;&lt;br/&gt;</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">th:if</span>=<span class="string">&quot;$&#123;session.userBasic.id!=session.friend.id&#125;&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;|/user.do?operate=friend&amp;id=$&#123;session.userBasic.id&#125;|&#125;&quot;</span> <span class="attr">target</span>=<span class="string">&quot;_top&quot;</span>&gt;</span>è¿”å›è‡ªå·±çš„ç©ºé—´!<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>top.htmlé¡µé¢æ˜¾ç¤ºç™»å½•è€…æ˜µç§°ã€åˆ¤æ–­æ˜¯å¦æ˜¯è‡ªå·±çš„ç©ºé—´<br>1)æ˜¾ç¤ºç™»å½•è€…æ˜µç§°ï¼š ${session.userBasic.nickName}<br>2)åˆ¤æ–­æ˜¯å¦æ˜¯è‡ªå·±çš„ç©ºé—´ : ${session.userBasic.id!&#x3D;session.friend.id}</p>
<p>å¦‚æœè¿™é‡Œä¸æ˜¯è‡ªå·±ç©ºé—´ï¼Œåˆ™session.userBasic.idä¸ç­‰äºsession.friend.idï¼Œï¼Œæ˜¾ç¤ºâ€œè¿”å›è‡ªå·±ç©ºé—´ï¼â€çš„æ–‡å­—è¶…é“¾æ¥ </p>
<p>ç‚¹å‡»åå‘é€&#x2F;user.do?operate&#x3D;friend&amp;id&#x3D;${session.userBasic.id} ,é‡å†™è¦†ç›–friendï¼Œæ›´æ–°å…¶idå’Œæ—¥å¿—åˆ—è¡¨</p>
</blockquote>
<h3 id="å®ç°åŠŸèƒ½ä¸€çš„é—®é¢˜"><a href="#å®ç°åŠŸèƒ½ä¸€çš„é—®é¢˜" class="headerlink" title="å®ç°åŠŸèƒ½ä¸€çš„é—®é¢˜"></a>å®ç°åŠŸèƒ½ä¸€çš„é—®é¢˜</h3><p>1ï¼‰URLæ²¡ä¿®æ”¹ï¼Œç”¨çš„è¿˜æ˜¯fruitdb<br>2ï¼‰å¿˜è®°åˆ«åï¼ŒuserBasicå±æ€§ä¸­æ²¡æœ‰fidï¼Œåªæœ‰idå±æ€§</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> List&lt;UserBasic&gt; <span class="title function_">getUserBasicList</span><span class="params">(UserBasic userBasic)</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;SELECT fid as &#x27;id&#x27; FROM t_friend WHERE uid = ?&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">super</span>.executeQuery(sql,userBasic.getId());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 3ï¼‰rsmd.getColumnNameï¼šåªèƒ½æ˜¾ç¤ºåˆ—åã€rsmd.getColumnLabel()ï¼šæœ‰åˆ«åæ˜¾ç¤ºåˆ«åï¼Œæ²¡æœ‰åˆ«åæ˜¾ç¤ºåˆ—å<br> 4ï¼‰Can not set com.atguigu.qqzone.pojo.UserBasic field com.atguigu.qqzone.pojo.Topic.author to java.lang.Integer</p>
<p>5ï¼‰left.htmlé¡µé¢æ²¡æœ‰æ ·å¼ï¼ŒåŒæ—¶æ•°æ®ä¹Ÿä¸å±•ç¤ºï¼ŒåŸå› æ˜¯ï¼šæˆ‘ä»¬æ˜¯ç›´æ¥å»è¯·æ±‚çš„é™æ€é¡µé¢èµ„æºï¼Œé‚£ä¹ˆå¹¶æ²¡æœ‰æ‰§è¡Œsuper.processTemplate()ï¼Œä¹Ÿå°±æ˜¯thymeleafæ²¡æœ‰èµ·ä½œç”¨<br>(ä¹‹å‰çš„è¡¨å•ä¹Ÿæ˜¯è¿™ä¸ªåŸå› )<br>è§£å†³æ–¹æ³•ï¼š</p>
<ul>
<li><p>æ–°å¢PageControllerï¼Œæ·»åŠ pageæ–¹æ³•:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">page</span><span class="params">(String page)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> page ;       <span class="comment">// frames/left</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç›®çš„æ˜¯æ‰§è¡Œsuper.processTemplate()æ–¹æ³•ï¼Œè®©thymeleafç”Ÿæ•ˆ</p>
</li>
</ul>
<p>6ï¼‰ç‚¹å‡»å·¦ä¾§çš„å¥½å‹é“¾æ¥ï¼Œè¿›å…¥å¥½å‹ç©ºé—´</p>
<ol>
<li>æ ¹æ®idè·å–æŒ‡å®šuserBasicä¿¡æ¯ï¼ŒæŸ¥è¯¢è¿™ä¸ªuserBasicçš„topicListï¼Œç„¶åè¦†ç›–friendå¯¹åº”çš„value</li>
<li>mainé¡µé¢åº”è¯¥å±•ç¤ºfriendä¸­çš„topicListï¼Œè€Œä¸æ˜¯userBasicä¸­çš„topicList</li>
<li>è·³è½¬åï¼Œåœ¨å·¦ä¾§ï¼ˆleftï¼‰ä¸­æ˜¾ç¤ºæ•´ä¸ªindexé¡µé¢<ul>
<li>é—®é¢˜ï¼šåœ¨lefté¡µé¢æ˜¾ç¤ºæ•´ä¸ªindexå¸ƒå±€</li>
<li>è§£å†³ï¼šç»™è¶…é“¾æ¥æ·»åŠ targetå±æ€§ï¼š   target&#x3D;â€_topâ€ ä¿è¯åœ¨é¡¶å±‚çª—å£æ˜¾ç¤ºæ•´ä¸ªindexé¡µé¢</li>
</ul>
</li>
<li>top.htmlé¡µé¢éœ€è¦ä¿®æ”¹ï¼š â€œæ¬¢è¿è¿›å…¥${session.friend}â€<br>top.htmlé¡µé¢çš„è¿”å›è‡ªå·±ç©ºé—´çš„è¶…é“¾æ¥éœ€è¦ä¿®æ”¹ï¼š<a th:href="@{|/user.do?operate=friend&id=${session.userBasic.id}|}" target="_top"></a></li>
</ol>
<p>7ï¼‰è¡¥å……targetç”¨æ³•</p>
<p><img src="/2022/09/30/JavaWeb/image-20220710105146793.png" alt="image-20220710105146793"></p>
<h2 id="5-åŠŸèƒ½äºŒå®ç°"><a href="#5-åŠŸèƒ½äºŒå®ç°" class="headerlink" title="5.åŠŸèƒ½äºŒå®ç°"></a>5.åŠŸèƒ½äºŒå®ç°</h2><h3 id="åŠŸèƒ½äºŒ"><a href="#åŠŸèƒ½äºŒ" class="headerlink" title="åŠŸèƒ½äºŒ"></a>åŠŸèƒ½äºŒ</h3><p>æ˜¾ç¤ºæ—¥å¿—è¯¦æƒ…é¡µé¢ï¼ˆdetail.htmlï¼‰****</p>
<ul>
<li>æ—¥å¿—ä½œè€…å’Œä½œè€…å¤´åƒã€æ—¥å¿—æ ‡é¢˜ã€æ—¥å¿—å†…å®¹ã€æ—¥å¿—å‘å¸ƒæ—¶é—´</li>
<li>å›å¤ä½œè€…å’Œä½œè€…å¤´åƒã€å›å¤æ ‡é¢˜ã€å›å¤å†…å®¹ã€å›å¤æ—¶é—´</li>
</ul>
<p><strong>æ—¥å¿—è¯¦æƒ…é¡µé¢å®ç°å’Œè§£å†³é—®é¢˜</strong></p>
<ol>
<li>å·²çŸ¥topicçš„idï¼Œéœ€è¦æ ¹æ®topicçš„idè·å–ç‰¹å®štopic</li>
<li>è·å–è¿™ä¸ªtopicå…³è”çš„æ‰€æœ‰çš„å›å¤</li>
<li>å¦‚æœæŸä¸ªå›å¤æœ‰ä¸»äººå›å¤ï¼Œéœ€è¦æŸ¥è¯¢å‡ºæ¥</li>
</ol>
<ul>
<li>åœ¨TopicControllerä¸­è·å–æŒ‡å®šçš„topic</li>
<li>å…·ä½“è¿™ä¸ªtopicä¸­å…³è”å¤šå°‘ä¸ªReplyï¼Œç”±ReplyServiceå†…éƒ¨å®ç°</li>
</ul>
<ol start="4">
<li>è·å–åˆ°çš„topicä¸­çš„authoråªæœ‰idï¼Œé‚£ä¹ˆéœ€è¦åœ¨topicServiceçš„getTopicæ–¹æ³•ä¸­å°è£…ï¼Œåœ¨æŸ¥è¯¢topicæœ¬èº«ä¿¡æ¯æ—¶ï¼ŒåŒæ—¶è°ƒç”¨userBasicServiceä¸­çš„è·å–getuserBasicæ–¹æ³•ï¼Œç»™authorå±æ€§èµ‹å€¼</li>
<li>åŒç†ï¼Œåœ¨replyç±»ä¸­ä¹Ÿæœ‰authorï¼Œè€Œä¸”è¿™ä¸ªauthorä¹Ÿæ˜¯åªæœ‰idï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¹Ÿéœ€è¦æ ¹æ®idæŸ¥è¯¢å¾—åˆ°authorï¼Œæœ€åè®¾ç½®å…³è”</li>
</ol>
<h3 id="main-html-1"><a href="#main-html-1" class="headerlink" title="main.html"></a>main.html</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">tr</span> <span class="attr">th:unless</span>=<span class="string">&quot;$&#123;#lists.isEmpty(session.friend.topicList)&#125;&quot;</span> <span class="attr">th:each</span>=<span class="string">&quot;topic : $&#123;session.friend.topicList&#125;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;topic.id&#125;&quot;</span>&gt;</span>2<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">&quot;left&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;|/topic.do?operate=topicDetail&amp;id=$&#123;topic.id&#125;|&#125;&quot;</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;topic.title&#125;&quot;</span>&gt;</span>æˆ‘ä¹”å³°è¦èµ°ï¼Œä½ ä»¬è°å¯é˜»æ‹¦<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;topic.topicDate&#125;&quot;</span>&gt;</span>2021-09-01 12:30:55<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;åˆ é™¤&quot;</span> <span class="attr">th:if</span>=<span class="string">&quot;$&#123;session.userBasic.id==session.friend.id&#125;&quot;</span> <span class="attr">th:onclick</span>=<span class="string">&quot;|delTopic($&#123;topic.id&#125;)|&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>åœ¨æ—¥å¿—æ ‡é¢˜åŠ å…¥è¶…é“¾æ¥ï¼Œè¿æ¥è‡³topic.do?operate&#x3D;topicDetail&amp;id&#x3D;${topic.id}</p>
<h3 id="TopicController"><a href="#TopicController" class="headerlink" title="TopicController"></a>TopicController</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TopicController</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> TopicService topicService ;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">topicDetail</span><span class="params">(Integer id , HttpSession session)</span>&#123;</span><br><span class="line">        <span class="type">Topic</span> <span class="variable">topic</span> <span class="operator">=</span> topicService.getTopicById(id);<span class="comment">//</span></span><br><span class="line"></span><br><span class="line">        session.setAttribute(<span class="string">&quot;topic&quot;</span>,topic); <span class="comment">//detail.htmlä¸­é€šè¿‡topicè·å–æ•°æ®</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;frames/detail&quot;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="å…³é”®æ–¹æ³•ï¼šè·å–å›å¤åˆ—è¡¨"><a href="#å…³é”®æ–¹æ³•ï¼šè·å–å›å¤åˆ—è¡¨" class="headerlink" title="å…³é”®æ–¹æ³•ï¼šè·å–å›å¤åˆ—è¡¨"></a>å…³é”®æ–¹æ³•ï¼šè·å–å›å¤åˆ—è¡¨</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReplyServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">ReplyService</span> &#123;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> List&lt;Reply&gt; <span class="title function_">getReplyListByTopicId</span><span class="params">(Integer topicId)</span> &#123;</span><br><span class="line">    List&lt;Reply&gt; replyList = replyDAO.getReplyList(<span class="keyword">new</span> <span class="title class_">Topic</span>(topicId));</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; replyList.size(); i++) &#123;</span><br><span class="line">        <span class="type">Reply</span> <span class="variable">reply</span> <span class="operator">=</span> replyList.get(i);</span><br><span class="line">        <span class="comment">//1.å°†å…³è”çš„ä½œè€…è®¾ç½®è¿›å»</span></span><br><span class="line">        <span class="type">UserBasic</span> <span class="variable">author</span> <span class="operator">=</span> userBasicService.getUserBasicById(reply.getAuthor().getId());</span><br><span class="line">        reply.setAuthor(author);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.å°†å…³è”çš„HostReplyè®¾ç½®è¿›å»</span></span><br><span class="line">        <span class="type">HostReply</span> <span class="variable">hostReply</span> <span class="operator">=</span> hostReplyService.getHostReplyByReplyId(reply.getId());</span><br><span class="line">        reply.setHostReply(hostReply);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> replyList ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="detail-html"><a href="#detail-html" class="headerlink" title="detail.html"></a>detail.html</h3><img src="/2022/09/30/JavaWeb/image-20220711100334588.png" alt="image-20220711100334588" style="zoom:50%;">

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;div_topic_info&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">th:src</span>=<span class="string">&quot;@&#123;|/imgs/$&#123;session.topic.author.headImg&#125;|&#125;&quot;</span>/&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;session.topic.author.nickName&#125;&quot;</span>&gt;</span>ä¹”å³°<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;session.topic.title&#125;&quot;</span>&gt;</span>ã€Šè§æŸä»Šå¤©å°±å’Œå¤©ä¸‹ç¾¤é›„å†³ä¸€æ­»æˆ˜ï¼Œä½ ä»¬ä¸€èµ·ä¸Šå§ï¼ã€‹<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;session.topic.topicDate&#125;&quot;</span>&gt;</span>2021-09-01 12:30:55<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;session.topic.content&#125;&quot;</span>&gt;</span>æ€æ¯å¤§ä»‡, å²‚å¯å½“ä½œä¹°å–äº¤æ˜“ï¼Ÿæ­¤ä»‡èƒ½æŠ¥ä¾¿æŠ¥, å¦‚ä¸èƒ½æŠ¥, åˆ™æˆ‘çˆ¶å­æ¯•å‘½äºæ­¤ä¾¿äº†ã€‚è¿™ç­‰è‚®è„ä¹‹äº‹, å²‚æ˜¯æˆ‘è§æ°çˆ¶å­æ‰€å±‘ä¸ºï¼Ÿ<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;div_reply_list&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">&quot;tbl_reply_info&quot;</span> <span class="attr">th:each</span>=<span class="string">&quot;reply : $&#123;session.topic.replyList&#125;&quot;</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">&quot;img48&quot;</span> <span class="attr">th:src</span>=<span class="string">&quot;@&#123;|/imgs/$&#123;reply.author.headImg&#125;|&#125;&quot;</span>/&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;h32 center&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width:100%;&quot;</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;reply.author.nickName&#125;&quot;</span>&gt;</span>æ®µèª‰<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"> <span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">&quot;|å›å¤ï¼š$&#123;session.topic.title&#125;|&quot;</span>&gt;</span>è§æŸä»Šå¤©å°±å’Œå¤©ä¸‹ç¾¤é›„å†³ä¸€æ­»æˆ˜ï¼Œä½ ä»¬ä¸€èµ·ä¸Šå§ï¼<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;title_date_right&quot;</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;reply.replyDate&#125;&quot;</span>&gt;</span>2021-09-01 14:35:15<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;reply.content&#125;&quot;</span>&gt;</span>ä½ å¯æ›¾è§è¿‡è¾¹å…³ä¹‹ä¸Šã€å®‹è¾½ç›¸äº’ä»‡æ€çš„æƒ¨çŠ¶ï¼Ÿå¯æ›¾è§è¿‡å®‹äººè¾½äººå¦»ç¦»å­æ•£ã€å®¶ç ´äººäº¡çš„æƒ…æ™¯ï¼Ÿå®‹è¾½ä¹‹é—´å¥½å®¹æ˜“ç½¢å…µæ•°åå¹´, å€˜è‹¥åˆ€å…µå†èµ·, å¥‘ä¸¹é“éª‘ä¾µå…¥å—æœ, ä½ å¯çŸ¥å°†æœ‰å¤šå°‘å®‹äººæƒ¨é­æ¨ªæ­»ï¼Ÿå¤šå°‘è¾½äººæ­»äºéå‘½ï¼Ÿ!<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">  </span><br><span class="line"> <span class="tag">&lt;<span class="name">ul</span> <span class="attr">th:if</span>=<span class="string">&quot;$&#123;reply.hostReply!=null&#125;&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">li</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;reply.hostReply.content&#125;&quot;</span>&gt;</span>ä½ ä»¥ä¸ºæˆ‘æ˜¯æ…•å®¹å¤çš„äººï¼Œæ‰€ä»¥å’Œæˆ‘æ¯”è¯•ï¼Ÿæ®µå…„å¼Ÿå¹´çºªè½»è½»ï¼Œå°±æœ‰å¦‚æ­¤æ­¦å­¦ä¿®ä¸ºï¼Œå®å±ç½•è§ï¼æ­¦æ—æ—©å·²ç››ä¼ å¤§ç†æ®µæ°æœ‰ä¸€é—¨ç»å­¦ï¼Œå«å…­è„‰ç¥å‰‘ï¼Œèƒ½ä»¥æ— å½¢å‰‘æ°”æ€äººï¼Œæœç„¶çœŸæœ‰æ­¤é—¨ç¥åŠŸï¼<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">li</span>  <span class="attr">th:text</span>=<span class="string">&quot;|ä¸»äººå›å¤äº$&#123;reply.hostReply.hostReplyDate&#125;|&quot;</span>&gt;</span>ä¸»äººå›å¤äº2021/10/01 11:50:30<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:id</span>=<span class="string">&quot;|a$&#123;reply.id&#125;|&quot;</span> <span class="attr">th:unless</span>=<span class="string">&quot;$&#123;reply.hostReply!=null&#125;&quot;</span>  <span class="attr">href</span>=<span class="string">&quot;#&quot;</span> <span class="attr">style</span>=<span class="string">&quot;float: right;display: none;&quot;</span>&gt;</span>ä¸»äººå›å¤<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä¸»äººå›å¤æ“ä½œæœ¬é¡¹ç›®æ²¡æœ‰å®ç°ï¼Œç•™ç»™åŒå­¦ä»¬å®ç°</p>
</blockquote>
<h2 id="6-åŠŸèƒ½ä¸‰å®ç°"><a href="#6-åŠŸèƒ½ä¸‰å®ç°" class="headerlink" title="6.åŠŸèƒ½ä¸‰å®ç°"></a>6.åŠŸèƒ½ä¸‰å®ç°</h2><h3 id="åŠŸèƒ½ä¸‰"><a href="#åŠŸèƒ½ä¸‰" class="headerlink" title="åŠŸèƒ½ä¸‰"></a>åŠŸèƒ½ä¸‰</h3><ol>
<li>æ·»åŠ å›å¤</li>
<li>åˆ é™¤å›å¤<ol>
<li>å¦‚æœå›å¤æœ‰å…³è”çš„ä¸»äººå›å¤ï¼Œéœ€è¦å…ˆåˆ é™¤ä¸»äººå›å¤</li>
<li>åˆ é™¤å›å¤<br>Cannot delete or update a parent row: a foreign key constraint fails<br>(<code>qqzonedb</code>.<code>t_host_reply</code>, CONSTRAINT <code>FK_host_reply</code> FOREIGN KEY (<code>reply</code>) REFERENCES <code>t_reply</code> (<code>id</code>))<br> æˆ‘ä»¬åœ¨åˆ é™¤å›å¤è¡¨è®°å½•æ—¶ï¼Œå‘ç°åˆ é™¤å¤±è´¥ï¼ŒåŸå› æ˜¯ï¼šåœ¨ä¸»äººå›å¤è¡¨ä¸­ä»ç„¶æœ‰è®°å½•å¼•ç”¨å¾…åˆ é™¤çš„å›å¤è¿™æ¡è®°å½•<br> å¦‚æœéœ€è¦åˆ é™¤ä¸»è¡¨æ•°æ®ï¼Œéœ€è¦é¦–å…ˆåˆ é™¤å­è¡¨æ•°æ®</li>
</ol>
</li>
</ol>
<h3 id="detail-htmlâ€“æ·»åŠ å›å¤"><a href="#detail-htmlâ€“æ·»åŠ å›å¤" class="headerlink" title="detail.htmlâ€“æ·»åŠ å›å¤"></a>detail.htmlâ€“æ·»åŠ å›å¤</h3><img src="/2022/09/30/JavaWeb/image-20220711100334588.png" alt="image-20220711100334588" style="zoom:50%;">

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;div_add_reply&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;add_reply_title&quot;</span>&gt;</span>æ·»åŠ å›å¤<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;reply.do&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;operate&quot;</span> <span class="attr">value</span>=<span class="string">&quot;addReply&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;topicId&quot;</span> <span class="attr">th:value</span>=<span class="string">&quot;$&#123;session.topic.id&#125;&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span> <span class="attr">style</span>=<span class="string">&quot;width: 25%&quot;</span>&gt;</span>å›å¤æ—¥å¿—ï¼š<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">th:value</span>=<span class="string">&quot;|ã€Š$&#123;session.topic.title&#125;ã€‹|&quot;</span> <span class="attr">value</span>=<span class="string">&quot;ã€Šè§æŸä»Šå¤©å°±å’Œå¤©ä¸‹ç¾¤é›„å†³ä¸€æ­»æˆ˜ï¼Œä½ ä»¬ä¸€èµ·ä¸Šå§ï¼ã€‹&quot;</span> <span class="attr">readonly</span> /&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>å›å¤å†…å®¹1ï¼š<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">textarea</span> <span class="attr">name</span>=<span class="string">&quot;content&quot;</span> <span class="attr">rows</span>=<span class="string">&quot;3&quot;</span>&gt;</span>è¿™é‡Œæ˜¯å¦ä¸€ä¸ªå›å¤ï¼<span class="tag">&lt;/<span class="name">textarea</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span> <span class="attr">colspan</span>=<span class="string">&quot;2&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot; å› å¤ &quot;</span>/&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;reset&quot;</span> <span class="attr">value</span>=<span class="string">&quot; é‡ ç½® &quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>å°†å‘é€è¿™äº›æ•°æ®å€¼æœåŠ¡å™¨ReplyControllerï¼š</p>
<p>reply.do ,operate&#x3D;addReplyï¼Œä¸¤ä¸ªå±æ€§ï¼šname&#x3D;â€topicIdâ€ th:value&#x3D;â€${session.topic.id}â€  name&#x3D;â€contentâ€</p>
</blockquote>
<h3 id="ReplyController"><a href="#ReplyController" class="headerlink" title="ReplyController"></a>ReplyController</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReplyController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ReplyService replyService ;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">addReply</span><span class="params">(String content ,Integer topicId , HttpSession session)</span>&#123;</span><br><span class="line">        <span class="type">UserBasic</span> <span class="variable">author</span> <span class="operator">=</span> (UserBasic)session.getAttribute(<span class="string">&quot;userBasic&quot;</span>);</span><br><span class="line">        <span class="type">Reply</span> <span class="variable">reply</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Reply</span>(content , <span class="keyword">new</span> <span class="title class_">Date</span>() , author , <span class="keyword">new</span> <span class="title class_">Topic</span>(topicId));</span><br><span class="line">        replyService.addReply(reply);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;redirect:topic.do?operate=topicDetail&amp;id=&quot;</span>+topicId;</span><br><span class="line">        <span class="comment">// ä¸èƒ½ç›´æ¥è·³è½¬detail.htmlï¼Œå› ä¸ºåˆšåŠ å…¥çš„å›å¤sessionä¸­çš„topicè¿˜æ²¡æ›´æ–°ï¼Œæ‰€ä»¥å¾—é‡æ–°æŸ¥ä¸€é</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">delReply</span><span class="params">(Integer replyId , Integer topicId)</span>&#123;</span><br><span class="line">        replyService.delReply(replyId);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;redirect:topic.do?operate=topicDetail&amp;id=&quot;</span>+topicId;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="detail-htmlâ€“åˆ é™¤å›å¤"><a href="#detail-htmlâ€“åˆ é™¤å›å¤" class="headerlink" title="detail.htmlâ€“åˆ é™¤å›å¤"></a>detail.htmlâ€“åˆ é™¤å›å¤</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">language</span>=<span class="string">&quot;JavaScript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">function</span> <span class="title function_">showDelImg</span>(<span class="params">imgId</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">var</span> obj = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(imgId) ;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span>(obj)&#123;</span></span><br><span class="line"><span class="language-javascript">                obj.<span class="property">style</span>.<span class="property">display</span>=<span class="string">&#x27;inline&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">function</span> <span class="title function_">hiddenDelImg</span>(<span class="params">imgId</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">var</span> obj = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(imgId) ;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span>(obj)&#123;</span></span><br><span class="line"><span class="language-javascript">                obj.<span class="property">style</span>.<span class="property">display</span>=<span class="string">&#x27;none&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">function</span> <span class="title function_">delReply</span>(<span class="params">replyId , topicId</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span>(<span class="variable language_">window</span>.<span class="title function_">confirm</span>(<span class="string">&quot;æ˜¯å¦ç¡®è®¤åˆ é™¤ï¼Ÿ&quot;</span>))&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&#x27;reply.do?operate=delReply&amp;replyId=&#x27;</span>+replyId+<span class="string">&#x27;&amp;topicId=&#x27;</span>+topicId;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;div_reply_list&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">&quot;reply_title&quot;</span> <span class="attr">th:onmouseover</span>=<span class="string">&quot;|showDelImg(&#x27;img$&#123;reply.id&#125;&#x27;)|&quot;</span> <span class="attr">th:onmouseout</span>=<span class="string">&quot;|hiddenDelImg(&#x27;img$&#123;reply.id&#125;&#x27;)|&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">&quot;|å›å¤ï¼š$&#123;session.topic.title&#125;|&quot;</span>&gt;</span>è§æŸä»Šå¤©å°±å’Œå¤©ä¸‹ç¾¤é›„å†³ä¸€æ­»æˆ˜ï¼Œä½ ä»¬ä¸€èµ·ä¸Šå§ï¼<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">                            å‡ºç°åˆ é™¤è¿™ä¸ªå°å›¾æ ‡çš„æ¡ä»¶ï¼š</span></span><br><span class="line"><span class="comment">                            1. åœ¨æˆ‘è‡ªå·±çš„ç©ºé—´ï¼ˆé‚£å½“ç„¶æˆ‘å¯¹è‡ªå·±çš„ç©ºé—´æ‹¥æœ‰æ‰€æœ‰çš„æ“ä½œæƒé™ï¼‰</span></span><br><span class="line"><span class="comment">                            2. å½“å‰å›å¤çš„ä½œè€…å°±æ˜¯æˆ‘ï¼ˆé‚£æˆ‘å¯ä»¥åˆ é™¤è‡ªå·±çš„å›å¤ï¼‰</span></span><br><span class="line"><span class="comment">                         --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">img</span> <span class="attr">th:if</span>=<span class="string">&quot;$&#123;session.userBasic.id==session.friend.id || session.userBasic.id==reply.author.id&#125;&quot;</span> <span class="attr">th:id</span>=<span class="string">&quot;|img$&#123;reply.id&#125;|&quot;</span> <span class="attr">class</span>=<span class="string">&quot;delReplyImg&quot;</span> <span class="attr">th:src</span>=<span class="string">&quot;@&#123;/imgs/del.jpg&#125;&quot;</span> <span class="attr">th:onclick</span>=<span class="string">&quot;|delReply($&#123;reply.id&#125; , $&#123;session.topic.id&#125;)|&quot;</span>/&gt;</span></span><br><span class="line">       </span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;title_date_right&quot;</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;reply.replyDate&#125;&quot;</span>&gt;</span>2021-09-01 14:35:15<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ¯ä¸ªæ—¥å¿—çš„åˆ é™¤å›¾æ ‡çš„idéƒ½ä¸åŒï¼Œå› ä¸ºJavaScriptä¼šåˆ›å»ºå¯¹è±¡ä¹‹åå¯»æ‰¾å¯¹äºidçš„æ ‡ç­¾è¿›è¡Œæ“ä½œ</p>
<p>JavaScriptæ–¹æ³•ï¼šdelReply(replyId , topicId)  </p>
<ul>
<li>å‘é€è¯·æ±‚ï¼šâ€™reply.do?operate&#x3D;delReply&amp;replyId&#x3D;â€™+replyId+â€™&amp;topicId&#x3D;â€™+topicId;</li>
</ul>
</blockquote>
<h3 id="ReplyController-1"><a href="#ReplyController-1" class="headerlink" title="ReplyController"></a>ReplyController</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReplyController</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> ReplyService replyService ;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">delReply</span><span class="params">(Integer replyId , Integer topicId)</span>&#123;</span><br><span class="line">        replyService.delReply(replyId);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;redirect:topic.do?operate=topicDetail&amp;id=&quot;</span>+topicId;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ReplyServiceImpl"><a href="#ReplyServiceImpl" class="headerlink" title="ReplyServiceImpl"></a>ReplyServiceImpl</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReplyServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">ReplyService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ReplyDAO replyDAO ;</span><br><span class="line">    <span class="comment">//æ­¤å¤„å¼•å…¥çš„æ˜¯å…¶ä»–POJOå¯¹åº”çš„Serviceæ¥å£ï¼Œè€Œä¸æ˜¯DAOæ¥å£</span></span><br><span class="line">    <span class="comment">//å…¶ä»–POJOå¯¹åº”çš„ä¸šåŠ¡é€»è¾‘æ˜¯å°è£…åœ¨serviceå±‚çš„ï¼Œæˆ‘éœ€è¦è°ƒç”¨åˆ«äººçš„ä¸šåŠ¡é€»è¾‘æ–¹æ³•ï¼Œè€Œä¸è¦å»æ·±å…¥è€ƒè™‘äººå®¶å†…éƒ¨çš„ç»†èŠ‚</span></span><br><span class="line">    <span class="keyword">private</span> HostReplyService hostReplyService ;</span><br><span class="line">    <span class="keyword">private</span> UserBasicService userBasicService ;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delReply</span><span class="params">(Integer id)</span> &#123;</span><br><span class="line">        <span class="comment">//1.æ ¹æ®idè·å–åˆ°reply</span></span><br><span class="line">        <span class="type">Reply</span> <span class="variable">reply</span> <span class="operator">=</span> replyDAO.getReply(id);</span><br><span class="line">        <span class="keyword">if</span>(reply!=<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="comment">//2.å¦‚æœreplyæœ‰å…³è”çš„hostReplyï¼Œåˆ™å…ˆåˆ é™¤hostReply</span></span><br><span class="line">            <span class="type">HostReply</span> <span class="variable">hostReply</span> <span class="operator">=</span> hostReplyService.getHostReplyByReplyId(reply.getId());</span><br><span class="line">            <span class="keyword">if</span>(hostReply!=<span class="literal">null</span>)&#123;</span><br><span class="line">                hostReplyService.delHostReply(hostReply.getId());</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//3.åˆ é™¤reply</span></span><br><span class="line">            replyDAO.delReply(id);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>delReplyæ–¹æ³•ï¼šå¦‚æœå›å¤æœ‰å…³è”çš„ä¸»äººå›å¤ï¼Œéœ€è¦å…ˆåˆ é™¤ä¸»äººå›å¤</p>
</blockquote>
<h2 id="åŠŸèƒ½å››å®ç°"><a href="#åŠŸèƒ½å››å®ç°" class="headerlink" title="åŠŸèƒ½å››å®ç°"></a>åŠŸèƒ½å››å®ç°</h2><h3 id="åŠŸèƒ½å››"><a href="#åŠŸèƒ½å››" class="headerlink" title="åŠŸèƒ½å››"></a>åŠŸèƒ½å››</h3><p>åˆ é™¤æ—¥å¿—</p>
<ol>
<li>åˆ é™¤æ—¥å¿—ï¼Œé¦–å…ˆéœ€è¦è€ƒè™‘æ˜¯å¦æœ‰å…³è”çš„å›å¤</li>
<li>åˆ é™¤å›å¤ï¼Œé¦–å…ˆéœ€è¦è€ƒè™‘æ˜¯å¦æœ‰å…³è”çš„ä¸»äººå›å¤</li>
<li>å¦å¤–ï¼Œå¦‚æœä¸æ˜¯è‡ªå·±çš„ç©ºé—´ï¼Œåˆ™ä¸èƒ½åˆ é™¤æ—¥å¿—</li>
</ol>
<h3 id="main-html-2"><a href="#main-html-2" class="headerlink" title="main.html"></a>main.html</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">language</span>=<span class="string">&quot;JavaScript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">function</span> <span class="title function_">delTopic</span>(<span class="params">topicId</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span>(<span class="variable language_">window</span>.<span class="title function_">confirm</span>(<span class="string">&quot;æ˜¯å¦ç¡®è®¤åˆ é™¤æ—¥å¿—ï¼Ÿ&quot;</span>))&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;topic.do?operate=delTopic&amp;topicId=&quot;</span>+topicId;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span> <span class="attr">th:if</span>=<span class="string">&quot;$&#123;#lists.isEmpty(session.friend.topicList)&#125;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">th</span> <span class="attr">colspan</span>=<span class="string">&quot;4&quot;</span>&gt;</span>æš‚æ— æ—¥å¿—åˆ—è¡¨<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span> <span class="attr">th:unless</span>=<span class="string">&quot;$&#123;#lists.isEmpty(session.friend.topicList)&#125;&quot;</span> <span class="attr">th:each</span>=<span class="string">&quot;topic : $&#123;session.friend.topicList&#125;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;åˆ é™¤&quot;</span> <span class="attr">th:if</span>=<span class="string">&quot;$&#123;session.userBasic.id==session.friend.id&#125;&quot;</span> <span class="attr">th:onclick</span>=<span class="string">&quot;|delTopic($&#123;topic.id&#125;)|&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="TopicController-1"><a href="#TopicController-1" class="headerlink" title="TopicController"></a>TopicController</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TopicController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> TopicService topicService ;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">delTopic</span><span class="params">(Integer topicId)</span>&#123;</span><br><span class="line">        topicService.delTopic(topicId);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;redirect:topic.do?operate=getTopicList&quot;</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getTopicList</span><span class="params">(HttpSession session)</span>&#123;</span><br><span class="line">        <span class="comment">//ä»sessionä¸­è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">        <span class="type">UserBasic</span> <span class="variable">userBasic</span> <span class="operator">=</span> (UserBasic)session.getAttribute(<span class="string">&quot;userBasic&quot;</span>);</span><br><span class="line">        <span class="comment">//å†æ¬¡æŸ¥è¯¢å½“å‰ç”¨æˆ·å…³è”çš„æ‰€æœ‰çš„æ—¥å¿—</span></span><br><span class="line">        List&lt;Topic&gt; topicList = topicService.getTopicList(userBasic);</span><br><span class="line">        <span class="comment">//è®¾ç½®ä¸€ä¸‹å…³è”çš„æ—¥å¿—åˆ—è¡¨(å› ä¸ºä¹‹å‰sessionä¸­å…³è”çš„friendçš„topicListå’Œæ­¤åˆ»æ•°æ®åº“ä¸­ä¸ä¸€è‡´ï¼‰</span></span><br><span class="line">        userBasic.setTopicList(topicList);</span><br><span class="line">        <span class="comment">//é‡æ–°è¦†ç›–ä¸€ä¸‹friendä¸­çš„ä¿¡æ¯(ä¸ºä»€ä¹ˆä¸è¦†ç›–userbasicä¸­ï¼Ÿå› ä¸ºmain.htmlé¡µé¢è¿­ä»£çš„æ˜¯friendè¿™ä¸ªkeyä¸­çš„æ•°æ®)</span></span><br><span class="line">        session.setAttribute(<span class="string">&quot;friend&quot;</span>,userBasic);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;frames/main&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¿™é‡Œæ˜¯åˆ é™¤å®Œæ—¥å¿—åä¸èƒ½ç›´æ¥è®¿é—®main.htmlï¼Œå› ä¸ºå…¶ä¸­sessionä¸­friendçš„topicListè¿˜æ²¡æ›´æ–°ï¼Œæ‰€ä»¥å†æ¬¡è¯·æ±‚ï¼Œå®ŒæˆgetTopicListæ–¹æ³•ï¼Œæ›´æ–°topicList</p>
</blockquote>
<h3 id="TopicServiceImpl"><a href="#TopicServiceImpl" class="headerlink" title="TopicServiceImpl"></a>TopicServiceImpl</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TopicServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">TopicService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">TopicDAO</span> <span class="variable">topicDAO</span> <span class="operator">=</span> <span class="literal">null</span> ;</span><br><span class="line">    <span class="comment">//æ­¤å¤„å¼•ç”¨çš„æ˜¯replyServiceï¼Œè€Œä¸æ˜¯replyDAO</span></span><br><span class="line">    <span class="keyword">private</span> ReplyService replyService ;</span><br><span class="line">    <span class="keyword">private</span> UserBasicService userBasicService ;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delTopic</span><span class="params">(Integer id)</span> &#123;</span><br><span class="line">    <span class="type">Topic</span> <span class="variable">topic</span> <span class="operator">=</span> topicDAO.getTopic(id);</span><br><span class="line">    <span class="keyword">if</span>(topic!=<span class="literal">null</span>)&#123;</span><br><span class="line">        replyService.delReplyList(topic); <span class="comment">//åˆ é™¤æ—¥å¿—å…ˆåˆ é™¤å›å¤åˆ—è¡¨</span></span><br><span class="line">        topicDAO.delTopic(topic);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ReplyServiceImpl-1"><a href="#ReplyServiceImpl-1" class="headerlink" title="ReplyServiceImpl"></a>ReplyServiceImpl</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReplyServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">ReplyService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ReplyDAO replyDAO ;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delReplyList</span><span class="params">(Topic topic)</span> &#123;</span><br><span class="line">    List&lt;Reply&gt; replyList = replyDAO.getReplyList(topic);</span><br><span class="line">    <span class="keyword">if</span>(replyList!=<span class="literal">null</span>)&#123;</span><br><span class="line">        <span class="keyword">for</span>(Reply reply : replyList)&#123; <span class="comment">//é€ä¸ªåˆ é™¤å›å¤</span></span><br><span class="line">            delReply(reply.getId()); <span class="comment">//åˆ é™¤è¯¥æ¡å›å¤ï¼ŒåŒ…æ‹¬å›å¤å…³è”æœ‰ä¸»äººå›å¤çš„å›å¤</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="å¤ä¹ æ€»ç»“-1"><a href="#å¤ä¹ æ€»ç»“-1" class="headerlink" title="å¤ä¹ æ€»ç»“"></a>å¤ä¹ æ€»ç»“</h2><h3 id="1-æ—¥æœŸå’Œå­—ç¬¦ä¸²ä¹‹é—´çš„æ ¼å¼åŒ–"><a href="#1-æ—¥æœŸå’Œå­—ç¬¦ä¸²ä¹‹é—´çš„æ ¼å¼åŒ–" class="headerlink" title="1.æ—¥æœŸå’Œå­—ç¬¦ä¸²ä¹‹é—´çš„æ ¼å¼åŒ–"></a>1.æ—¥æœŸå’Œå­—ç¬¦ä¸²ä¹‹é—´çš„æ ¼å¼åŒ–</h3><p> String -&gt; java.util.Date</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">dateStr1</span> <span class="operator">=</span> <span class="string">&quot;2021-12-30 12:59:59&quot;</span>;</span><br><span class="line"><span class="type">SimpleDateFormat</span> <span class="variable">sdf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(<span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>);</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="type">Date</span> <span class="variable">date1</span> <span class="operator">=</span> sdf.parse(dateStr1);</span><br><span class="line">&#125; <span class="keyword">catch</span> (ParseException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Date -&gt; String</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Date</span> <span class="variable">date2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line"><span class="type">String</span> <span class="variable">dateStr2</span> <span class="operator">=</span> sdf.format(date2);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>thymeleafä¸­ä½¿ç”¨#datesè¿™ä¸ªå…¬å…±çš„å†…ç½®å¯¹è±¡ï¼Œè¿›è¡Œä¿®æ”¹ç½‘é¡µæ˜¾ç¤ºçš„æ—¶é—´æ ¼å¼<br>$</p>
</blockquote>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="mailto:undefined">Qinghai2021</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="http://example.com/2022/09/30/JavaWeb/">http://example.com/2022/09/30/JavaWeb/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="http://example.com" target="_blank">Qinghai2021Â·åšå®¢</a>ï¼</span></div></div><div class="tag_share"><div class="post_share"><div class="social-share" data-image="/images/background.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://fastly.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/10/02/%E5%B0%9A%E7%A1%85%E8%B0%B7java%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/"><img class="prev-cover" src="/images/background.jpg" onerror="onerror=null;src='https://api.ixiaowai.cn/gqapi/gqapi.php'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">Javaç¼–ç¨‹åŸºç¡€</div></div></a></div><div class="next-post pull-right"><a href="/2022/09/30/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"><img class="next-cover" src="/images/background.jpg" onerror="onerror=null;src='https://api.ixiaowai.cn/gqapi/gqapi.php'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">è®¡ç®—æœºç½‘ç»œ</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AF%BE%E7%A8%8B%E4%BD%93%E7%B3%BB%E8%AE%BE%E8%AE%A1"><span class="toc-number">1.</span> <span class="toc-text">è¯¾ç¨‹ä½“ç³»è®¾è®¡</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AF%BE%E4%BB%B6"><span class="toc-number">2.</span> <span class="toc-text">è¯¾ä»¶</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E7%9F%A5%E8%AF%86"><span class="toc-number">3.</span> <span class="toc-text">å‰ç«¯çŸ¥è¯†</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#HTML"><span class="toc-number">3.1.</span> <span class="toc-text">HTML</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#HTML%E4%B8%AD%E7%9A%84%E5%9F%BA%E7%A1%80%E6%A0%87%E7%AD%BE"><span class="toc-number">3.1.1.</span> <span class="toc-text">HTMLä¸­çš„åŸºç¡€æ ‡ç­¾</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CSS"><span class="toc-number">3.2.</span> <span class="toc-text">CSS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CSS%E7%9A%84%E8%AF%AD%E6%B3%95"><span class="toc-number">3.2.1.</span> <span class="toc-text">CSSçš„è¯­æ³•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%92%E5%AD%90%E6%A8%A1%E5%9E%8B"><span class="toc-number">3.2.2.</span> <span class="toc-text">ç›’å­æ¨¡å‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CSS%E5%B8%83%E5%B1%80"><span class="toc-number">3.2.3.</span> <span class="toc-text">CSSå¸ƒå±€</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#javascript"><span class="toc-number">3.3.</span> <span class="toc-text">javascript</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D"><span class="toc-number">3.3.1.</span> <span class="toc-text">ä»‹ç»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JavaScript%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">3.3.2.</span> <span class="toc-text">JavaScriptæ•°æ®ç±»å‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E5%A3%B0%E6%98%8E"><span class="toc-number">3.3.3.</span> <span class="toc-text">å‡½æ•°å£°æ˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%BC%A0%E6%A0%87%E6%82%AC%E6%B5%AE%E5%92%8C%E7%A6%BB%E5%BC%80"><span class="toc-number">3.3.4.</span> <span class="toc-text">é¼ æ ‡æ‚¬æµ®å’Œç¦»å¼€</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80"><span class="toc-number">3.3.4.1.</span> <span class="toc-text">æ–¹æ³•ä¸€</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C"><span class="toc-number">3.3.4.2.</span> <span class="toc-text">æ–¹æ³•äºŒ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E5%8D%95%E4%BB%B7-%E5%B0%8F%E8%AE%A1-%E6%80%BB%E8%AE%A1"><span class="toc-number">3.3.4.3.</span> <span class="toc-text">æ›´æ–°å•ä»·-å°è®¡-æ€»è®¡</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E6%8C%87%E5%AE%9A%E8%A1%8C%E5%92%8C%E6%8E%A7%E5%88%B6%E9%94%AE%E7%9B%98%E7%9A%84%E8%BE%93%E5%85%A5"><span class="toc-number">3.3.4.4.</span> <span class="toc-text">åˆ é™¤æŒ‡å®šè¡Œå’Œæ§åˆ¶é”®ç›˜çš„è¾“å…¥</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CS%E5%92%8CBS%E7%9A%84%E5%BC%82%E5%90%8C%E7%82%B9"><span class="toc-number">3.4.</span> <span class="toc-text">CSå’ŒBSçš„å¼‚åŒç‚¹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Tomcat"><span class="toc-number">3.5.</span> <span class="toc-text">Tomcat</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Tomcat%E7%9A%84%E9%83%A8%E7%BD%B2%E8%BF%90%E8%A1%8C"><span class="toc-number">3.5.1.</span> <span class="toc-text">Tomcatçš„éƒ¨ç½²è¿è¡Œ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Tomcat%E9%83%A8%E7%BD%B2%E8%BF%90%E8%A1%8C%E5%9C%A8idea"><span class="toc-number">3.5.2.</span> <span class="toc-text">Tomcatéƒ¨ç½²è¿è¡Œåœ¨idea</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Servlet"><span class="toc-number">4.</span> <span class="toc-text">Servlet</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81Servlet%E6%A6%82%E8%BF%B0"><span class="toc-number">4.1.</span> <span class="toc-text">1ã€Servletæ¦‚è¿°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Servlet%E5%90%8D%E5%AD%97"><span class="toc-number">4.1.1.</span> <span class="toc-text">1.Servletåå­—</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Servlet%E5%9C%A8%E6%95%B4%E4%B8%AAWeb%E5%BA%94%E7%94%A8%E4%B8%AD%E8%B5%B7%E5%88%B0%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-number">4.1.2.</span> <span class="toc-text">2.Servletåœ¨æ•´ä¸ªWebåº”ç”¨ä¸­èµ·åˆ°çš„ä½œç”¨</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81Servlet%E5%85%A5%E9%97%A8%E5%AE%9E%E4%BE%8B"><span class="toc-number">4.2.</span> <span class="toc-text">2ã€Servletå…¥é—¨å®ä¾‹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E7%BC%96%E7%A0%81%E9%97%AE%E9%A2%98"><span class="toc-number">4.2.1.</span> <span class="toc-text">è®¾ç½®ç¼–ç é—®é¢˜</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81Servlet%E7%9A%84%E7%BB%A7%E6%89%BF%E5%85%B3%E7%B3%BB%E5%8F%8A%E6%A0%B8%E5%BF%83%E6%96%B9%E6%B3%95"><span class="toc-number">4.3.</span> <span class="toc-text">3ã€Servletçš„ç»§æ‰¿å…³ç³»åŠæ ¸å¿ƒæ–¹æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Servlet%E7%9A%84%E7%BB%A7%E6%89%BF%E5%85%B3%E7%B3%BB"><span class="toc-number">4.3.1.</span> <span class="toc-text">1.Servletçš„ç»§æ‰¿å…³ç³»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-service-%E6%96%B9%E6%B3%95"><span class="toc-number">4.3.2.</span> <span class="toc-text">2.service( )æ–¹æ³•</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7%E3%80%81%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%86%85%E9%83%A8%E8%BD%AC%E5%8F%91%E4%BB%A5%E5%8F%8A%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%87%8D%E5%AE%9A%E5%90%91"><span class="toc-number">4.4.</span> <span class="toc-text">7ã€æœåŠ¡å™¨å†…éƒ¨è½¬å‘ä»¥åŠå®¢æˆ·ç«¯é‡å®šå‘</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8%E3%80%81Thymeleaf-%E8%A7%86%E5%9B%BE%E6%A8%A1%E6%9D%BF%E6%8A%80%E6%9C%AF"><span class="toc-number">4.5.</span> <span class="toc-text">8ã€Thymeleaf - è§†å›¾æ¨¡æ¿æŠ€æœ¯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9%E3%80%81%E4%BF%9D%E5%AD%98%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="toc-number">4.6.</span> <span class="toc-text">9ã€ä¿å­˜ä½œç”¨åŸŸ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10%E3%80%81%E8%B7%AF%E5%BE%84%E9%97%AE%E9%A2%98"><span class="toc-number">4.7.</span> <span class="toc-text">10ã€è·¯å¾„é—®é¢˜</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B0%B4%E6%9E%9C%E7%B3%BB%E7%BB%9F%E9%A1%B9%E7%9B%AE"><span class="toc-number">5.</span> <span class="toc-text">æ°´æœç³»ç»Ÿé¡¹ç›®</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B0%B4%E6%9E%9C%E7%B3%BB%E7%BB%9F"><span class="toc-number">5.1.</span> <span class="toc-text">æ°´æœç³»ç»Ÿ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%BB%BA%E7%AB%8B%E6%95%B0%E6%8D%AE%E5%BA%93%E5%92%8C%E8%A1%A8"><span class="toc-number">5.1.1.</span> <span class="toc-text">1.å»ºç«‹æ•°æ®åº“å’Œè¡¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%88%9B%E5%BB%BAJavaWbe%E9%A1%B9%E7%9B%AE%E6%A8%A1%E5%9D%97"><span class="toc-number">5.1.2.</span> <span class="toc-text">2.åˆ›å»ºJavaWbeé¡¹ç›®æ¨¡å—</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E4%B8%BB%E7%B4%A2%E5%BC%95index%E9%A1%B5%E9%9D%A2"><span class="toc-number">5.1.3.</span> <span class="toc-text">3ã€ä¸»ç´¢å¼•indexé¡µé¢</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9C%80%E6%B1%82"><span class="toc-number">5.1.3.1.</span> <span class="toc-text">éœ€æ±‚</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1%EF%BC%89%E7%BC%96%E5%86%99index-html%E9%A1%B5%E9%9D%A2"><span class="toc-number">5.1.3.2.</span> <span class="toc-text">1ï¼‰ç¼–å†™index.htmlé¡µé¢</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%EF%BC%89%E7%BC%96%E5%86%99index-css"><span class="toc-number">5.1.3.3.</span> <span class="toc-text">2ï¼‰ç¼–å†™index.css</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%EF%BC%89%E7%BC%96%E5%86%99index-js"><span class="toc-number">5.1.3.4.</span> <span class="toc-text">3ï¼‰ç¼–å†™index.js</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4%EF%BC%89%E7%BC%96%E5%86%99indexServlet"><span class="toc-number">5.1.3.5.</span> <span class="toc-text">4ï¼‰ç¼–å†™indexServlet</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%97%AE%E9%A2%98%E4%B8%80%EF%BC%9ATomcat%E7%83%AD%E9%83%A8%E7%BD%B2"><span class="toc-number">5.1.3.6.</span> <span class="toc-text">é—®é¢˜ä¸€ï¼šTomcatçƒ­éƒ¨ç½²</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E6%B7%BB%E5%8A%A0add%E6%93%8D%E4%BD%9C"><span class="toc-number">5.1.4.</span> <span class="toc-text">4ã€æ·»åŠ addæ“ä½œ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%EF%BC%89%E7%BC%96%E5%86%99add-html%E9%A1%B5%E9%9D%A2"><span class="toc-number">5.1.4.1.</span> <span class="toc-text">1ï¼‰ç¼–å†™add.htmlé¡µé¢</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%EF%BC%89%E7%BC%96%E5%86%99add-css%E6%A0%B7%E5%BC%8F"><span class="toc-number">5.1.4.2.</span> <span class="toc-text">2ï¼‰ç¼–å†™add.cssæ ·å¼</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%EF%BC%89%E7%BC%96%E5%86%99addServlet"><span class="toc-number">5.1.4.3.</span> <span class="toc-text">3ï¼‰ç¼–å†™addServlet</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%97%AE%E9%A2%98%E4%B8%80%EF%BC%9A%E5%8F%8D%E5%B0%84%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2%E5%A4%B1%E8%B4%A5"><span class="toc-number">5.1.5.</span> <span class="toc-text">é—®é¢˜ä¸€ï¼šåå°„ç±»å‹è½¬æ¢å¤±è´¥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E3%80%81%E7%BC%96%E8%BE%91edit%E6%93%8D%E4%BD%9C"><span class="toc-number">5.1.6.</span> <span class="toc-text">5ã€ç¼–è¾‘editæ“ä½œ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%EF%BC%89%E7%BC%96%E5%86%99edit-html%E9%A1%B5%E9%9D%A2"><span class="toc-number">5.1.6.1.</span> <span class="toc-text">1ï¼‰ç¼–å†™edit.htmlé¡µé¢</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%EF%BC%89%E7%BC%96%E5%86%99edit-css"><span class="toc-number">5.1.6.2.</span> <span class="toc-text">2ï¼‰ç¼–å†™edit.css</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%EF%BC%89%E7%BC%96%E5%86%99editServlet"><span class="toc-number">5.1.6.3.</span> <span class="toc-text">3ï¼‰ç¼–å†™editServlet</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6%E3%80%81%E6%9B%B4%E6%96%B0update%E6%93%8D%E4%BD%9C"><span class="toc-number">5.1.7.</span> <span class="toc-text">6ã€æ›´æ–°updateæ“ä½œ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7%E3%80%81%E5%88%A0%E9%99%A4delete%E6%93%8D%E4%BD%9C"><span class="toc-number">5.1.8.</span> <span class="toc-text">7ã€åˆ é™¤deleteæ“ä½œ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8%E3%80%81%E6%95%B4%E4%BD%93%E7%9A%84%E7%9B%AE%E5%BD%95%E5%92%8C%E5%B7%A5%E5%85%B7%E7%B1%BB"><span class="toc-number">5.1.9.</span> <span class="toc-text">8ã€æ•´ä½“çš„ç›®å½•å’Œå·¥å…·ç±»</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#BaseDAO"><span class="toc-number">5.1.9.1.</span> <span class="toc-text">BaseDAO</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ViewBaseServlet"><span class="toc-number">5.1.9.2.</span> <span class="toc-text">ViewBaseServlet</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#StringUtil"><span class="toc-number">5.1.9.3.</span> <span class="toc-text">StringUtil</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9%E3%80%81%E5%A2%9E%E6%B7%BB%E6%9F%A5%E8%AF%A2%E5%8A%9F%E8%83%BD"><span class="toc-number">5.1.10.</span> <span class="toc-text">9ã€å¢æ·»æŸ¥è¯¢åŠŸèƒ½</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B0%B4%E6%9E%9C%E7%B3%BB%E7%BB%9F-%E4%BC%98%E5%8C%961"><span class="toc-number">5.2.</span> <span class="toc-text">æ°´æœç³»ç»Ÿ-ä¼˜åŒ–1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E5%A7%8B%E9%A1%B9%E7%9B%AE%E7%AE%80%E5%9B%BE"><span class="toc-number">5.2.1.</span> <span class="toc-text">åŸå§‹é¡¹ç›®ç®€å›¾</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E5%8C%961%E7%AE%80%E5%9B%BE"><span class="toc-number">5.2.2.</span> <span class="toc-text">ä¼˜åŒ–1ç®€å›¾</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9html"><span class="toc-number">5.2.3.</span> <span class="toc-text">ä¿®æ”¹html</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E5%8C%961-%E7%BC%96%E5%86%99FruitServlet-switch"><span class="toc-number">5.2.4.</span> <span class="toc-text">ä¼˜åŒ–1.ç¼–å†™FruitServlet-switch</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%98%E5%8C%961-5%E7%BC%96%E5%86%99FruitServlet-%E5%8F%8D%E5%B0%84"><span class="toc-number">5.3.</span> <span class="toc-text">ä¼˜åŒ–1.5ç¼–å†™FruitServlet-åå°„</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B0%B4%E6%9E%9C%E7%B3%BB%E7%BB%9F-%E4%BC%98%E5%8C%962"><span class="toc-number">5.4.</span> <span class="toc-text">æ°´æœç³»ç»Ÿ-ä¼˜åŒ–2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#DispatcherServlet%E7%9A%84%E5%BC%95%E5%85%A5"><span class="toc-number">5.4.1.</span> <span class="toc-text">DispatcherServletçš„å¼•å…¥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DispatcherServlet"><span class="toc-number">5.4.2.</span> <span class="toc-text">DispatcherServlet</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ViewBaseServlet-1"><span class="toc-number">5.4.3.</span> <span class="toc-text">ViewBaseServlet</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FruitController"><span class="toc-number">5.4.4.</span> <span class="toc-text">FruitController</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#applicationContext-xml"><span class="toc-number">5.4.5.</span> <span class="toc-text">applicationContext.xml</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%9D%E8%B7%AF%E5%8D%B3%E9%97%AE%E9%A2%98%E7%9A%84%E6%80%BB%E7%BB%93"><span class="toc-number">5.4.6.</span> <span class="toc-text">æ€è·¯å³é—®é¢˜çš„æ€»ç»“</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">5.4.6.1.</span> <span class="toc-text">æ€»ç»“</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%97%AE%E9%A2%98"><span class="toc-number">5.4.6.2.</span> <span class="toc-text">é—®é¢˜</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B0%B4%E6%9E%9C%E7%B3%BB%E7%BB%9F-%E4%BC%98%E5%8C%962-5"><span class="toc-number">5.5.</span> <span class="toc-text">æ°´æœç³»ç»Ÿ-ä¼˜åŒ–2.5</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#DispatcherServlet-1"><span class="toc-number">5.5.1.</span> <span class="toc-text">DispatcherServlet</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FruitController-1"><span class="toc-number">5.5.2.</span> <span class="toc-text">FruitController</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ViewBaseServlet-2"><span class="toc-number">5.5.3.</span> <span class="toc-text">ViewBaseServlet</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93%EF%BC%9A"><span class="toc-number">5.5.4.</span> <span class="toc-text">æ€»ç»“ï¼š</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B0%B4%E6%9E%9C%E7%B3%BB%E7%BB%9F-%E4%BC%98%E5%8C%963"><span class="toc-number">5.6.</span> <span class="toc-text">æ°´æœç³»ç»Ÿ-ä¼˜åŒ–3</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#DispatcherServlet-2"><span class="toc-number">5.6.1.</span> <span class="toc-text">DispatcherServlet</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FruitController-2"><span class="toc-number">5.6.2.</span> <span class="toc-text">FruitController</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93-1"><span class="toc-number">5.6.3.</span> <span class="toc-text">æ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%8D%E4%B9%A0%E6%80%BB%E7%BB%93"><span class="toc-number">5.7.</span> <span class="toc-text">å¤ä¹ æ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%86%8D%E6%AC%A1%E5%AD%A6%E4%B9%A0Servlet%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96%E6%96%B9%E6%B3%95"><span class="toc-number">6.</span> <span class="toc-text">å†æ¬¡å­¦ä¹ Servletçš„åˆå§‹åŒ–æ–¹æ³•</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%9A%E5%8A%A1%E5%B1%82"><span class="toc-number">7.</span> <span class="toc-text">ä¸šåŠ¡å±‚</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#MVC%E6%A6%82%E5%BF%B5%E8%A7%A3%E9%87%8A"><span class="toc-number">7.1.</span> <span class="toc-text">MVCæ¦‚å¿µè§£é‡Š</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8C%BA%E5%88%86%E4%B8%9A%E5%8A%A1%E5%AF%B9%E8%B1%A1%E5%92%8C%E6%95%B0%E6%8D%AE%E8%AE%BF%E9%97%AE%E5%AF%B9%E8%B1%A1"><span class="toc-number">7.2.</span> <span class="toc-text">åŒºåˆ†ä¸šåŠ¡å¯¹è±¡å’Œæ•°æ®è®¿é—®å¯¹è±¡</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B0%B4%E6%9E%9C%E5%BA%93%E5%AD%98%E7%B3%BB%E7%BB%9F%E4%B8%AD%E6%B7%BB%E5%8A%A0%E4%B8%9A%E5%8A%A1%E5%B1%82%E7%BB%84%E4%BB%B6-%E4%BC%98%E5%8C%964"><span class="toc-number">8.</span> <span class="toc-text">æ°´æœåº“å­˜ç³»ç»Ÿä¸­æ·»åŠ ä¸šåŠ¡å±‚ç»„ä»¶-ä¼˜åŒ–4</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E5%9B%BE1"><span class="toc-number">8.1.</span> <span class="toc-text">ç®€å›¾1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E5%9B%BE2"><span class="toc-number">8.2.</span> <span class="toc-text">ç®€å›¾2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#applicationContext"><span class="toc-number">8.3.</span> <span class="toc-text">applicationContext</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ClassPathXmlApplicationContext"><span class="toc-number">8.4.</span> <span class="toc-text">ClassPathXmlApplicationContext</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#IOC"><span class="toc-number">9.</span> <span class="toc-text">IOC</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%80%A6%E5%90%88-x2F-%E4%BE%9D%E8%B5%96"><span class="toc-number">9.1.</span> <span class="toc-text">è€¦åˆ&#x2F;ä¾èµ–</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IOC-%E6%8E%A7%E5%88%B6%E5%8F%8D%E8%BD%AC%EF%BC%9A"><span class="toc-number">9.2.</span> <span class="toc-text">IOC - æ§åˆ¶åè½¬ï¼š</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DI-%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5%EF%BC%9A"><span class="toc-number">9.3.</span> <span class="toc-text">DI - ä¾èµ–æ³¨å…¥ï¼š</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4%E5%99%A8Filter"><span class="toc-number">10.</span> <span class="toc-text">è¿‡æ»¤å™¨Filter</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4%E5%99%A8Filter%E6%A6%82%E8%BF%B0"><span class="toc-number">10.1.</span> <span class="toc-text">è¿‡æ»¤å™¨Filteræ¦‚è¿°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4%E5%99%A8%E9%A1%B9%E7%9B%AE%E7%AE%80%E5%9B%BE"><span class="toc-number">10.2.</span> <span class="toc-text">è¿‡æ»¤å™¨é¡¹ç›®ç®€å›¾</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E6%BC%94%E7%A4%BA"><span class="toc-number">10.3.</span> <span class="toc-text">ä»£ç æ¼”ç¤º</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Filter01"><span class="toc-number">10.3.1.</span> <span class="toc-text">Filter01</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Demo01Servlet"><span class="toc-number">10.3.2.</span> <span class="toc-text">Demo01Servlet</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4%E5%99%A8%E7%9A%84%E7%AE%80%E5%8D%95%E5%BA%94%E7%94%A8%E2%80%93%E8%AE%BE%E7%BD%AE%E7%BC%96%E7%A0%81"><span class="toc-number">10.4.</span> <span class="toc-text">è¿‡æ»¤å™¨çš„ç®€å•åº”ç”¨â€“è®¾ç½®ç¼–ç </span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%BE%E7%A4%BA"><span class="toc-number">10.4.1.</span> <span class="toc-text">å›¾ç¤º</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CharacterEncodingFilter"><span class="toc-number">10.4.2.</span> <span class="toc-text">CharacterEncodingFilter</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86"><span class="toc-number">11.</span> <span class="toc-text">äº‹åŠ¡ç®¡ç†</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E7%A8%8B%E5%BC%8F%E7%AE%A1%E7%90%86%E4%BA%8B%E5%8A%A1"><span class="toc-number">11.1.</span> <span class="toc-text">ç¼–ç¨‹å¼ç®¡ç†äº‹åŠ¡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B0%B4%E6%9E%9C%E7%B3%BB%E7%BB%9F%E5%9C%A8%E4%BC%98%E5%8C%96-5"><span class="toc-number">11.2.</span> <span class="toc-text">æ°´æœç³»ç»Ÿåœ¨ä¼˜åŒ–-5</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86%E5%89%8D%E7%BD%AE%E5%88%B0%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="toc-number">11.2.1.</span> <span class="toc-text">äº‹åŠ¡ç®¡ç†å‰ç½®åˆ°è¿‡æ»¤å™¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ThreadLocal"><span class="toc-number">11.2.2.</span> <span class="toc-text">ThreadLocal</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#set%E6%96%B9%E6%B3%95%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%EF%BC%9A"><span class="toc-number">11.2.2.1.</span> <span class="toc-text">setæ–¹æ³•æºç åˆ†æï¼š</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#get%E6%96%B9%E6%B3%95%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%EF%BC%9A"><span class="toc-number">11.2.2.2.</span> <span class="toc-text">getæ–¹æ³•æºç åˆ†æï¼š</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ConnUtil%E2%80%93%E7%BB%9F%E4%B8%80%E8%BF%9E%E6%8E%A5"><span class="toc-number">11.2.3.</span> <span class="toc-text">ConnUtilâ€“ç»Ÿä¸€è¿æ¥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4%E5%99%A8%E6%97%A0%E6%B3%95%E6%8D%95%E8%8E%B7%E5%BC%82%E5%B8%B8"><span class="toc-number">11.2.4.</span> <span class="toc-text">è¿‡æ»¤å™¨æ— æ³•æ•è·å¼‚å¸¸</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TransactionManager"><span class="toc-number">11.2.5.</span> <span class="toc-text">TransactionManager</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#OpenSessionInViewFilter"><span class="toc-number">11.2.6.</span> <span class="toc-text">OpenSessionInViewFilter</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93-2"><span class="toc-number">11.2.7.</span> <span class="toc-text">æ€»ç»“</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%9B%91%E5%90%AC%E5%99%A8"><span class="toc-number">12.</span> <span class="toc-text">ç›‘å¬å™¨</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%91%E5%90%AC%E5%99%A8%E7%B1%BB%E5%9E%8B"><span class="toc-number">12.1.</span> <span class="toc-text">ç›‘å¬å™¨ç±»å‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%91%E5%90%AC%E5%99%A8%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">12.2.</span> <span class="toc-text">ç›‘å¬å™¨çš„ä½¿ç”¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B0%B4%E6%9E%9C%E7%B3%BB%E7%BB%9F%E5%9C%A8%E4%BC%98%E5%8C%96-6"><span class="toc-number">12.3.</span> <span class="toc-text">æ°´æœç³»ç»Ÿåœ¨ä¼˜åŒ–-6</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%90%8D%E7%9A%84%E5%B0%81%E8%A3%85"><span class="toc-number">12.3.1.</span> <span class="toc-text">è·å–é…ç½®æ–‡ä»¶åçš„å°è£…</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#applicationContext-xml-1"><span class="toc-number">12.3.2.</span> <span class="toc-text">applicationContext.xml</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%91%E5%90%AC%E5%99%A8%E7%9A%84%E5%8A%A0%E5%85%A5%EF%BC%9AContextLoaderListener"><span class="toc-number">12.3.3.</span> <span class="toc-text">ç›‘å¬å™¨çš„åŠ å…¥ï¼šContextLoaderListener</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DispatcherServlet%E4%B8%AD%E6%9E%84%E9%80%A0%E5%99%A8"><span class="toc-number">12.3.4.</span> <span class="toc-text">DispatcherServletä¸­æ„é€ å™¨</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B0%B4%E6%9E%9C%E7%B3%BB%E7%BB%9F%E6%80%BB%E7%BB%93"><span class="toc-number">13.</span> <span class="toc-text">æ°´æœç³»ç»Ÿæ€»ç»“</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#MVC%E5%90%84%E5%B1%82%E7%9A%84%E8%AE%BE%E8%AE%A1"><span class="toc-number">13.1.</span> <span class="toc-text">MVCå„å±‚çš„è®¾è®¡</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#qqZone%E9%A1%B9%E7%9B%AE"><span class="toc-number">14.</span> <span class="toc-text">qqZoneé¡¹ç›®</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E7%86%9F%E6%82%89QQZone%E4%B8%9A%E5%8A%A1%E9%9C%80%E6%B1%82"><span class="toc-number">14.1.</span> <span class="toc-text">1.ç†Ÿæ‚‰QQZoneä¸šåŠ¡éœ€æ±‚</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1"><span class="toc-number">14.2.</span> <span class="toc-text">2.æ•°æ®åº“è®¾è®¡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%8A%BD%E5%8F%96%E5%AE%9E%E4%BD%93"><span class="toc-number">14.2.1.</span> <span class="toc-text">1.æŠ½å–å®ä½“</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%88%86%E6%9E%90%E5%85%B6%E4%B8%AD%E7%9A%84%E5%B1%9E%E6%80%A7"><span class="toc-number">14.2.2.</span> <span class="toc-text">2.åˆ†æå…¶ä¸­çš„å±æ€§</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%88%86%E6%9E%90%E5%AE%9E%E4%BD%93%E4%B9%8B%E9%97%B4%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="toc-number">14.2.3.</span> <span class="toc-text">3.åˆ†æå®ä½“ä¹‹é—´çš„å…³ç³»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-QQZone-ER%E5%9B%BE"><span class="toc-number">14.2.4.</span> <span class="toc-text">4.QQZone-ERå›¾</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E8%8C%83%E5%BC%8F"><span class="toc-number">14.2.5.</span> <span class="toc-text">5.æ•°æ®åº“çš„èŒƒå¼</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E6%9F%A5%E8%AF%A2%E5%A5%BD%E5%8F%8B%E5%88%97%E8%A1%A8"><span class="toc-number">14.2.6.</span> <span class="toc-text">6.æŸ¥è¯¢å¥½å‹åˆ—è¡¨</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E9%A1%B9%E7%9B%AE%E5%88%9D%E5%A7%8B%E5%8C%96%E5%B7%A5%E4%BD%9C"><span class="toc-number">14.3.</span> <span class="toc-text">3.é¡¹ç›®åˆå§‹åŒ–å·¥ä½œ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%8A%9F%E8%83%BD%E4%B8%80%E5%AE%9E%E7%8E%B0"><span class="toc-number">14.4.</span> <span class="toc-text">4.åŠŸèƒ½ä¸€å®ç°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E4%B8%80"><span class="toc-number">14.4.1.</span> <span class="toc-text">åŠŸèƒ½ä¸€</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#login-html"><span class="toc-number">14.4.2.</span> <span class="toc-text">login.html</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#UserController"><span class="toc-number">14.4.3.</span> <span class="toc-text">UserController</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#index-html"><span class="toc-number">14.4.4.</span> <span class="toc-text">index.html</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#main-html"><span class="toc-number">14.4.5.</span> <span class="toc-text">main.html</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#left-html"><span class="toc-number">14.4.6.</span> <span class="toc-text">left.html</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#top-html"><span class="toc-number">14.4.7.</span> <span class="toc-text">top.html</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E5%8A%9F%E8%83%BD%E4%B8%80%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">14.4.8.</span> <span class="toc-text">å®ç°åŠŸèƒ½ä¸€çš„é—®é¢˜</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E5%8A%9F%E8%83%BD%E4%BA%8C%E5%AE%9E%E7%8E%B0"><span class="toc-number">14.5.</span> <span class="toc-text">5.åŠŸèƒ½äºŒå®ç°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E4%BA%8C"><span class="toc-number">14.5.1.</span> <span class="toc-text">åŠŸèƒ½äºŒ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#main-html-1"><span class="toc-number">14.5.2.</span> <span class="toc-text">main.html</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TopicController"><span class="toc-number">14.5.3.</span> <span class="toc-text">TopicController</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E9%94%AE%E6%96%B9%E6%B3%95%EF%BC%9A%E8%8E%B7%E5%8F%96%E5%9B%9E%E5%A4%8D%E5%88%97%E8%A1%A8"><span class="toc-number">14.5.4.</span> <span class="toc-text">å…³é”®æ–¹æ³•ï¼šè·å–å›å¤åˆ—è¡¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#detail-html"><span class="toc-number">14.5.5.</span> <span class="toc-text">detail.html</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E5%8A%9F%E8%83%BD%E4%B8%89%E5%AE%9E%E7%8E%B0"><span class="toc-number">14.6.</span> <span class="toc-text">6.åŠŸèƒ½ä¸‰å®ç°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E4%B8%89"><span class="toc-number">14.6.1.</span> <span class="toc-text">åŠŸèƒ½ä¸‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#detail-html%E2%80%93%E6%B7%BB%E5%8A%A0%E5%9B%9E%E5%A4%8D"><span class="toc-number">14.6.2.</span> <span class="toc-text">detail.htmlâ€“æ·»åŠ å›å¤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ReplyController"><span class="toc-number">14.6.3.</span> <span class="toc-text">ReplyController</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#detail-html%E2%80%93%E5%88%A0%E9%99%A4%E5%9B%9E%E5%A4%8D"><span class="toc-number">14.6.4.</span> <span class="toc-text">detail.htmlâ€“åˆ é™¤å›å¤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ReplyController-1"><span class="toc-number">14.6.5.</span> <span class="toc-text">ReplyController</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ReplyServiceImpl"><span class="toc-number">14.6.6.</span> <span class="toc-text">ReplyServiceImpl</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E5%9B%9B%E5%AE%9E%E7%8E%B0"><span class="toc-number">14.7.</span> <span class="toc-text">åŠŸèƒ½å››å®ç°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E5%9B%9B"><span class="toc-number">14.7.1.</span> <span class="toc-text">åŠŸèƒ½å››</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#main-html-2"><span class="toc-number">14.7.2.</span> <span class="toc-text">main.html</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TopicController-1"><span class="toc-number">14.7.3.</span> <span class="toc-text">TopicController</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TopicServiceImpl"><span class="toc-number">14.7.4.</span> <span class="toc-text">TopicServiceImpl</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ReplyServiceImpl-1"><span class="toc-number">14.7.5.</span> <span class="toc-text">ReplyServiceImpl</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%8D%E4%B9%A0%E6%80%BB%E7%BB%93-1"><span class="toc-number">14.8.</span> <span class="toc-text">å¤ä¹ æ€»ç»“</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%97%A5%E6%9C%9F%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B9%8B%E9%97%B4%E7%9A%84%E6%A0%BC%E5%BC%8F%E5%8C%96"><span class="toc-number">14.8.1.</span> <span class="toc-text">1.æ—¥æœŸå’Œå­—ç¬¦ä¸²ä¹‹é—´çš„æ ¼å¼åŒ–</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Qinghai2021</div><div class="author-info__description">é˜³å…‰å®…ç”·ğŸ’›</div></div><div class="card-info-social-icons is-center"><a class="social-icon" href="//github.com/Qinghai2021?tab=repositories" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:xxxxxx@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>å…¬å‘Š</span></div><div class="announcement_content">æ¥çš„éƒ½æ˜¯å¤§å“¥ï¼</div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/10/05/Java%E9%AB%98%E7%BA%A7-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B-%E5%8F%8D%E5%B0%84-8%E6%96%B0%E7%89%B9%E6%80%A7/" title="Javaç½‘ç»œç¼–ç¨‹-åå°„-8æ–°ç‰¹æ€§">Javaç½‘ç»œç¼–ç¨‹-åå°„-8æ–°ç‰¹æ€§</a><time datetime="2022-10-04T16:00:00.000Z" title="å‘è¡¨äº 2022-10-05 00:00:00">2022-10-05</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/10/04/Java%E9%AB%98%E7%BA%A7-%E9%9B%86%E5%90%88-%E6%B3%9B%E5%9E%8B-IO%E6%B5%81/" title="Javaé›†åˆ-æ³›å‹-IOæµ">Javaé›†åˆ-æ³›å‹-IOæµ</a><time datetime="2022-10-03T16:00:00.000Z" title="å‘è¡¨äº 2022-10-04 00:00:00">2022-10-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/10/03/Java%E9%AB%98%E7%BA%A7-%E5%A4%9A%E7%BA%BF%E7%A8%8B-%E5%B8%B8%E7%94%A8%E7%B1%BB-%E6%9E%9A%E4%B8%BE%E7%B1%BB%E4%B8%8E%E6%B3%A8%E8%A7%A3/" title="Javaå¤šçº¿ç¨‹-å¸¸ç”¨ç±»-æšä¸¾ç±»ä¸æ³¨è§£">Javaå¤šçº¿ç¨‹-å¸¸ç”¨ç±»-æšä¸¾ç±»ä¸æ³¨è§£</a><time datetime="2022-10-02T16:00:00.000Z" title="å‘è¡¨äº 2022-10-03 00:00:00">2022-10-03</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/10/02/%E5%B0%9A%E7%A1%85%E8%B0%B7java%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/" title="Javaç¼–ç¨‹åŸºç¡€">Javaç¼–ç¨‹åŸºç¡€</a><time datetime="2022-10-01T16:00:00.000Z" title="å‘è¡¨äº 2022-10-02 00:00:00">2022-10-02</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/09/30/JavaWeb/" title="JavaWebç¬”è®°">JavaWebç¬”è®°</a><time datetime="2022-09-29T16:00:00.000Z" title="å‘è¡¨äº 2022-09-30 00:00:00">2022-09-30</time></div></div></div></div></div></div></main><footer id="footer" style="background: #FFFFFF"><div id="footer-wrap"><div class="copyright">&copy;2022 By Qinghai2021</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/chenxz21/hexo-theme-bcxm">Bcxm</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://fastly.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><div class="js-pjax"></div><script type="text/javascript" src="https://fastly.jsdelivr.net/npm/leancloud-storage@4.10.0/dist/av-min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://fastly.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script id="click-heart" src="https://fastly.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>